(()=>{"use strict";var __webpack_modules__={615:(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Al:()=>getResourceUrl,Bb:()=>isDebugMode,Jn:()=>generateSnapshotFromManifest,ML:()=>safeToString,OL:()=>isBrowserEnv,R8:()=>warn,Tr:()=>isManifestProvider,d:()=>createLink,e4:()=>decodeName,h:()=>createLogger,k0:()=>loadScript,lG:()=>composeKeyWithSeparator,oe:()=>loadScriptNode,so:()=>createScript,tf:()=>isReactNativeEnv,yq:()=>ENCODE_NAME_PREFIX});const FederationModuleManifest="federation-manifest.json",MANIFEST_EXT=".json",BROWSER_LOG_KEY="FEDERATION_DEBUG",NameTransformSymbol={AT:"@",HYPHEN:"-",SLASH:"/"},NameTransformMap={[NameTransformSymbol.AT]:"scope_",[NameTransformSymbol.HYPHEN]:"_",[NameTransformSymbol.SLASH]:"__"},EncodedNameTransformMap={[NameTransformMap[NameTransformSymbol.AT]]:NameTransformSymbol.AT,[NameTransformMap[NameTransformSymbol.HYPHEN]]:NameTransformSymbol.HYPHEN,[NameTransformMap[NameTransformSymbol.SLASH]]:NameTransformSymbol.SLASH},SEPARATOR=":",ManifestFileName="mf-manifest.json",StatsFileName="mf-stats.json",MFModuleType={NPM:"npm",APP:"app"},MODULE_DEVTOOL_IDENTIFIER="__MF_DEVTOOLS_MODULE_INFO__",ENCODE_NAME_PREFIX="ENCODE_NAME_PREFIX",TEMP_DIR=".federation",MFPrefetchCommon={identifier:"MFDataPrefetch",globalKey:"__PREFETCH__",library:"mf-data-prefetch",exportsKey:"__PREFETCH_EXPORTS__",fileName:"bootstrap.js"};var ContainerPlugin=Object.freeze({__proto__:null}),ContainerReferencePlugin=Object.freeze({__proto__:null}),ModuleFederationPlugin=Object.freeze({__proto__:null}),SharePlugin=Object.freeze({__proto__:null});function isBrowserEnv(){return"undefined"!=typeof window&&void 0!==window.document}function isReactNativeEnv(){return"undefined"!=typeof navigator&&"ReactNative"===navigator?.product}function isBrowserDebug(){try{if(isBrowserEnv()&&window.localStorage)return Boolean(localStorage.getItem(BROWSER_LOG_KEY))}catch(e){return!1}return!1}function isDebugMode(){return"undefined"!=typeof process&&process.env&&process.env.FEDERATION_DEBUG?Boolean(process.env.FEDERATION_DEBUG):!("undefined"==typeof FEDERATION_DEBUG||!Boolean(FEDERATION_DEBUG))||isBrowserDebug()}const getProcessEnv=function(){return"undefined"!=typeof process&&process.env?process.env:{}},LOG_CATEGORY="[ Federation Runtime ]",parseEntry=(e,t,o=SEPARATOR)=>{const n=e.split(o),a="development"===getProcessEnv().NODE_ENV&&t,s=e=>e.startsWith("http")||e.includes(MANIFEST_EXT);if(n.length>=2){let[t,...r]=n;e.startsWith(o)&&(t=n.slice(0,2).join(o),r=[a||n.slice(2).join(o)]);let l=a||r.join(o);return s(l)?{name:t,entry:l}:{name:t,version:l||"*"}}if(1===n.length){const[e]=n;return a&&s(a)?{name:e,entry:a}:{name:e,version:a||"*"}}throw`Invalid entry value: ${e}`},composeKeyWithSeparator=function(...e){return e.length?e.reduce((e,t)=>t?e?`${e}${SEPARATOR}${t}`:t:e,""):""},encodeName=function(e,t="",o=!1){try{const n=o?".js":"";return`${t}${e.replace(new RegExp(`${NameTransformSymbol.AT}`,"g"),NameTransformMap[NameTransformSymbol.AT]).replace(new RegExp(`${NameTransformSymbol.HYPHEN}`,"g"),NameTransformMap[NameTransformSymbol.HYPHEN]).replace(new RegExp(`${NameTransformSymbol.SLASH}`,"g"),NameTransformMap[NameTransformSymbol.SLASH])}${n}`}catch(e){throw e}},decodeName=function(e,t,o){try{let n=e;if(t){if(!n.startsWith(t))return n;n=n.replace(new RegExp(t,"g"),"")}return n=n.replace(new RegExp(`${NameTransformMap[NameTransformSymbol.AT]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.AT]]).replace(new RegExp(`${NameTransformMap[NameTransformSymbol.SLASH]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.SLASH]]).replace(new RegExp(`${NameTransformMap[NameTransformSymbol.HYPHEN]}`,"g"),EncodedNameTransformMap[NameTransformMap[NameTransformSymbol.HYPHEN]]),o&&(n=n.replace(".js","")),n}catch(e){throw e}},generateExposeFilename=(e,t)=>{if(!e)return"";let o=e;return"."===o&&(o="default_export"),o.startsWith("./")&&(o=o.replace("./","")),encodeName(o,"__federation_expose_",t)},generateShareFilename=(e,t)=>e?encodeName(e,"__federation_shared_",t):"",getResourceUrl=(e,t)=>{if("getPublicPath"in e){let o;return o=e.getPublicPath.startsWith("function")?new Function("return "+e.getPublicPath)()():new Function(e.getPublicPath)(),`${o}${t}`}return"publicPath"in e?isBrowserEnv()||isReactNativeEnv()||!("ssrPublicPath"in e)?`${e.publicPath}${t}`:`${e.ssrPublicPath}${t}`:(console.warn("Cannot get resource URL. If in debug mode, please ignore.",e,t),"")},assert=(e,t)=>{e||error(t)},error=e=>{throw new Error(`${LOG_CATEGORY}: ${e}`)},warn=e=>{console.warn(`${LOG_CATEGORY}: ${e}`)};function safeToString(e){try{return JSON.stringify(e,null,2)}catch(e){return""}}const VERSION_PATTERN_REGEXP=/^([\d^=v<>~]|[*xX]$)/;function isRequiredVersion(e){return VERSION_PATTERN_REGEXP.test(e)}const simpleJoinRemoteEntry=(e,t)=>{if(!e)return t;const o=(e=>{if("."===e)return"";if(e.startsWith("./"))return e.replace("./","");if(e.startsWith("/")){const t=e.slice(1);return t.endsWith("/")?t.slice(0,-1):t}return e})(e);return o?o.endsWith("/")?`${o}${t}`:`${o}/${t}`:t};function inferAutoPublicPath(e){return e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/")}function generateSnapshotFromManifest(e,t={}){const{remotes:o={},overrides:n={},version:a}=t;let s;const r=()=>"publicPath"in e.metaData?"auto"===e.metaData.publicPath&&a?inferAutoPublicPath(a):e.metaData.publicPath:e.metaData.getPublicPath,l=Object.keys(n);let i={};Object.keys(o).length||(i=e.remotes?.reduce((e,t)=>{let o;const a=t.federationContainerName;return o=l.includes(a)?n[a]:"version"in t?t.version:t.entry,e[a]={matchedVersion:o},e},{})||{}),Object.keys(o).forEach(e=>i[e]={matchedVersion:l.includes(e)?n[e]:o[e]});const{remoteEntry:{path:c,name:d,type:p},types:u,buildInfo:{buildVersion:m},globalName:h,ssrRemoteEntry:f}=e.metaData,{exposes:v}=e;let g={version:a||"",buildVersion:m,globalName:h,remoteEntry:simpleJoinRemoteEntry(c,d),remoteEntryType:p,remoteTypes:simpleJoinRemoteEntry(u.path,u.name),remoteTypesZip:u.zip||"",remoteTypesAPI:u.api||"",remotesInfo:i,shared:e?.shared.map(e=>({assets:e.assets,sharedName:e.name,version:e.version})),modules:v?.map(e=>({moduleName:e.name,modulePath:e.path,assets:e.assets}))};if(e.metaData?.prefetchInterface){const t=e.metaData.prefetchInterface;g={...g,prefetchInterface:t}}if(e.metaData?.prefetchEntry){const{path:t,name:o,type:n}=e.metaData.prefetchEntry;g={...g,prefetchEntry:simpleJoinRemoteEntry(t,o),prefetchEntryType:n}}if(s="publicPath"in e.metaData?{...g,publicPath:r(),ssrPublicPath:e.metaData.ssrPublicPath}:{...g,getPublicPath:r()},f){const e=simpleJoinRemoteEntry(f.path,f.name);s.ssrRemoteEntry=e,s.ssrRemoteEntryType=f.type||"commonjs-module"}return s}function isManifestProvider(e){return!(!("remoteEntry"in e)||!e.remoteEntry.includes(MANIFEST_EXT))}const PREFIX="[ Module Federation ]",DEFAULT_DELEGATE=console,LOGGER_STACK_SKIP_TOKENS=["logger.ts","logger.js","captureStackTrace","Logger.emit","Logger.log","Logger.info","Logger.warn","Logger.error","Logger.debug"];function captureStackTrace(){try{const e=(new Error).stack;if(!e)return;const[,...t]=e.split("\n"),o=t.filter(e=>!LOGGER_STACK_SKIP_TOKENS.some(t=>e.includes(t)));if(!o.length)return;return`Stack trace:\n${o.slice(0,5).join("\n")}`}catch{return}}class Logger{constructor(e,t=DEFAULT_DELEGATE){this.prefix=e,this.delegate=t??DEFAULT_DELEGATE}setPrefix(e){this.prefix=e}setDelegate(e){this.delegate=e??DEFAULT_DELEGATE}emit(e,t){const o=this.delegate,n=isDebugMode()?captureStackTrace():void 0,a=n?[...t,n]:t,s=(()=>{switch(e){case"log":return["log","info"];case"info":return["info","log"];case"warn":return["warn","info","log"];case"error":return["error","warn","log"];default:return["debug","log"]}})();for(const e of s){const t=o[e];if("function"==typeof t)return void t.call(o,this.prefix,...a)}for(const e of s){const t=DEFAULT_DELEGATE[e];if("function"==typeof t)return void t.call(DEFAULT_DELEGATE,this.prefix,...a)}}log(...e){this.emit("log",e)}warn(...e){this.emit("warn",e)}error(...e){this.emit("error",e)}success(...e){this.emit("info",e)}info(...e){this.emit("info",e)}ready(...e){this.emit("info",e)}debug(...e){isDebugMode()&&this.emit("debug",e)}}function createLogger(e){return new Logger(e)}function createInfrastructureLogger(e){const t=new Logger(e);return Object.defineProperty(t,"__mf_infrastructure_logger__",{value:!0,enumerable:!1,configurable:!1}),t}function bindLoggerToCompiler(e,t,o){if(e.__mf_infrastructure_logger__&&t?.getInfrastructureLogger)try{const n=t.getInfrastructureLogger(o);!n||"object"!=typeof n||"function"!=typeof n.log&&"function"!=typeof n.info&&"function"!=typeof n.warn&&"function"!=typeof n.error||e.setDelegate(n)}catch{e.setDelegate(void 0)}}const logger=createLogger(PREFIX),infrastructureLogger=createInfrastructureLogger(PREFIX);async function safeWrapper(e,t){try{return await e()}catch(e){return void(!t&&warn(e))}}function isStaticResourcesEqual(e,t){const o=/^(https?:)?\/\//i;return e.replace(o,"").replace(/\/$/,"")===t.replace(o,"").replace(/\/$/,"")}function createScript(e){let t,o=null,n=!0,a=2e4;const s=document.getElementsByTagName("script");for(let t=0;t<s.length;t++){const a=s[t],r=a.getAttribute("src");if(r&&isStaticResourcesEqual(r,e.url)){o=a,n=!1;break}}if(!o){const t=e.attrs;let n;o=document.createElement("script"),o.type="module"===t?.type?"module":"text/javascript",e.createScriptHook&&(n=e.createScriptHook(e.url,e.attrs),n instanceof HTMLScriptElement?o=n:"object"==typeof n&&("script"in n&&n.script&&(o=n.script),"timeout"in n&&n.timeout&&(a=n.timeout))),o.src||(o.src=e.url),t&&!n&&Object.keys(t).forEach(e=>{o&&("async"===e||"defer"===e?o[e]=t[e]:o.getAttribute(e)||o.setAttribute(e,t[e]))})}const r=async(n,a)=>{clearTimeout(t);const s=()=>{"error"===a?.type?e?.onErrorCallback&&e?.onErrorCallback(a):e?.cb&&e?.cb()};if(o&&(o.onerror=null,o.onload=null,safeWrapper(()=>{const{needDeleteScript:t=!0}=e;t&&o?.parentNode&&o.parentNode.removeChild(o)}),n&&"function"==typeof n)){const e=n(a);if(e instanceof Promise){const t=await e;return s(),t}return s(),e}s()};return o.onerror=r.bind(null,o.onerror),o.onload=r.bind(null,o.onload),t=setTimeout(()=>{r(null,new Error(`Remote script "${e.url}" time-outed.`))},a),{script:o,needAttach:n}}function createLink(e){let t=null,o=!0;const n=document.getElementsByTagName("link");for(let a=0;a<n.length;a++){const s=n[a],r=s.getAttribute("href"),l=s.getAttribute("rel");if(r&&isStaticResourcesEqual(r,e.url)&&l===e.attrs.rel){t=s,o=!1;break}}if(!t){let o;t=document.createElement("link"),t.setAttribute("href",e.url);const n=e.attrs;e.createLinkHook&&(o=e.createLinkHook(e.url,n),o instanceof HTMLLinkElement&&(t=o)),n&&!o&&Object.keys(n).forEach(e=>{t&&!t.getAttribute(e)&&t.setAttribute(e,n[e])})}const a=(o,n)=>{const a=()=>{"error"===n?.type?e?.onErrorCallback&&e?.onErrorCallback(n):e?.cb&&e?.cb()};if(t&&(t.onerror=null,t.onload=null,safeWrapper(()=>{const{needDeleteLink:o=!0}=e;o&&t?.parentNode&&t.parentNode.removeChild(t)}),o)){const e=o(n);return a(),e}a()};return t.onerror=a.bind(null,t.onerror),t.onload=a.bind(null,t.onload),{link:t,needAttach:o}}function loadScript(e,t){const{attrs:o={},createScriptHook:n}=t;return new Promise((t,a)=>{const{script:s,needAttach:r}=createScript({url:e,cb:t,onErrorCallback:a,attrs:{fetchpriority:"high",...o},createScriptHook:n,needDeleteScript:!0});r&&document.head.appendChild(s)})}const sdkImportCache=new Map;function importNodeModule(e){if(!e)throw new Error("import specifier is required");if(sdkImportCache.has(e))return sdkImportCache.get(e);const t=new Function("name","return import(name)")(e).then(e=>e).catch(t=>{throw console.error(`Error importing module ${e}:`,t),sdkImportCache.delete(e),t});return sdkImportCache.set(e,t),t}const loadNodeFetch=async()=>{const e=await importNodeModule("node-fetch");return e.default||e},lazyLoaderHookFetch=async(e,t,o)=>{const n=await((e,t)=>o.lifecycle.fetch.emit(e,t))(e,t||{});return n&&n instanceof Response?n:("undefined"==typeof fetch?await loadNodeFetch():fetch)(e,t||{})},createScriptNode="undefined"==typeof ENV_TARGET||"web"!==ENV_TARGET?(url,cb,attrs,loaderHook)=>{if(loaderHook?.createScriptHook){const e=loaderHook.createScriptHook(url);e&&"object"==typeof e&&"url"in e&&(url=e.url)}let urlObj;try{urlObj=new URL(url)}catch(e){return console.error("Error constructing URL:",e),void cb(new Error(`Invalid URL: ${e}`))}const getFetch=async()=>loaderHook?.fetch?(e,t)=>lazyLoaderHookFetch(e,t,loaderHook):"undefined"==typeof fetch?loadNodeFetch():fetch,handleScriptFetch=async(f,urlObj)=>{try{const res=await f(urlObj.href),data=await res.text(),[path,vm]=await Promise.all([importNodeModule("path"),importNodeModule("vm")]),scriptContext={exports:{},module:{exports:{}}},urlDirname=urlObj.pathname.split("/").slice(0,-1).join("/"),filename=path.basename(urlObj.pathname),script=new vm.Script(`(function(exports, module, require, __dirname, __filename) {${data}\n})`,{filename,importModuleDynamically:vm.constants?.USE_MAIN_CONTEXT_DEFAULT_LOADER??importNodeModule});script.runInThisContext()(scriptContext.exports,scriptContext.module,eval("require"),urlDirname,filename);const exportedInterface=scriptContext.module.exports||scriptContext.exports;if(attrs&&exportedInterface&&attrs.globalName){const e=exportedInterface[attrs.globalName]||exportedInterface;return void cb(void 0,e)}cb(void 0,exportedInterface)}catch(e){cb(e instanceof Error?e:new Error(`Script execution error: ${e}`))}};getFetch().then(async e=>{if("esm"===attrs?.type||"module"===attrs?.type)return loadModule(urlObj.href,{fetch:e,vm:await importNodeModule("vm")}).then(async e=>{await e.evaluate(),cb(void 0,e.namespace)}).catch(e=>{cb(e instanceof Error?e:new Error(`Script execution error: ${e}`))});handleScriptFetch(e,urlObj)}).catch(e=>{cb(e)})}:(e,t,o,n)=>{t(new Error("createScriptNode is disabled in non-Node.js environment"))},loadScriptNode="undefined"==typeof ENV_TARGET||"web"!==ENV_TARGET?(e,t)=>new Promise((o,n)=>{createScriptNode(e,(e,a)=>{if(e)n(e);else{const e=globalThis[t?.attrs?.globalName||`__FEDERATION_${t?.attrs?.name}:custom__`]=a;o(e)}},t.attrs,t.loaderHook)}):(e,t)=>{throw new Error("loadScriptNode is disabled in non-Node.js environment")},esmModuleCache=new Map;async function loadModule(e,t){if(esmModuleCache.has(e))return esmModuleCache.get(e);const{fetch:o,vm:n}=t,a=await o(e),s=await a.text(),r=new n.SourceTextModule(s,{importModuleDynamically:async(o,n)=>loadModule(new URL(o,e).href,t)});return esmModuleCache.set(e,r),await r.link(async o=>{const n=new URL(o,e).href;return await loadModule(n,t)}),r}function normalizeOptions(e,t,o){return function(n){if(!1===n)return!1;if(void 0===n)return!!e&&t;if(!0===n)return t;if(n&&"object"==typeof n)return{...t,...n};throw new Error(`Unexpected type for \`${o}\`, expect boolean/undefined/object, got: ${typeof n}`)}}const createModuleFederationConfig=e=>e},734:(e,t,o)=>{var n={};o.r(n),o.d(n,{AudioControl:()=>vs,BoolEdit:()=>Ja,Buttons:()=>ua,ColorString:()=>fr,CustomInput:()=>aa,DimensionsEdit:()=>sl,EditColor:()=>ur,ElementView:()=>la,EulerBlock:()=>Us,ExpandedButton:()=>gn,ExtMenu:()=>ea,FileSelect:()=>Dr,Float:()=>cs,FloatBlock:()=>ks,FontSize:()=>hl,Icon:()=>wn,ImageView:()=>kr,Int:()=>es,ItemsLib:()=>Tl,Label:()=>Gr,LabelEdit:()=>tr,LoginForm:()=>pi,Modal:()=>Bn,ModalForm:()=>zr,ModelPreview:()=>Cr,PopupList:()=>Dn,ProjectItem:()=>jl,QuaternionBlock:()=>qs,RadioButton:()=>ka,SearchFilter:()=>Va,SectionSelect:()=>Pr,Selectable:()=>Fa,ShadowEdit:()=>Xr,SimpleButton:()=>Mn,SlideBlock:()=>Ba,Spinner:()=>Un,TextColorEdit:()=>il,TextEdit:()=>Js,Toast:()=>Yn,Toasts:()=>qn,ToggleButton:()=>Ln,TransformEdit:()=>cr,TreeLi:()=>Aa,TwoSideBool:()=>Ir,UILabel:()=>mi,V3:()=>Ns,V3block:()=>Is,confirmform:()=>Kl,params:()=>ss,queryform:()=>zl,vlist:()=>Wa});var a={};o.r(a),o.d(a,{actions:()=>hd,analitycs:()=>vp,app:()=>fp,assets:()=>pp,engine:()=>yc,inspector:()=>Ep,menu:()=>Cp,modal:()=>Bi,models:()=>Qi,modules:()=>Ri,project:()=>zp,projects:()=>Xp,selection:()=>Zp,slides:()=>uc,storage:()=>nu,templates:()=>Du,toasts:()=>Ni,translations:()=>Lu,ui:()=>zu});var s=o(15);const r={class:"app-container canvas-container"},l={class:"workspace"},i={id:"editorcanvas",ref:"editorcanvas"},c={id:"playcanvas",ref:"playcanvas"},d={id:"playui",ref:"playui"},p={key:0,class:"splash"},u={class:"container"},m={class:"topline"},h={class:"title"},f={class:"info"},v=["onClick"],g={key:0},y={class:"element"},b=["innerHTML"],k=["onClick"],w={key:0},E={class:"panel-container"},_={class:"panel"},S={class:"header"},N={class:"content"},V={class:"footer"},C={props:{header:{type:Object,default:{label:""}},footer:{type:Object,default:{}}},data:()=>({visible:{heirarhy:!0}})};var B=o(262);const $=(0,B.A)(C,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",E,[(0,s.createElementVNode)("div",_,[(0,s.createElementVNode)("div",S,[(0,s.renderSlot)(e.$slots,"header")]),(0,s.createElementVNode)("div",N,[(0,s.renderSlot)(e.$slots,"default")]),(0,s.createElementVNode)("div",V,[(0,s.renderSlot)(e.$slots,"footer")])])])}]]),x={class:"slide-scroller",ref:"scroller"},D=["onClick","onDragstart","onDrop"],T={class:"title"},I=["src"],A=["src"],M={class:"overflow"},O=["src"],j={class:"overflow"},P=o.p+"assets/3d592ccd944e1f3ef7b0.png",L={props:{slides:{type:Array,required:!0},slide:{type:Object}},data:()=>({slideData:{name:{label:"Имя",value:""}},translateX:0,draggedIndex:null,cardbg:P}),watch:{slide(){this.centerSelectedImage()},slides(){this.slides.sort((e,t)=>e.index-t.index),this.centerSelectedImage()}},mounted(){this.slides.sort((e,t)=>e.index-t.index),this.centerSelectedImage(),this.observer=new ResizeObserver(this.centerSelectedImage.bind(this)),this.observer.observe(this.$refs.scroller)},beforeUnmount(){this.observer.disconnect()},methods:{onDragStart(e){this.draggedIndex=e},async onDrop(e){if(null===this.draggedIndex||this.draggedIndex===e)return;const t=this.slides.splice(this.draggedIndex,1)[0];this.slides.splice(e,0,t);const o=Math.min(this.draggedIndex,e),n=Math.max(this.draggedIndex,e);for(let e=o;e<=n;e++){const t=this.slides[e];t.index=e,await this.$app.slides.save(t)}this.draggedIndex=null,this.$nextTick(this.centerSelectedImage)},onScroll(e){e.deltaY>0?this.$app.slides.next():e.deltaY<0&&this.$app.slides.back()},addSlide(){const e=(0,s.reactive)({title:"Adding a slide",text:"Specify the slide title",answer:""}),t=(0,s.reactive)({label:"Create",class:"primary",disabled:e.answer.length<1,callback:async t=>{const o=await this.$app.slides.add({name:e.answer});this.$app.toasts.add({message:`Slide ${o.name} added`}),this.selectSlide(o),this.centerSelectedImage()}});this.$app.modal.queryText(e,[t],o=>{e.answer=o,t.disabled=e.answer.length<1})},removeSlide(){this.$app.modal.open({header:{value:"Delete slide",handler:()=>{this.$app.modal.close()}},content:{},footer:{buttons:[{label:"Delete",class:"secondary",handler:async()=>{this.$app.modal.close(),this.$app.slides.remove()}},{label:"Cancel",class:"primary",handler:async()=>{this.$app.modal.close()}}]}})},selectSlide(e){this.$app.slides.goto(e.uid)},centerSelectedImage(){this.$nextTick(()=>{const e=this.$refs.scroller.offsetWidth,t=this.$refs.scroller.querySelector(".slide-item.selected");if(t){const o=t.offsetWidth,n=t.offsetLeft;this.translateX=-(n-e/2+o/2)}else this.translateX=.5*e})}}},R=(0,B.A)(L,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",x,[(0,s.createElementVNode)("div",{class:"slide-container",onWheelPassive:t[3]||(t[3]=(...e)=>r.onScroll&&r.onScroll(...e)),style:(0,s.normalizeStyle)({transform:`translateX(${a.translateX}px)`})},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.slides,(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:n,class:(0,s.normalizeClass)(["slide-item",{selected:e===o.slide}]),onClick:t=>r.selectSlide(e),draggable:"true",onDragstart:e=>r.onDragStart(n),onDragover:t[0]||(t[0]=(0,s.withModifiers)(()=>{},["prevent"])),onDrop:e=>r.onDrop(n)},[(0,s.createElementVNode)("div",T,(0,s.toDisplayString)(e.name),1),(0,s.createElementVNode)("img",{src:a.cardbg,alt:"Image"},null,8,I)],42,D))),128)),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"slide-item",onClick:t[1]||(t[1]=e=>r.addSlide())},[(0,s.createElementVNode)("img",{src:a.cardbg,alt:"Image"},null,8,A),(0,s.createElementVNode)("div",M,[(0,s.createVNode)(l,{value:"add_to_queue",size:"1em"})])])),[[i,"Add slide"]]),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"slide-item",onClick:t[2]||(t[2]=e=>r.removeSlide())},[(0,s.createElementVNode)("img",{src:a.cardbg,alt:"Image"},null,8,O),(0,s.createElementVNode)("div",j,[(0,s.createVNode)(l,{value:"remove_from_queue",size:"1em"})])])),[[i,"Remove slide"]])],36)],512)}],["__scopeId","data-v-14c1e910"]]),F={class:"panel-container"},U={class:"panel"},z={key:0,class:"content"},H={class:"elements"},q={data:()=>({visible:!1})},G=(0,B.A)(q,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",F,[(0,s.createElementVNode)("div",U,[(0,s.createElementVNode)("div",{onClick:t[0]||(t[0]=e=>a.visible=!a.visible),class:"header"},"Hierarhy"),a.visible?((0,s.openBlock)(),(0,s.createElementBlock)("div",z,[(0,s.createElementVNode)("div",H,[(0,s.renderSlot)(e.$slots,"default",{},void 0,!0)])])):(0,s.createCommentVNode)("v-if",!0)])])}],["__scopeId","data-v-e71891a0"]]),W={key:0,class:"element"},K=["onClick"],Y={key:1,class:"label"},J={class:"collapsible-panel"},X={class:"panel-header"},Q={key:1,class:"toggle-icon"},Z={class:"header-content"},ee={class:"panel-content"},te={__name:"inspectorpanel",props:{label:{type:String,required:!0},tooltip:{type:String,default:""},stat:{type:Boolean,default:!1}},setup(e,{expose:t}){const o=(0,s.useSlots)(),n=(0,s.ref)(!1),a=(0,s.ref)(null),r=()=>{o.content&&(n.value=!n.value,console.log("toggle",n.value))};return t({togglePanel:r,openPanel:()=>{o.content&&(n.value=!0)},closePanel:()=>{o.content&&(n.value=!1)},isOpen:n}),(t,l)=>{const i=(0,s.resolveDirective)("translate"),c=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",J,[(0,s.createElementVNode)("div",X,[(0,s.unref)(o).content?((0,s.openBlock)(),(0,s.createElementBlock)("span",{key:0,onClick:r,class:(0,s.normalizeClass)(["toggle-icon",{open:n.value}])},"▼",2)):((0,s.openBlock)(),(0,s.createElementBlock)("span",Q)),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Z,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",{onClick:r,class:"label"},[(0,s.createTextVNode)((0,s.toDisplayString)(e.label),1)])),[[i,`$$inspector.${e.label}`]]),(0,s.createVNode)(s.Transition,{name:"fade"},{default:(0,s.withCtx)(()=>[(0,s.renderSlot)(t.$slots,"head",{label:e.label,togglePanel:r},()=>[(0,s.withDirectives)((0,s.createElementVNode)("div",{ref_key:"panelHeader",ref:a},null,512),[[s.vShow,!n.value]])])]),_:3})])),[[c,e.tooltip]]),(0,s.renderSlot)(t.$slots,"icons",{stat:e.stat,togglePanel:r})]),(0,s.createVNode)(s.Transition,{name:"slide",persisted:""},{default:(0,s.withCtx)(()=>[(0,s.withDirectives)((0,s.createElementVNode)("div",ee,[(0,s.renderSlot)(t.$slots,"content",{togglePanel:r})],512),[[s.vShow,n.value]])]),_:3})])}}},oe=(0,B.A)(te,[["__scopeId","data-v-290d7e9e"]]),ne={style:{display:"grid","grid-template-columns":"96px 1fr"}},ae=["value"],se={key:1},re={name:"ModelTypes",data:()=>({types:["model","camera","chart3d"]}),props:{selected:{type:Object}}},le=(0,B.A)(re,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",ne,[t[1]||(t[1]=(0,s.createElementVNode)("div",null,"Тип:",-1)),a.types.includes(o.selected.type)?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("select",{key:0,class:"typeslist","onUpdate:modelValue":t[0]||(t[0]=e=>o.selected.type=e)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.types,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{value:e},(0,s.toDisplayString)(e),9,ae))),256))],512)),[[s.vModelSelect,o.selected.type]]):((0,s.openBlock)(),(0,s.createElementBlock)("div",se,(0,s.toDisplayString)(o.selected.type),1))])}]]),ie={style:{display:"flex","flex-direction":"column"}},ce={style:{display:"flex","justify-content":"center","margin-top":"10px"}},de={class:"assetblock"},pe={key:0,class:"short"},ue={class:"short-text"},me={key:0,class:"assetcontent"},he={class:"assetrow"},fe={class:"assetrow"},ve={name:"AssetView",props:{asset:{type:Object},label:{type:String}},mounted(){},data:()=>({view:!0}),computed:{src(){return this.$app.assets.list.find(e=>e.uid===this.asset.uid)},types(){return this.$app.assets.types}}},ge=(0,B.A)(ve,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",de,[(0,s.createElementVNode)("div",{onClick:t[0]||(t[0]=e=>a.view=!a.view),class:"title"},[(0,s.createCommentVNode)(' <div class="label">{{ label }}</div> '),a.view?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",pe,[(0,s.createTextVNode)((0,s.toDisplayString)(r.src.uid)+" : "+(0,s.toDisplayString)(r.src.type)+" : ",1),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",ue,[(0,s.createTextVNode)((0,s.toDisplayString)(r.src.url),1)])),[[i,r.src.url]])]))]),a.view?((0,s.openBlock)(),(0,s.createElementBlock)("div",me,[(0,s.createElementVNode)("div",he,[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(r.src.type)+" : "+(0,s.toDisplayString)(r.src.name||r.src.uid),1),(0,s.createElementVNode)("div",null,[(0,s.createElementVNode)("button",{onClick:t[1]||(t[1]=t=>e.$emit("remove",o.asset))},[(0,s.createVNode)(l,{value:"bin",size:"1em"})])])]),(0,s.createCommentVNode)(' <div class="assetrow">\r\n                <div>URL:</div>\r\n                <div class="rowcontent">\r\n                    <LabelEdit :value="src.url"></LabelEdit>\r\n                </div>\r\n            </div> '),(0,s.createCommentVNode)(' <div class="assetrow" v-for="(param, key) in src.parameters">\r\n            <div>{{ key }}</div><div>{{ param }}</div>\r\n        </div> '),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.asset.parameters,(e,o)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",fe,[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(o),1),t[2]||(t[2]=(0,s.createElementVNode)("div",{class:"cell"},[(0,s.createCommentVNode)(' <LabelEdit @update:value="asset.parameters[key] = $event; $emit(\'changed\')" :value="param">\r\n                    </LabelEdit> ')],-1))]))),256))])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-eca41270"]]),ye={name:"AssetsView",data:()=>({selectedAsset:null,assetsData:{offtypes:["hdr"]}}),props:{modelValue:{type:Object},value:{type:Object}},methods:{async removeAsset(e){await this.$app.elements.removeAsset(this.value,e),this.$app.toasts.add({message:"Ресурс удален из модели"})},saveProp(){this.$app.toasts.add({message:"Параметр ресурса в элементе изменен"}),this.$app.engine.getManager().UpdateElement(this.value.path,{assets:this.value.assets})},async selectAsset(){const e=await this.$app.assets.selectAsset(["hdr","texture"]);if(e){const t=this.$app.engine.getManager("AssetsManager").GetAsset(e.uid);console.log(this.value),console.log(t),this.$app.assets.setAsset(this.value,t),this.$app.toasts.add({message:"Ресурс добавлен в модель"})}}},computed:{list(){return this.value?.data?.assets||this.value?.assets||[]}},components:{AssetView:ge}},be=(0,B.A)(ye,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("AssetView"),i=(0,s.resolveComponent)("icon"),c=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",ie,[t[1]||(t[1]=(0,s.createElementVNode)("div",null,"Ресурсы",-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.list,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)(l,{asset:e,key:t,onRemove:r.removeAsset,onChanged:r.saveProp},null,8,["asset","onRemove","onChanged"]))),128)),(0,s.createElementVNode)("div",ce,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"button normal",onClick:t[0]||(t[0]=(...e)=>r.selectAsset&&r.selectAsset(...e))},[(0,s.createVNode)(i,{value:"stack",size:"0.75em"})])),[[c,"Ресурсы"]])])])}]]),ke={class:"scenetools"},we={class:"camera-selector"};var Ee=o(875);const _e={name:"SceneTools",data:()=>({}),computed:{selectedCamera:{get(){return this.$app.slides.actived?.camera?.path||null},set(e){this.$app.slides.actived.camera.path=e,this.$app.slides.save()}},slide(){return this.$app.slides.actived},cameras(){return this.$app.project.findObjectsByType(Ee.Camera)||[]}},mounted(){},methods:{saveSlide(){this.$app.slides.save(this.slide)},onCameraChange(){console.log("change");try{if(this.slide.camera?.path&&this.slide.camera?.path!==this.$app.engine.Project.Camera?.path){const e=this.slide.camera.path.split("."),t=this.$app.project.find(e);this.$app.engine.Project.SetCamera(t),t.updateProjectionMatrix()}}catch(e){console.warn(e.message)}}}},Se=(0,B.A)(_e,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("EditColor");return(0,s.openBlock)(),(0,s.createElementBlock)("div",we,[(0,s.createElementVNode)("div",null,[t[0]||(t[0]=(0,s.createElementVNode)("div",null," Background ",-1)),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(l)])])])}],["__scopeId","data-v-167ce3c1"]]),Ne={class:"slide-tools"},Ve={key:0},Ce={key:0},Be=["value"],$e={key:1},xe={style:{display:"block",width:"100%"}},De={class:"overleyicon"},Te={key:1,style:{display:"flex","justify-content":"center"}},Ie={name:"AssetView",props:{asset:{type:Object}},methods:{async showLib(){const e=await this.$app.assets.selectAsset(["hdr"]);this.$emit("setasset",e)}}},Ae=(0,B.A)(Ie,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createCommentVNode)("assethdr"),(0,s.createElementVNode)("div",xe,[(0,s.createElementVNode)("div",De,[o.asset?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:0,onClick:t[0]||(t[0]=(...e)=>r.showLib&&r.showLib(...e)),class:"text"},[(0,s.createTextVNode)((0,s.toDisplayString)(o.asset.name||o.asset.uid),1)])),[[l,o.asset.url]]):((0,s.openBlock)(),(0,s.createElementBlock)("div",Te,[(0,s.createElementVNode)("button",{onClick:t[1]||(t[1]=(...e)=>r.showLib&&r.showLib(...e))},"Select")]))])]),(0,s.createCommentVNode)("//assethdr")],2112)}]]),Me={name:"CameraSelector",props:{slide:{type:Object}},data:()=>({}),computed:{bgColor:{get(){return this.slide.background.color},set(e){this.slide.background.value=e.getStyle(),this.slide.background.setValue("color",this.slide.background.value),this.$app.slides.save(),this.$app.engine.getManager().Scene.background=e}},bgHdr:{get(){return this.slide.background.hdr}},selectedCamera:{get(){return this.slide.camera?.path||null},set(e){this.slide.camera.path=e,this.$app.slides.save()}},cameras(){return this.$app.project.findObjectsByType(Ee.Camera)||[]}},mounted(){},methods:{save(){this.$app.slides.save(this.slide)},onBgChange(e){this.slide.background.setValue(e,this.slide.background[e]),this.$app.slides.save()},async onAssetChange(e){console.log(e.resource),this.slide.background.setValue("hdr",e.resource),this.slide.background.value=e.uid;const t=await this.$app.engine.getAssetsManager().FindAsset(e.uid);this.$app.engine.getManager().Scene.background=t.resource},saveSlide(){this.$app.slides.save(this.slide)},onCameraChange(){console.log("change");try{if(this.slide.camera?.path&&this.slide.camera?.path!==this.$app.engine.Project.Camera?.path){const e=this.slide.camera.path.split("."),t=this.$app.project.find(e);this.$app.engine.Project.SetCamera(t),t.updateProjectionMatrix()}}catch(e){console.warn(e.message)}}},components:{assethdr:Ae}},Oe=(0,B.A)(Me,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("LabelEdit"),i=(0,s.resolveComponent)("ActionsList");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Ne,[o.slide?((0,s.openBlock)(),(0,s.createElementBlock)("div",Ve,[(0,s.createElementVNode)("div",null,[t[3]||(t[3]=(0,s.createElementVNode)("div",null,"Name:",-1)),(0,s.createVNode)(l,{modelValue:o.slide.name,"onUpdate:modelValue":[t[0]||(t[0]=e=>o.slide.name=e),r.save]},null,8,["modelValue","onUpdate:modelValue"])]),r.cameras.length>0?((0,s.openBlock)(),(0,s.createElementBlock)("div",Ce,[t[5]||(t[5]=(0,s.createElementVNode)("label",null,"Camera:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.selectedCamera=e),onChange:t[2]||(t[2]=(...e)=>r.onCameraChange&&r.onCameraChange(...e))},[t[4]||(t[4]=(0,s.createElementVNode)("option",{value:null},"No",-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.cameras,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{key:e.path,value:e.path}," ("+(0,s.toDisplayString)(e.type)+") "+(0,s.toDisplayString)(e.name||`Camera ${e.uid}`),9,Be))),128))],544),[[s.vModelSelect,r.selectedCamera]])])):((0,s.openBlock)(),(0,s.createElementBlock)("div",$e," There are no cameras available in the project. ")),(0,s.createElementVNode)("div",null,[t[6]||(t[6]=(0,s.createElementVNode)("div",null,"Slide Events:",-1)),(0,s.createVNode)(i,{"onUpdate:target":r.saveSlide,onSave:r.saveSlide,target:o.slide},null,8,["onUpdate:target","onSave","target"])]),(0,s.createCommentVNode)(' <div>\r\n                <div>Background</div>\r\n                <div>{{ slide.background.type }}\r\n                    <RadioButton v-model="slide.background.type" @change="onBgChange"\r\n                        :options="[{ value: \'color\', label: \'Color\' }, { value: \'hdr\', label: \'HDR\' }, { value: \'none\', label: \'No\' }]"\r\n                        name="array-group" />\r\n                </div>\r\n                <EditColor v-if="slide.background?.type === \'color\'" v-model="bgColor"></EditColor>\r\n                <assethdr v-if="slide.background?.type === \'hdr\'" v-model="bgHdr" @setasset="onAssetChange">\r\n                </assethdr>\r\n            </div> ')])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-3e935e28"]]),je={data:()=>({asset:{uid:"hdrscene"},view:!0}),name:"SceneTools",computed:{slides(){return this.$app.slides.children},slide(){return this.$app.slides.actived}},components:{slideTools:Oe,InspectorPanel:oe,scenetools:Se},methods:{removeSlide(){this.$app.slides.remove()}}},Pe=(0,B.A)(je,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("slideTools"),i=(0,s.resolveComponent)("InspectorPanel");return(0,s.openBlock)(),(0,s.createElementBlock)("div",ke,[(0,s.createVNode)(i,{label:"Slide Options"},(0,s.createSlots)({_:2},[r.slide?{name:"content",fn:(0,s.withCtx)(()=>[(0,s.createVNode)(l,{slide:r.slide},null,8,["slide"])]),key:"0"}:void 0]),1024),(0,s.createVNode)(i,{label:"Player Options"},(0,s.createSlots)({_:2},[r.slide?{name:"content",fn:(0,s.withCtx)(()=>[(0,s.createVNode)(l,{slide:r.slide},null,8,["slide"])]),key:"0"}:void 0]),1024)])}]]),Le={methods:{getState(){return this.$app.models.getState(this.selected,this.slide)},getProp(e){const t=e.prop.split(".");let o=t[0],n=this.selected;for(let e=0;e<t.length-1;e++)n=n[t[e]],o=t[e+1];return n[o]},async saveElement(e,t){e.onupdate&&await e.onupdate(this.selected,null,null,this.slide),await this.$app.models.save(this.selected)},async setTargetProperty(e,t,o){if(e.onupdate){const n=await e.onupdate(this.selected,t,o,this.slide);if(!this.selected.isElement||n)return}else"state"in e&&!0!==e.state?this.selected[t]=o?.encode?o.encode():o:this.getState()[t]=o?.encode?o.encode():o;e.nosave||(this.selected.isElement?await this.$app.models.save(this.selected):this.selected.isAsset&&await this.$app.assets.save(this.selected))},async onComponentChanged(e,t,o,n){console.log(t,o),this.selected[t]=o,this.selected.isElement?this.setTargetProperty(e,t,o,n):e.onupdate&&await e.onupdate(this.selected,t,o,this.slide)},async onCleanStateValue(e,t){e.onclean?await e.onclean(this.selected,t,e,this.slide):t in this.getState()&&(delete this.getState()[t],await this.$app.models.save(this.selected))}},computed:{selected(){return this.$app.selection.selected},selectedUID(){return this.$app.selection.uid},blocks(){return[{label:"Name",content:{component:"LabelEdit",prop:"name",state:!1},head:{component:"Label",prop:"name"}},{label:"Type",readonly:!0,head:{component:"Label",prop:"type"}},...this.$app.inspector.blocksFor(this.selected.types)]},slide(){return this.$app.slides.actived?.uid}},watch:{selected(e){console.log(e),e&&e.restore&&e.restore()}},components:{InspectorPanel:oe,modeltypes:le,assetsview:be,ViewPanel:$,SceneTools:Pe}},Re=(0,B.A)(Le,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("InspectorPanel"),c=(0,s.resolveComponent)("ViewPanel"),d=(0,s.resolveDirective)("tooltip"),p=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createVNode)(c,{class:"inspector"},{footer:(0,s.withCtx)(()=>[(0,s.createCommentVNode)(" <SceneTools></SceneTools> ")]),default:(0,s.withCtx)(()=>[r.selectedUID?((0,s.openBlock)(),(0,s.createElementBlock)("div",W,[(0,s.createCommentVNode)(" <div>{{ selected.paths.join('->') }}</div> "),(0,s.renderSlot)(e.$slots,"default",{},()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.blocks,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)(i,{label:e.label,tooltip:e.tooltip,stat:e.state,key:e.label},(0,s.createSlots)({_:2},[e.readonly?void 0:{name:"icons",fn:(0,s.withCtx)(({stat:t})=>[e.nonstate?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",{key:0,onClick:t=>r.onCleanStateValue(e.head||e.content,e.head?e.head.prop:e.content.prop),class:"remove-icon"},[(0,s.createVNode)(l,{value:"bin"})],8,K)),[[d,"Очистить значение в слайде"]])]),key:"0"},e.head?{name:"head",fn:(0,s.withCtx)(({togglePanel:t})=>[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.head.component),(0,s.mergeProps)({ref_for:!0},e.head.props,{modelValue:r.selected[e.head.prop],"onUpdate:modelValue":[t=>r.selected[e.head.prop]=t,(...t)=>r.setTargetProperty(e.head,e.head.prop,...t)],value:r.selected,property:e.head,target:e.head.state?r.getState():r.selected,onClean:(...t)=>r.onCleanStateValue(e.head,...t),onSave:t=>r.saveElement(e.head),"onUpdate:target":(...t)=>r.setTargetProperty(e.head,...t),"onUpdate:value":(...t)=>r.onComponentChanged(e.head,e.head.prop,...t),onToggle:e=>t()},(0,s.toHandlers)(e.head.events||{})),null,16,["modelValue","onUpdate:modelValue","value","property","target","onClean","onSave","onUpdate:target","onUpdate:value","onToggle"]))]),key:"1"}:void 0,e.content?{name:"content",fn:(0,s.withCtx)(({togglePanel:t})=>[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.content.component),(0,s.mergeProps)({class:"blockcomponent"},{ref_for:!0},e.content.props||{},{value:r.selected,modelValue:r.selected[e.content.prop],"onUpdate:modelValue":[t=>r.selected[e.content.prop]=t,(...t)=>r.setTargetProperty(e.content,e.content.prop,...t)],property:e.content,target:e.content.state?r.getState():r.selected,onClean:(...t)=>r.onCleanStateValue(e.content,...t),onSave:t=>r.saveElement(e.content),"onUpdate:target":(...t)=>r.setTargetProperty(e.content,...t),"onUpdate:value":(...t)=>r.onComponentChanged(e.content,e.content.prop,...t),onToggle:e=>t()},(0,s.toHandlers)(e.content.events||{})),null,16,["value","modelValue","onUpdate:modelValue","property","target","onClean","onSave","onUpdate:target","onUpdate:value","onToggle"]))]),key:"2"}:void 0]),1032,["label","tooltip","stat"]))),128))])])):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Y,[...t[0]||(t[0]=[(0,s.createTextVNode)(" $$Select an model or asset ",-1)])])),[[p]])]),_:3}),(0,s.createCommentVNode)(' <div class="panel-container">\r\n        <div class="panel">\r\n            <div class="header">Inspector</div>\r\n            <div class="content">\r\n                \r\n            </div>\r\n            <div class="footer">\r\n\r\n            </div>\r\n        </div>\r\n    </div> ')],2112)}]]),Fe={class:"hierarhy-view"},Ue={class:"hierarhy-head"},ze={class:"treeicon"},He=["draggable","droppable"],qe={class:"roottree"},Ge=["draggable"],We={class:"tree-node-content"},Ke={class:"selector"},Ye=["checked"],Je={key:0,class:"prepender"},Xe=["title"],Qe={key:1,class:"appender"},Ze={key:0,class:"children"},et={key:1};function tt(e,t){for(let o=0;o<e.length;o++)e[o].isSelected=t,e[o].children&&tt(e[o].children,t)}const ot={name:"TreeNode",props:{node:{type:Object,required:!0},selector:{type:Boolean,default:!0},index:{type:Number},focused:{type:Boolean,default:!1},childsFiled:{type:String,default:"childrens"},filter:{type:Function},draggable:{type:Boolean,default:!0},droppable:{type:Boolean,default:!0}},computed:{list(){return this.filter?this.filter(this.node[this.childsFiled]):this.node[this.childsFiled]}},data:()=>({expanded:{},childloaded:{},isLoading:!1,selectChangeEvent:(0,s.inject)("selectChangeEvent",null),clickNodeEvent:(0,s.inject)("clickNodeEvent",null),dropNodeEvent:(0,s.inject)("nodeDropEvent",null),isDragOver:!1}),methods:{onDragStart(e){this.$app.app.draggedNode=this.node,e.dataTransfer.items.add(JSON.stringify({uid:this.node.uid,type:this.node.type,isAsset:this.node.isAsset,isElement:this.node.isElement,isModel:this.node.isModel}),"application/json"),e.dataTransfer.effectAllowed="copy"},onDragOver(e){e.dataTransfer.dropEffect="copy",this.isDragOver=!0},onDragEnter(e){this.isDragOver=!0,!this.expanded[this.node.uid]&&this.node[this.childsFiled]?.length&&this.toggleExpand()},onDragLeave(){this.isDragOver=!1},onDrop(e){this.isDragOver=!1,this.dropNodeEvent({target:this.node,source:this.$app.app.draggedNode})},async toggleExpand(){this.node[this.childsFiled]&&0!==this.node[this.childsFiled].length&&(this.expanded[this.node.uid]=!this.expanded[this.node.uid],this.expanded[this.node.uid]&&!this.childloaded[this.node.uid]&&await this.loadChildren(),this.$emit("updateExpanded",this.node))},async loadChildren(){this.childloaded[this.node.uid]=!0},onChildSelectChange(e){},onCheckboxChange(e){e.isSelected=!e.isSelected,e[this.childsFiled]?.length&&tt(e[this.childsFiled],e.isSelected),this.selectChangeEvent(this.node),this.$emit("changeSelection",this.node)},selectNode(e){this.clickNodeEvent(this.node)}}},nt={components:{TreeNode:(0,B.A)(ot,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("TreeNode",!0);return(0,s.openBlock)(),(0,s.createElementBlock)("li",{class:(0,s.normalizeClass)(["tree-node",{"drag-over":a.isDragOver}]),draggable:o.draggable,onDragstart:t[3]||(t[3]=(0,s.withModifiers)(e=>o.draggable&&r.onDragStart(e),["stop"])),onDragover:t[4]||(t[4]=(0,s.withModifiers)((...e)=>r.onDragOver&&r.onDragOver(...e),["prevent"])),onDragenter:t[5]||(t[5]=(0,s.withModifiers)((...e)=>r.onDragEnter&&r.onDragEnter(...e),["prevent"])),onDragleave:t[6]||(t[6]=(...e)=>r.onDragLeave&&r.onDragLeave(...e)),onDrop:t[7]||(t[7]=(0,s.withModifiers)((...e)=>r.onDrop&&r.onDrop(...e),["prevent","stop"]))},[(0,s.createElementVNode)("div",We,[(0,s.createElementVNode)("span",{class:"collapser",onClick:t[0]||(t[0]=(...e)=>r.toggleExpand&&r.toggleExpand(...e))},[r.list?.length?(0,s.renderSlot)(e.$slots,"icon",{key:0,node:o.node},()=>[(0,s.createTextVNode)((0,s.toDisplayString)(a.expanded[o.node.uid]?"▼":"▶"),1)],!0):(0,s.createCommentVNode)("v-if",!0)]),(0,s.createElementVNode)("span",Ke,[o.selector?(0,s.renderSlot)(e.$slots,"checkbox",{key:0},()=>[(0,s.createElementVNode)("input",{ref:"checkedInput",type:"checkbox",onChange:t[1]||(t[1]=e=>r.onCheckboxChange(o.node)),checked:o.node.isSelected},null,40,Ye)],!0):(0,s.createCommentVNode)("v-if",!0)]),e.$slots.prepend?((0,s.openBlock)(),(0,s.createElementBlock)("span",Je,[(0,s.renderSlot)(e.$slots,"prepend",{node:o.node},void 0,!0)])):(0,s.createCommentVNode)("v-if",!0),(0,s.createElementVNode)("span",{class:"labeler",title:o.node.uid,onClick:t[2]||(t[2]=(...e)=>r.selectNode&&r.selectNode(...e))},[(0,s.renderSlot)(e.$slots,"label",{node:o.node},()=>[(0,s.createElementVNode)("span",null,(0,s.toDisplayString)(o.node.uid)+"|",1)],!0)],8,Xe),e.$slots.append?((0,s.openBlock)(),(0,s.createElementBlock)("span",Qe,[(0,s.renderSlot)(e.$slots,"append",{node:o.node,index:o.index},void 0,!0)])):(0,s.createCommentVNode)("v-if",!0)]),a.expanded[o.node.uid]&&Array.isArray(r.list)&&r.list.length?((0,s.openBlock)(),(0,s.createElementBlock)("ul",Ze,[a.childloaded[o.node.uid]?((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,{key:0},(0,s.renderList)(r.list,t=>((0,s.openBlock)(),(0,s.createBlock)(l,{draggable:o.draggable,onChangeSelection:r.onChildSelectChange,filter:o.filter,selector:o.selector,focused:t.focused,key:t.uid,node:t,childsFiled:o.childsFiled},(0,s.createSlots)({_:2},[(0,s.renderList)(e.$slots,(t,o)=>({name:o,fn:(0,s.withCtx)(t=>[(0,s.renderSlot)(e.$slots,o,(0,s.mergeProps)({ref_for:!0},t),void 0,!0)])}))]),1032,["draggable","onChangeSelection","filter","selector","focused","node","childsFiled"]))),128)):((0,s.openBlock)(),(0,s.createElementBlock)("div",et," load... "))])):(0,s.createCommentVNode)("v-if",!0)],42,Ge)}],["__scopeId","data-v-9bb33550"]])},computed:{list(){return this.filter?this.filter(this.tree):this.tree}},data:()=>({expandeds:{},isDragOver:!1}),props:{tree:{type:Array,required:!0},selector:{type:Boolean,default:!1},focused:{type:Boolean,default:!1},childsFiled:{type:String,default:"children"},filter:{type:Function},draggable:{type:Boolean,default:!1},droppable:{type:Boolean,default:!1}},setup(e,{slots:t,emit:o}){(0,s.provide)("clickNodeEvent",e=>{o("clickNode",e)}),(0,s.provide)("selectChangeEvent",e=>{o("changeSelect",e)}),(0,s.provide)("nodeDropEvent",e=>{o("node-drop",e)})},methods:{onDragOver(e){e.dataTransfer.dropEffect="copy",this.isDragOver=!0},onDragEnter(e){this.isDragOver=!0},onDragLeave(){this.isDragOver=!1},onDrop(e){this.isDragOver=!1,console.log(e.dataTransfer?.items);for(let t of e.dataTransfer?.items)console.log(`Type: ${t.type}, Kind: ${t.kind}`),"text/plain"!==t.type&&"application/json"!==t.type||t.getAsString(e=>{const t=JSON.parse(e);this.$emit("node-drop",{target:null,source:t})})},onUpdateExpanded(e){},findNodeByUid(e,t){for(let o of e){if(o.uid===t)return o;if(o.children){let e=this.findNodeByUid(o.children,t);if(e)return e}}return null},removeNodeFromTree(e,t){for(let o=0;o<e.length;o++){if(e[o].uid===t)return e.splice(o,1),!0;if(e[o][this.childsFiled]&&this.removeNodeFromTree(e[o][this.childsFiled],t))return!0}return!1}}},at=(0,B.A)(nt,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("TreeNode");return(0,s.openBlock)(),(0,s.createElementBlock)("div",{class:(0,s.normalizeClass)(["treecontainer",{"drag-over":a.isDragOver}]),draggable:o.draggable,droppable:o.droppable,onDrop:t[0]||(t[0]=(0,s.withModifiers)((...e)=>r.onDrop&&r.onDrop(...e),["prevent","stop"])),onDragover:t[1]||(t[1]=(0,s.withModifiers)((...e)=>r.onDragOver&&r.onDragOver(...e),["prevent"])),onDragenter:t[2]||(t[2]=(0,s.withModifiers)((...e)=>r.onDragEnter&&r.onDragEnter(...e),["prevent"])),onDragleave:t[3]||(t[3]=(...e)=>r.onDragLeave&&r.onDragLeave(...e))},[(0,s.createElementVNode)("ul",qe,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.list,(t,n)=>((0,s.openBlock)(),(0,s.createBlock)(l,{key:t.uid,filter:o.filter,selector:o.selector,node:t,index:n,focused:o.focused,childsFiled:o.childsFiled,onUpdateExpanded:r.onUpdateExpanded,draggable:o.draggable,droppable:o.droppable},(0,s.createSlots)({_:2},[(0,s.renderList)(e.$slots,(t,o)=>({name:o,fn:(0,s.withCtx)(t=>[(0,s.renderSlot)(e.$slots,o,(0,s.mergeProps)({ref_for:!0},t),void 0,!0)])}))]),1032,["filter","selector","node","index","focused","childsFiled","onUpdateExpanded","draggable","droppable"]))),128))])],42,He)}],["__scopeId","data-v-d3191960"]]),st={name:"TreeAssets",props:{title:""},data:()=>({filtersView:!1,filterRect:{},focused:[],editform:!1,editedAsset:{},newAsset:!1,viewlib:!1,libButtons:{add:!0,save:!1}}),watch:{"assets.list"(e){console.log(e)}},computed:{models(){return this.$app.models},slide(){return this.$app.slides.actived},tree(){return this.$app.assets.list.reduce((e,t)=>{let o=e.find(e=>e.type===t.type);return o||(o={isgroup:!0,type:t.type,children:[],uid:t.type},e.push(o)),o.children.push(t),e},[])},assets(){return this.$app.assets},selected(){return this.$app.selection.selected}},methods:{onEdit(e,t){this.editedAsset[e]=t},editAsset(e){this.editedAsset=e?{...e,progress:0}:{uid:null,type:"model",name:"New asset",url:"https://",parameters:{},progress:0},this.$app.assets.editAsset(this.editedAsset)},insertAsset(e){this.$app.project.handleAsset({source:e,target:this.$app.selection.selected})},onUpdateExpanded(e){},onNodeClick(e){this.$app.selection.select(e.isgroup?null:e)},onChangeSelection(){},remove(e){this.$app.modal.confirmReq((0,s.reactive)({title:"Confirm asset remove",text:`Remove asset ${e.name||e.uid} ?`}),[{label:"YES",class:"primary",callback:async()=>{this.assets.remove(e)}},{label:"NO",class:"secondary",callback:async e=>{this.$app.modal.close()}}])}},components:{TreeView:at}},rt=(0,B.A)(st,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("TreeView"),c=(0,s.resolveDirective)("translate"),d=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Fe,[(0,s.createElementVNode)("div",Ue,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",null,[(0,s.createTextVNode)((0,s.toDisplayString)(o.title)+":",1)])),[[c]]),t[2]||(t[2]=(0,s.createTextVNode)()),(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=e=>r.assets.selectAsset([],!1))},[(0,s.createVNode)(l,{value:"plus",size:"0.75em"})])]),(0,s.createVNode)(i,{childsFiled:"children",tree:r.tree,onClickNode:r.onNodeClick,onChangeSelect:r.onChangeSelection,onUpdateExpanded:r.onUpdateExpanded,draggable:!0},{prepend:(0,s.withCtx)(({node:e})=>[e.isAsset?((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,value:r.assets.icons[e.type],size:"1em"},null,8,["value"])):(0,s.createCommentVNode)("v-if",!0)]),append:(0,s.withCtx)(({node:e,index:t})=>[(0,s.createElementVNode)("div",ze,[(0,s.createCommentVNode)(' <icon v-if="!node.isgroup" value="target" v-tooltip="\'Find\'" size="1em" @click="$emit(\'target\', node)"></icon> '),(0,s.createCommentVNode)(' <icon v-if="!node.isgroup" value="pencil" v-tooltip="\'Редактировать\'" size="1em" @click="editAsset(node)">\r\n          </icon> '),e.isModel&&r.slide?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,value:"download",size:"1em",onClick:t=>r.models.createFromAsset(e)},null,8,["onClick"])),[[d,"Insert to scene"]]):(0,s.createCommentVNode)("v-if",!0),e.isgroup?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:1,value:"bin",size:"1em",onClick:t=>r.remove(e)},null,8,["onClick"])),[[d,"Delete"]])])]),label:(0,s.withCtx)(({node:o})=>[(0,s.createCommentVNode)(' <div @click="onSelectedNode" :class="{ \'focusedtree\': selected === node }"  class="label"\r\n          v-tooltip="`${node.url || node.type}`"> {{ node.name || node.uid }}</div> '),(0,s.createElementVNode)("div",{onClick:t[1]||(t[1]=(...t)=>e.onSelectedNode&&e.onSelectedNode(...t)),class:(0,s.normalizeClass)([{focusedtree:r.selected===o},"label"])},(0,s.toDisplayString)(o.name||o.uid),3)]),_:1},8,["tree","onClickNode","onChangeSelect","onUpdateExpanded"])])}],["__scopeId","data-v-4acc2793"]]),lt={class:"hierarhy-view"},it={class:"treeicon"},ct={class:"container"},dt={class:"block"},pt={class:"content"},ut={class:"sub-content"},mt={class:"subtitle"},ht={class:"subtitle"},ft=["value"],vt={props:{callback:{type:Function},modelValue:{type:Object,default:()=>({label:"",type:"model"})},parent:{type:Object},list:{type:Array}},computed:{name:{get(){return this.modelValue.name},set(e){this.$emit("update:modelValue",{name:e,type:this.modelValue.type})}},type:{get(){return this.modelValue.type},set(e){this.$emit("update:modelValue",{name:this.modelValue.name,type:e})}}}},gt=(0,B.A)(vt,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",ct,[(0,s.createElementVNode)("div",dt,[(0,s.createElementVNode)("div",pt,[(0,s.createElementVNode)("div",ut,[(0,s.createElementVNode)("div",mt,[(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"text",placeholder:"Name","onUpdate:modelValue":t[0]||(t[0]=e=>r.name=e)},null,512),[[s.vModelText,r.name]])]),(0,s.createElementVNode)("div",ht,[(0,s.withDirectives)((0,s.createElementVNode)("select",{class:"typeslist","onUpdate:modelValue":t[1]||(t[1]=e=>r.type=e)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,e=>(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("option",{value:e.type},[(0,s.createTextVNode)((0,s.toDisplayString)(e.label),1)],8,ft)),[[l,`elements.${e.label}`]])),256))],512),[[s.vModelSelect,r.type]])])])])])])}],["__scopeId","data-v-4e7f94d3"]]),yt={name:"TreeElement",props:{title:""},mounted(){},data:()=>({filtersView:!1,filterRect:{},requestRemove:!1,removeData:{text:""},newElementData:{},addElementView:!1}),computed:{selected(){return this.$app.selection.selected},selection(){return this.$app.selection},tree(){return this.$app.elements.children}},methods:{filterElements:e=>e,async insertToSlide(e){e.state?this.$app.toasts.add({message:"Элемент уже добавлен в этот слайд"}):await this.$app.slides.addState(e)},deleteElement(e){this.removeData.text=`Delete ${e.name} (${e.uid}) ?`,this.$app.modal.open({header:{value:"Delete item",handler:()=>{this.$app.modal.close(),this.requestRemove=!1}},content:{},footer:{buttons:[{label:"Delete",class:"secondary",handler:async()=>{this.$app.modal.close(),this.requestRemove=!1,this.$app.elements.remove(e),this.$app.toasts.add({message:`Элемент ${e.name} удален`})}},{label:"Cancel",class:"primary",handler:async()=>{this.$app.modal.close(),this.requestRemove=!1}}]}})},onUpdateExpanded(e){},onNodeClick(e){this.$app.selection.select(e)},onChangeSelection(){},addElement(){if(this.selected){const e=this.$app.elements.findElement(this.selected.paths);this.$app.selection.select(e)}let e;this.newElementData.name="New Element",this.newElementData.uid=`Element${Date.now()}`,this.newElementData.type="Group",this.newElementData.paths=[],this.selected&&this.selected.isElement&&(e=this.selected,this.newElementData.paths.push(...this.selected.paths)),this.newElementData.paths.push(this.newElementData.uid),this.newElementData.path=this.newElementData.paths.join("."),this.newElementData.props={visible:!0},this.$app.modal.open({header:{value:`Add element ${e?" to "+e.name||0:" scene"}`,handler:()=>{this.$app.modal.close(),this.addElementView=!1}},content:{},footer:{buttons:[{label:"Add",class:"secondary",handler:async()=>{await this.$app.elements.create(this.newElementData,e),this.$app.modal.close(),this.addElementView=!1}},{label:"Cancel",class:"primary",handler:async()=>{this.$app.modal.close(),this.addElementView=!1}}]}}),this.addElementView=!0}},components:{TreeView:at,ElementAdd:gt}},bt=(0,B.A)(yt,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("TreeView"),c=(0,s.resolveComponent)("ElementAdd"),d=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",lt,[(0,s.createElementVNode)("div",null,[(0,s.createTextVNode)((0,s.toDisplayString)(o.title)+": ",1),(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=(...e)=>r.addElement&&r.addElement(...e))},[(0,s.createVNode)(l,{value:"plus",size:"0.75em"})])]),(0,s.createVNode)(i,{filter:r.filterElements,tree:r.tree,onClickNode:r.onNodeClick,onChangeSelect:r.onChangeSelection,childsFiled:"children",onUpdateExpanded:r.onUpdateExpanded,selector:!1},{append:(0,s.withCtx)(({node:e,index:t})=>[(0,s.createElementVNode)("div",it,[(0,s.createCommentVNode)(' <icon value="target" v-tooltip="\'Фокус\'" size="1em" @click="$emit(\'target\', node)"></icon>'),(0,s.createCommentVNode)(" <icon v-tooltip=\"'Видимость'\" :value=\"node.show ? 'eye' : 'eye-blocked'\" size=\"1em\"\r\n            @click=\"node.visible = !node.visible\" :color=\"node.visible ? '#8ec58e' : '#8ec58e80'\">\r\n          </icon> "),e.parent?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,value:"dice",size:"1em",onClick:t=>r.insertToSlide(e),color:e.state?"#8ec58e":"#8ec58e80"},null,8,["onClick","color"])),[[d,"Add to slide"]]),(0,s.withDirectives)((0,s.createVNode)(l,{onClick:t=>r.deleteElement(e),value:"bin",size:"1em"},null,8,["onClick"]),[[d,"Remove"]]),(0,s.createCommentVNode)(' <icon v-if="index === 0" size="100%" value="bin"></icon> ')])]),label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)([{focusedtree:r.selected===e},"label"])},(0,s.toDisplayString)(e.name||e.uid),3)]),_:1},8,["filter","tree","onClickNode","onChangeSelect","onUpdateExpanded"]),a.addElementView?((0,s.openBlock)(),(0,s.createBlock)(s.Teleport,{key:0,to:".modal-content"},[(0,s.createVNode)(c,{value:a.newElementData,"onUpdate:value":t[1]||(t[1]=e=>a.newElementData=e),parent:r.selected},null,8,["value","parent"])])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-3eac9d53"]]),kt={class:"hierarhy-view"},wt={class:"hierarhy-head"},Et=["onUpdate:modelValue","onChange"],_t={class:"treeicon"};function St(e,t){e.children??=[],(t.children||[]).forEach(t=>{let o=e.children.find(e=>e.path===t.path);o?St(o,t):e.children.push(t)})}const Nt=(0,o(334).reactive)({addMenu:function(e,...t){t.forEach(t=>{const o=Nt[e].list.find(e=>e.path===t.path);o?St(o,t):Nt[e].list.push(t)})},top:{list:[]}});Symbol.toStringTag;let Vt="en",Ct={},Bt=[],$t="$$";const xt={beforeMount(e,t){Dt(e,t),Bt.push(()=>{Dt(e,t)})},updated(e,t){Dt(e,t)}};function Dt(e,t){(function(e){const t=[],o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let n;for(;n=o.nextNode();)n.nodeValue.trim()&&t.push(n);return t})(e).forEach(o=>{const n=o.nodeValue.trim();if(t.value||n.startsWith($t)||e.$translate){let a;e.$translate||(t.value?e.$translate=n.startsWith($t)?n.slice($t.length):n:n.startsWith($t)?e.$translate=n.slice($t.length):e.$translate=n),a=t.value?t.value.startsWith($t)?t.value.slice($t.length):t.value:n.startsWith($t)?n.slice($t.length):e.$translate;const s=Tt(a);o.nodeValue=s===a?e.$translate:s}})}function Tt(e,t){if(!Ct[Vt])return e;let o=Ct[Vt][e]??e;return t&&Object.keys(t).forEach(e=>{o=o.replace(e,t[e])}),o}function It(e){return Bt.push(e),()=>{const t=Bt.indexOf(e);t>-1&&Bt.splice(t,1)}}const At=Object.freeze(Object.defineProperty({__proto__:null,directive:xt,getCurrentLanguage:function(){return Vt},interTranslate:async function(e,t,o){try{return await(await Translator.create({sourceLanguage:t,targetLanguage:o})).translate(e)}catch(e){console.error("Ошибка перевода:",e)}},onLanguageChange:It,setLanguage:function(e){Vt!==e&&Ct[e]&&(Vt=e,Bt.forEach(t=>t(e)))},setOptions:function(e){e.sym&&($t=e.sym)},setTranslations:function(e,t){Ct[e]=t,Vt===e&&Bt.forEach(t=>t(e))},translateText:Tt,updateTranslations:function(e,t){const o=Ct[e];o&&Object.keys(t).forEach(e=>{o[e]=t[e]})}},Symbol.toStringTag,{value:"Module"})),Mt=document.createElement("div");Mt.className="tooltip",Mt.style.position="absolute",Mt.style.visibility="hidden",document.body.appendChild(Mt);let Ot=null;const jt=(e,t,o)=>{const n=((e,t)=>{if(t){const o=Tt(`tooltip.${t}`);return o===`tooltip.${t}`?e:o}if("string"==typeof e){const t=Tt(`tooltip.${e}`);return t===`tooltip.${e}`?e:t}return e})(t,o.arg);if(Mt.textContent=n,!n||0===n.length)return void(Mt.style.visibility="hidden");const a=e.getBoundingClientRect();let s=a.left+window.scrollX+a.width/2-Mt.offsetWidth/2,r=a.top+window.scrollY-Mt.offsetHeight-5;s+Mt.offsetWidth>window.innerWidth&&(s=window.innerWidth-Mt.offsetWidth-10),s<0&&(s=10),r+Mt.offsetHeight>window.innerHeight&&(r=a.top+window.scrollY+a.height+5),r<0&&(r=a.top+window.scrollY+a.height+5),Mt.style.left=`${s}px`,Mt.style.top=`${r}px`,Mt.style.visibility="visible"};It(()=>{if(Ot){const e=Ot.__lastTooltipValue__;jt(Ot,e)}});const Pt={beforeMount(e,t){e.__lastTooltipValue__=t.value;const o=()=>{Ot=e,jt(e,t.value,t)},n=()=>{Ot===e&&(Mt.style.visibility="hidden",Ot=null)};e.__tooltipHandlers__={mouseEnterHandler:o,mouseLeaveHandler:n},e.addEventListener("mouseenter",o),e.addEventListener("mouseleave",n)},updated(e,t){e.__lastTooltipValue__=t.value,Ot===e&&jt(e,t.value,t)},unmounted(e){const{mouseEnterHandler:t,mouseLeaveHandler:o}=e.__tooltipHandlers__||{};t&&e.removeEventListener("mouseenter",t),o&&e.removeEventListener("mouseleave",o),Ot===e&&(Mt.style.visibility="hidden",Ot=null)}},Lt={name:"TreeElement",props:{title:""},data:()=>({filtersView:!1,filterRect:{},requestRemove:!1,removeData:{text:""}}),computed:{models(){return this.$app.models},selected(){return this.$app.selection.selected},selection(){return this.$app.selection},tree(){return this.$app.models.children}},methods:{onDrop(e){if(e.source.isAsset)switch(e.source.type){case"model":case"image":const t=this.$app.assets.getAsset(e.source.uid);this.models.createFromAsset(t,e.target?.paths);break;default:this.$app.toasts.add({message:At.translateText("This type cannot be placed on stage")})}},async updateVisible(e){this.$app.models.getState(e,this.$app.slides.actived.uid).visible=e.visible,await this.$app.models.save(e)},filterElements:e=>e.filter(e=>e.isElement||e.isHepler),async insertToSlide(e){e.state?this.$app.toasts.add({message:"The element has already been added to this slide"}):await this.$app.slides.addState(e)},deleteElement(e){this.removeData.text=`Delete ${e.name} (${e.uid}) ?`,this.$app.modal.open({header:{value:"Delete item",handler:()=>{this.$app.modal.close(),this.requestRemove=!1}},content:{},footer:{buttons:[{label:"Delete",class:"secondary",handler:async()=>{this.$app.modal.close(),this.requestRemove=!1,this.$app.models.remove(e.paths),this.$app.toasts.add({message:`The element ${e.name} is deleted`})}},{label:"Cancel",class:"primary",handler:async()=>{this.$app.modal.close(),this.requestRemove=!1}}]}})},onUpdateExpanded(e){},onNodeClick(e){this.$app.selection.select(e)},onChangeSelection(){}},components:{TreeView:at}},Rt=(0,B.A)(Lt,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("TreeView"),c=(0,s.resolveDirective)("translate"),d=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",kt,[(0,s.createElementVNode)("div",wt,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",null,[(0,s.createTextVNode)((0,s.toDisplayString)(o.title)+":",1)])),[[c]]),t[1]||(t[1]=(0,s.createTextVNode)()),(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=e=>r.models.createTo(r.selected))},[(0,s.createVNode)(l,{value:"plus",size:"0.75em"})])]),(0,s.createVNode)(i,{filter:r.filterElements,tree:r.tree,onClickNode:r.onNodeClick,onChangeSelect:r.onChangeSelection,childsFiled:"children",onUpdateExpanded:r.onUpdateExpanded,selector:!1,droppable:!0,onNodeDrop:r.onDrop},{prepend:(0,s.withCtx)(({node:e,index:t})=>[(0,s.createElementVNode)("div",null,[(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t=>e.visible=t,onChange:t=>r.updateVisible(e)},null,40,Et),[[s.vModelCheckbox,e.visible]])])]),append:(0,s.withCtx)(({node:e,index:t})=>[(0,s.createElementVNode)("div",_t,[(0,s.createCommentVNode)(' <icon value="target" v-tooltip="\'Фокус\'" size="1em" @click="$emit(\'target\', node)"></icon>'),(0,s.createCommentVNode)(" <icon v-tooltip=\"'Видимость'\" :value=\"node.show ? 'eye' : 'eye-blocked'\" size=\"1em\"\r\n            @click=\"node.visible = !node.visible\" :color=\"node.visible ? '#8ec58e' : '#8ec58e80'\">\r\n          </icon> "),e.parent?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,value:"dice",size:"1em",onClick:t=>r.insertToSlide(e),color:e.state?"#8ec58e":"#8ec58e80"},null,8,["onClick","color"])),[[d,"Add to slide"]]),(0,s.withDirectives)((0,s.createVNode)(l,{onClick:t=>r.deleteElement(e),value:"bin",size:"1em"},null,8,["onClick"]),[[d,"Remove"]]),(0,s.createCommentVNode)(' <icon v-if="index === 0" size="100%" value="bin"></icon> ')])]),label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)([{focusedtree:r.selected===e},"label"])},(0,s.toDisplayString)(e.name||e.uid),3)]),_:1},8,["filter","tree","onClickNode","onChangeSelect","onUpdateExpanded","onNodeDrop"])])}],["__scopeId","data-v-58798798"]]),Ft={class:"hierarhy-view"},Ut={class:"treeicon"},zt={name:"Hierarhy",props:{title:""},data:()=>({filtersView:!1,filterRect:{}}),computed:{selected(){return this.$app.selection.selected},slide(){return this.$app.slides.actived||{children:[]}}},methods:{getElement(){},removeSlide(){this.$app.slides.remove(this.$app.slides.actived.uid)},removeState(e){this.$app.slides.removeState(e.paths),this.$app.toasts.add({message:`${e.data.name||e.uid} удален`})},onNodeClick(e){this.$app.selection.select(e)},onChangeSelection(){},onUpdateExpanded(){},assState(){"block"===this.$app.selection.element?.type||this.$app.toasts.add({message:"Только типы block можно добавлять в состояния"})}},components:{TreeView:at}},Ht=(0,B.A)(zt,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("TreeView"),c=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Ft,[(0,s.createElementVNode)("div",null,[(0,s.createTextVNode)((0,s.toDisplayString)(o.title)+" : "+(0,s.toDisplayString)(r.slide.name)+" ",1),(0,s.withDirectives)((0,s.createVNode)(l,{onClick:t[0]||(t[0]=e=>r.removeSlide()),value:"bin",size:"1em"},null,512),[[c,"Delete slide"]])]),(0,s.createVNode)(i,{tree:r.slide.children,onClickNode:r.onNodeClick,onChangeSelect:r.onChangeSelection,onUpdateExpanded:r.onUpdateExpanded,selector:!1},{checkbox:(0,s.withCtx)(()=>[...t[1]||(t[1]=[(0,s.createElementVNode)("span",null,[(0,s.createElementVNode)("input",{type:"checkbox"})],-1)])]),append:(0,s.withCtx)(({node:e,index:t})=>[(0,s.createCommentVNode)(' <div class="filters" v-if="index === 0">\n                    <button v-tooltip="\'Change filters\'"  @click="viewFilters" class="filterbutton">\n                        <icon v-for="v in target.filters" :value="v.props.value" :color="v.props.color" size="1em"></icon>\n                    </button>\n                    <PopupList v-if="filtersView" :rect="filterRect" :values="target.filters" @callback="filtersView = false"></PopupList>\n                </div> '),(0,s.createElementVNode)("div",Ut,[(0,s.createCommentVNode)(' <icon value="target" v-tooltip="\'Fit\'" size="1em" @click="$emit(\'target\', node)"></icon>\n          <icon v-tooltip="\'Visible\'" :value="node.isVisible ? \'eye\' : \'eye-blocked\'" size="1em"\n            @click="$emit(\'visible\', node)">\n          </icon> '),e.isBlock?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,onClick:t=>r.removeState(e),value:"bin",size:"1em"},null,8,["onClick"])),[[c,"Remove element from slide"]]):(0,s.createCommentVNode)("v-if",!0)])]),label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)([{focusedtree:r.selected===e},"label"])},(0,s.toDisplayString)(e.name||e.element.uid),3)]),_:1},8,["tree","onClickNode","onChangeSelect","onUpdateExpanded"])])}],["__scopeId","data-v-6bf93691"]]),qt={class:"transformer"},Gt={class:"icons"};var Wt=o(24),Kt=o(0);function Yt(e){return 180*e/Math.PI}function Jt(e){return e*Math.PI/180}function Xt(e){const t=new WeakSet;return JSON.stringify(e,(e,o)=>{if("object"==typeof o&&null!==o&&!Array.isArray(o)){if(t.has(o))return console.log("Exist ",o),o.encode?o.encode():void 0;t.add(o)}return o})}function Qt(e,t){let o=1,n=e;for(;t.includes(n);)n=`${e}_${o}`,o++;return n}let Zt,eo,to;function oo(){console.log("focus");const e=eo.object;Zt.update();let t=!1;if(e.traverse(e=>{e.isMesh&&(t=!0)}),t){const t=new Ee.Box3;e.traverse(e=>{t.expandByObject(e)});const o=new Ee.Sphere;t.getBoundingSphere(o),no.FitTo(o)}else no.FitTo({center:e.position,radius:.25})}class no{static FocusToSelect(){eo.object&&oo()}static FocusTo(e){Zt.target.copy(e.isObject3D?e.position:e)}static MoveTo(e,t){const o={position:new Ee.Vector3,time:1e3,...e,control:!1},n={position:new Ee.Vector3,time:1e3,...t,control:!1};Zt.enabled=!1;const a=Workspace.Camera.position.clone(),s=Zt.target.clone();o.control=o.time>n.time,n.control=n.time>=o.time;const r=new Tween(a).to(o.position,o.time).easing(Easing.Quadratic.InOut).onUpdate(()=>{Workspace.Camera.position.copy(a),Workspace.Camera.updateProjectionMatrix(),Zt.update()}).onComplete(()=>{o.control&&(Zt.enabled=!0),tweengroup.remove(r)}).start(),l=new Tween(s).to(n.position,n.time).easing(Easing.Quadratic.InOut).onUpdate(()=>{Zt.target.copy(s),Zt.getPolarAngle()>Zt.maxPolarAngle&&Zt.target.setY(center.y+Math.cos(Zt.maxPolarAngle)*distance)}).onComplete(()=>{n.control&&(Zt.enabled=!0),tweengroup.remove(l)}).start();tweengroup.add(r,l)}static SetState(e){Zt.enabled=e}static Init({canvas:e},t,o){to=t,Zt=new Wt.N(t,e),Zt.enabled=!0,Zt.enableDamping=!0,Zt.dampingFactor=.25,Zt.screenSpacePanning=!1,Zt.minDistance=.01,Zt.maxDistance=1e3,eo=new Kt.ZU(t,e),eo.addEventListener("dragging-changed",e=>{Zt.enabled=!e.value,e.target.object&&e.target.object.onTransform&&e.target.object.onTransform()});const n=eo.getHelper();o.add(n),eo.getRaycaster().layers.set(1),n.traverse(e=>{e.layers.set(1)}),window.addEventListener("keydown",e=>{switch(Zt.enabled=!e.ctrlKey,e.code){case"KeyQ":eo.setSpace("local"===eo.space?"world":"local");break;case"Shift":eo.setTranslationSnap(1),eo.setRotationSnap(Ee.MathUtils.degToRad(15)),eo.setScaleSnap(.25);break;case"KeyW":eo.setMode("translate");break;case"KeyE":eo.setMode("rotate");break;case"KeyR":eo.setMode("scale");break;case"KeyF":eo.object&&oo();break;case"KeyC":case"KeyV":case"KeyX":case"KeyY":case"KeyZ":case" ":case"Escape":break;case"+":case"=":eo.setSize(eo.size+.1);break;case"-":case"_":eo.setSize(Math.max(eo.size-.1,.1))}}),window.addEventListener("keyup",e=>{Zt.enabled=!e.ctrlKey,"Shift"===e.key&&(eo.setTranslationSnap(null),eo.setRotationSnap(null),eo.setScaleSnap(null))})}static get Transformer(){return eo}static Select(e){e?(eo.attach(e),e.onSelect&&e.onSelect()):eo.detach()}static Update(e){Zt.update(e)}static FitTo({center:e,radius:t}){const o=Jt(to.fov),n=Math.max(t,.25)/Math.sin(o/2),a=(new Ee.Vector3).subVectors(to.position,e).normalize();!function(e,t,o=1){Zt.enabled=!1;const n=o,a=to.position.clone(),s=Zt.target.clone(),r=Date.now();!function o(){const l=(Date.now()-r)/(1e3*n);if(l>=1)return to.position.copy(e),Zt.enabled=!0,Zt.target.copy(t),void Zt.update();to.position.lerpVectors(a,e,l),Zt.target.lerpVectors(s,t,l),Zt.update(),requestAnimationFrame(o)}()}(e.clone().add(a.multiplyScalar(n)),e,.5)}}const ao=no,so={props:{list:{type:Array},options:{size:"1.5em"}},methods:{setSpace(){ao.Transformer.setSpace("local"===ao.Transformer.space?"world":"local")},setMode(e){ao.Transformer.setMode(e)}}},ro=(0,B.A)(so,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",qt,[(0,s.createElementVNode)("div",Gt,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,(e,t)=>(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:t,size:o.options.size,value:e.icon,onClick:e.handler},null,8,["size","value","onClick"])),[[i,e.hint]])),128))])])}]]),lo={class:"horizontal-menu"},io={href:"#"},co={class:"submenu"},po={href:"#"},uo={class:"submenu"},mo={href:"#"},ho={mounted(){}},fo=(0,B.A)(ho,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon");return(0,s.openBlock)(),(0,s.createElementBlock)("ul",lo,[t[7]||(t[7]=(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",{href:"#"},[(0,s.createElementVNode)("i",{class:"fas fa-home menu-icon"}),(0,s.createElementVNode)("span",{class:"menu-text"},"Главная")])],-1)),(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",io,[(0,s.createVNode)(l,{value:"folder",size:"1em"}),t[0]||(t[0]=(0,s.createElementVNode)("span",{class:"menu-text"},"Товары",-1)),t[1]||(t[1]=(0,s.createElementVNode)("i",{class:"fas fa-chevron-down menu-arrow"},null,-1))]),(0,s.createElementVNode)("ul",co,[(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",po,[(0,s.createVNode)(l,{value:"bell",size:"1em"}),t[2]||(t[2]=(0,s.createElementVNode)("span",{class:"menu-text"},"Электроника",-1)),t[3]||(t[3]=(0,s.createElementVNode)("i",{class:"fas fa-chevron-right menu-arrow"},null,-1))]),(0,s.createElementVNode)("ul",uo,[(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",mo,[(0,s.createVNode)(l,{value:"cog",size:"1em"}),t[4]||(t[4]=(0,s.createElementVNode)("span",{class:"menu-text"},"Смартфоны",-1))])]),t[5]||(t[5]=(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",{href:"#"},[(0,s.createElementVNode)("i",{class:"fas fa-tablet-alt menu-icon"}),(0,s.createElementVNode)("span",{class:"menu-text"},"Планшеты")])],-1))])]),t[6]||(t[6]=(0,s.createElementVNode)("li",null,[(0,s.createElementVNode)("a",{href:"#"},[(0,s.createElementVNode)("i",{class:"fas fa-tshirt menu-icon"}),(0,s.createElementVNode)("span",{class:"menu-text"},"Одежда")])],-1))])]),t[8]||(t[8]=(0,s.createStaticVNode)('<li data-v-202d206c><a href="#" data-v-202d206c><i class="fas fa-info-circle menu-icon" data-v-202d206c></i><span class="menu-text" data-v-202d206c>О нас</span><i class="fas fa-chevron-down menu-arrow" data-v-202d206c></i></a><ul class="submenu" data-v-202d206c><li data-v-202d206c><a href="#" data-v-202d206c><i class="fas fa-history menu-icon" data-v-202d206c></i><span class="menu-text" data-v-202d206c>История</span></a></li><li data-v-202d206c><a href="#" data-v-202d206c><i class="fas fa-users menu-icon" data-v-202d206c></i><span class="menu-text" data-v-202d206c>Команда</span></a></li></ul></li><li data-v-202d206c><a href="#" data-v-202d206c><i class="fas fa-envelope menu-icon" data-v-202d206c></i><span class="menu-text" data-v-202d206c>Контакты</span></a></li>',2))])}],["__scopeId","data-v-202d206c"]]),vo={class:"horizontal-menu"},go={class:"menu-text"},yo={key:0,class:"submenu"},bo={name:"MenuItem",props:{item:{type:Object,required:!0}},methods:{onClick(e){!e.children&&e.handler&&e.handler()}}},ko={components:{MenuItem:(0,B.A)(bo,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("MenuItem",!0),c=(0,s.resolveDirective)("translate"),d=(0,s.resolveDirective)("tooltip");return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("li",{class:(0,s.normalizeClass)({"has-children":o.item.children})},[(0,s.createElementVNode)("div",{class:"item",onClick:t[0]||(t[0]=e=>r.onClick(o.item))},[(0,s.createVNode)(l,{value:o.item.children?"folder":o.item.icon,size:"1em"},null,8,["value"]),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",go,[(0,s.createTextVNode)((0,s.toDisplayString)(o.item.text),1)])),[[c,`$$menu.${o.item.text}`]])]),o.item.children?((0,s.openBlock)(),(0,s.createElementBlock)("ul",yo,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.item.children,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)(i,{key:t,item:e},null,8,["item"]))),128))])):(0,s.createCommentVNode)("v-if",!0)],2)),[[d,o.item.tooltip]])}],["__scopeId","data-v-05284cb2"]])},props:{menu:{type:Object}},data:()=>({menuData:[{icon:"fas fa-home",text:"Главная",link:"#"},{icon:"folder",text:"Товары",link:"#",children:[{icon:"bell",text:"Электроника",link:"#",children:[{icon:"cog",text:"Смартфоны",link:"#"},{icon:"fas fa-tablet-alt",text:"Планшеты",link:"#"}]},{icon:"fas fa-tshirt",text:"Одежда",link:"#"}]},{icon:"fas fa-info-circle",text:"О нас",link:"#",children:[{icon:"fas fa-history",text:"История",link:"#"},{icon:"fas fa-users",text:"Команда",link:"#"}]},{icon:"fas fa-envelope",text:"Контакты",link:"#"}]})},wo=(0,B.A)(ko,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("MenuItem");return(0,s.openBlock)(),(0,s.createElementBlock)("ul",vo,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.menu,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)(l,{key:t,item:e},null,8,["item"]))),128))])}],["__scopeId","data-v-30250442"]]);var Eo=o(320);const _o={class:"dropdown"},So={key:0,class:"dropdown-menu"},No=["onClick"],Vo={__name:"userpanel",setup(e){const t=Eo.default.default||Eo.default,o=(0,s.ref)(!1),n=(0,s.computed)(()=>t.app.user.registered?[{label:"Options",handler:()=>{}},{label:"Logout",handler:t.app.logout}]:[{label:"Login",handler:i}]),a=()=>{o.value=!o.value},r=(0,s.useTemplateRef)("dropdown"),l=e=>{r.value?.contains(e.target)||(o.value=!1)};(0,s.watch)(o,e=>{e?window.addEventListener("click",l):window.removeEventListener("click",l)});const i=()=>{t.modal.open({header:{value:"Login",handler:()=>{t.modal.close()}},content:{component:"LoginForm",props:{},events:{success:()=>{t.modal.close(),t.app.init()}}},footer:{buttons:[]}})};return(e,l)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",_o,[(0,s.createCommentVNode)(" Триггер для открытия меню "),(0,s.createElementVNode)("div",{ref_key:"dropdown",ref:r,class:"dropdown-trigger",onClick:a},(0,s.toDisplayString)((0,s.unref)(t).app.user.name),513),(0,s.createCommentVNode)(" Выпадающее меню "),(0,s.createVNode)(s.Transition,{name:"fade"},{default:(0,s.withCtx)(()=>[o.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",So,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(n.value,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("a",{key:t,class:"dropdown-item",onClick:t=>(e=>{o.value=!1,e.handler()})(e)},(0,s.toDisplayString)(e.label),9,No))),128))])):(0,s.createCommentVNode)("v-if",!0)]),_:1})]))}},Co=(0,B.A)(Vo,[["__scopeId","data-v-4594b897"]]),Bo={name:"UI",props:{element:null},data(){return{version:"0.0.9",ui:{blocks:[{component:"AssetsTree",data:{title:"$$Assets"},onSelect:this.onSelectAsset},{component:"ModelsTree",data:{title:"$$Models"},onSelect:()=>{}}],header:{buttons:this.$app.menu.hierarhy.list}},name:"",selectedSlide:null,selectedNodes:[]}},methods:{onButtonClick(e){e.handler&&e.handler()},onSelectAsset(e){},onSelectedNodesUpdate(){},camChange(e){const t=e.target.value,o=this.cameras.find(e=>e.uid===t);o&&"function"==typeof o.handler?o.handler():console.warn(`No handler found for camera with UID: ${t}`)},handleSlideSelected(e){this.selectedSlide=e},activateInMenu(e,t){if(!t)return this.menu.actived[e]=null,void("main"===e&&(this.menu.ext.length=0));this.menu.actived[e]=t.id,"main"===e&&(this.menu.ext.length=0,this.menu.ext.push(...t.ext||[]))},handleNodeDrop({sourceNodeUid:e,targetNodeUid:t,sourceTree:o}){console.log(e);const n="TreeViewLeft"===o?this.leftTree:this.rightTree,a="TreeViewLeft"===o?this.rightTree:this.leftTree,s=this.findNodeInTree(n,e),r=this.findNodeInTree(a,t);s&&r&&(this.removeNodeFromTree(n,e),r.children||this.$set(r,"children",[]),r.children.push(s),"TreeViewLeft"===o?(this.leftTree=[...this.leftTree],this.rightTree=[...this.rightTree]):(this.rightTree=[...this.rightTree],this.leftTree=[...this.leftTree]))},findNodeInTree(e,t){console.log(e)},removeNodeFromTree(e,t){console.log(e)}},computed:{project(){return this.$app.project},projectMenu(){return this.$app.menu.app.list},topMenu(){return this.$app.menu.top},headMenu(){return this.$app.menu.hierarhy.list},footerMenu(){return this.$app.menu.tools.list},viewTransform(){return this.$app.selection.selected?.isElement||this.$app.selection.selected?.isState},slide(){return this.$app.slides.actived},selected(){return this.$app.selection.element},slides(){return this.$app.slides.children},cameras(){return this.$app.app.cameras},leftpanel(){return this.$app.app.leftpanel},rightpanel(){return this.$app.app.rightpanel},options(){return this.$app.options},menu(){return this.$app.menu},app(){return this.$app.app},tools:()=>toolse,models(){return this.$app.models},ready(){return this.$app.engine.ready},toasts(){return this.$app.toasts},modal(){return this.$app.modal},translations(){return this.$app.translations},options(){return this.$app.project.options||{}},info(){return this.$app.project.info||{}}},components:{UserPanel:Co,ModelsTree:Rt,horizontalmenu:wo,Topmenu:fo,ViewPanel:$,Sliders:R,HierarhyUI:G,InspectorUI:Re,AssetsTree:rt,ElementsTree:bt,StatesTree:Ht,Transformer:ro}},$o=(0,B.A)(Bo,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("horizontalmenu"),i=(0,s.resolveComponent)("icon"),c=(0,s.resolveComponent)("SectionSelect"),d=(0,s.resolveComponent)("InspectorUI"),p=(0,s.resolveComponent)("ViewPanel"),E=(0,s.resolveComponent)("Sliders"),_=(0,s.resolveComponent)("Transformer"),S=(0,s.resolveDirective)("tooltip"),N=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",u,[(0,s.createElementVNode)("div",m,[(0,s.createVNode)(l,{menu:r.projectMenu},null,8,["menu"]),(0,s.createElementVNode)("div",h,(0,s.toDisplayString)(r.info.name),1),(0,s.createElementVNode)("div",f,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"square large",onClick:t[0]||(t[0]=e=>r.project.play())},[(0,s.createVNode)(i,{value:"play3"})])),[[S,"Play project"]]),(0,s.createVNode)(c,{modelValue:r.translations.lang,"onUpdate:modelValue":[t[1]||(t[1]=e=>r.translations.lang=e),r.translations.change],list:r.translations.languages},null,8,["modelValue","list","onUpdate:modelValue"]),(0,s.createCommentVNode)(" <UserPanel /> "),(0,s.createCommentVNode)(' <div class="icon">\r\n                    <icon value="cog"></icon>\r\n                </div> '),(0,s.createTextVNode)(" v "+(0,s.toDisplayString)(a.version),1)])]),(0,s.createCommentVNode)(" <Topmenu></Topmenu> "),(0,s.createVNode)(d,{selected:r.selected,class:"inspector"},null,8,["selected"]),r.app.ready?((0,s.openBlock)(),(0,s.createBlock)(p,{key:0,class:"project",header:a.ui.header,footer:a.ui.footer},{header:(0,s.withCtx)(()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.headMenu,e=>(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:(0,s.normalizeClass)(e.class),onClick:t=>r.onButtonClick(e)},[e.label?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",g,[(0,s.createTextVNode)((0,s.toDisplayString)(e.label||"Close"),1)])),[[N]]):(0,s.createCommentVNode)("v-if",!0),e.icon?((0,s.openBlock)(),(0,s.createBlock)(i,{key:1,value:e.icon,size:"1.5em"},null,8,["value"])):(0,s.createCommentVNode)("v-if",!0)],10,v)),[[S,e.tooltip]])),256))]),footer:(0,s.withCtx)(()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.footerMenu,e=>(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:(0,s.normalizeClass)(e.class),onClick:t=>r.onButtonClick(e)},[e.label?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("span",w,[(0,s.createTextVNode)((0,s.toDisplayString)(e.label||"Close"),1)])),[[N]]):(0,s.createCommentVNode)("v-if",!0),e.icon?((0,s.openBlock)(),(0,s.createBlock)(i,{key:1,value:e.icon,size:"1.5em"},null,8,["value"])):(0,s.createCommentVNode)("v-if",!0)],10,k)),[[S,e.tooltip]])),256))]),default:(0,s.withCtx)(()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.ui.blocks,o=>((0,s.openBlock)(),(0,s.createElementBlock)("div",y,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(o.component||"div"),(0,s.mergeProps)({class:"elementContent"},{ref_for:!0},o.component?o.data:null,{onSelect:o.onSelect,onNodeDrop:r.handleNodeDrop,"onUpdate:tree":t[2]||(t[2]=t=>e.leftTree=t)}),{default:(0,s.withCtx)(()=>[(0,s.createElementVNode)("div",{class:"content-value",innerHTML:o.value||""},null,8,b)]),_:2},1040,["onSelect","onNodeDrop"]))]))),256))]),_:1},8,["header","footer"])):(0,s.createCommentVNode)("v-if",!0),(0,s.createVNode)(E,{slides:r.slides,slide:r.slide,onSlideselect:r.handleSlideSelected,class:"sliders"},null,8,["slides","slide","onSlideselect"]),r.viewTransform?((0,s.openBlock)(),(0,s.createBlock)(_,(0,s.normalizeProps)((0,s.mergeProps)({key:1},r.topMenu)),null,16)):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-61691b74"]]),xo=new Ee.Raycaster;xo.layers.enableAll();const Do=new class{constructor(){this._events={"*":[]}}subs(e,t,o){null==this._events[e]&&(this._events[e]=[]),this._events[e].push({handler:o,once:t})}on(e,t){this.subs(e,!1,t)}once(e,t){this.subs(e,!0,t)}off(e,t){const o=this._events[e];if(o){for(let e=o.length-1;e>=0;e--)o[e].handler===t&&o.splice(e,1);0===o.length&&delete this._events[e]}}clear(e){this._events[e]=[]}clearAll(){this._events={"*":[]}}emit(e,...t){const o=[];this._events[e]&&o.push(...this._events[e]),this._events["*"].length&&o.push(...this._events["*"].map(t=>({handler:t.handler.bind(this,e),once:t.once})));for(let e=o.length-1;e>=0;e--){const n=o[e];n.handler.apply(null,t),n.once&&o.splice(e,1)}}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}};let To,Io,Ao;const Mo={x:0,y:0};let Oo,jo=.03,Po=.03,Lo=.01,Ro=.01,Fo=window.innerWidth/2,Uo=window.innerHeight/2;function zo(e){for(;e;){if(e.isElement||e.isHelper)return e;e=e.parent}return null}function Ho(e){}function qo(e){Mo.x=e.clientX,Mo.y=e.clientY,Oo=Date.now()}function Go(e){if(Math.abs(Mo.x-e.clientX)>10||Math.abs(Mo.y-e.clientY)>10||Date.now()-Oo>500)return;const t=new Ee.Vector2,o=Ao.getBoundingClientRect(),n=e.clientX-o.left,a=e.clientY-o.top;t.x=n/Ao.clientWidth*2-1,t.y=-a/Ao.clientHeight*2+1,xo.setFromCamera(t,Io);const s=xo.intersectObjects(To.children,!0);if(0!==s.length)for(let e=0;e<s.length;e++){const t=s[e].object;if(t.nonClick)continue;const o=zo(t);if(o?.visible)return Do.emit("click",o),void(o.onClick&&o.onClick())}else Do.emit("click",null)}const Wo=new Proxy(class{static get Control(){return Control}static Init(e,t,o,n,a){const s={camera:{range:{x:.01,y:.01},movespeed:{x:.03,y:.03}},...a};To=n,Io=t,Ao=e,jo=s.camera.movespeed.x,Po=s.camera.movespeed.y,Lo=s.camera.range.x,Ro=s.camera.range.y,Fo=window.innerWidth/2,Uo=window.innerHeight/2,e.addEventListener("click",Go.bind(null)),e.addEventListener("mousemove",Ho,!1),e.addEventListener("mousedown",qo,!1)}static Update(e){}static SetCamera(e){Io=e}},{get:(e,t)=>t in e?e[t]:Do[t]}),Ko=Eo.default.default||Eo.default;let Yo,Jo,Xo,Qo,Zo;function en(e){Jo.render(Yo,Xo)}class tn{static get CameraHelper(){return Zo}static async Init(e){Qo=e;const{Project:t,Factory:o}=Ko.modules.getMod("engine");Yo=t.Scene,Jo=new THREE.WebGLRenderer({canvas:e,alpha:!0,powerPreference:"high-performance",antialias:!0,stencil:!1});const n=Qo.clientWidth,a=Qo.clientHeight;Jo.setSize(n,a,!1),Jo.setPixelRatio(window.devicePixelRatio),Jo.shadowMap.enabled=!0,Jo.shadowMap.type=THREE.PCFSoftShadowMap,t.on("setcamera",()=>{Zo&&(Yo.remove(Zo),Zo.dispose()),Zo=new THREE.CameraHelper(t.Camera),Zo.layers.set(1),Yo.add(Zo)}),Zo=new THREE.CameraHelper(t.Camera),Zo.layers.set(1),Yo.add(Zo),Xo=new THREE.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,5e3),Xo.layers.enable(1),Xo.uid="EditorCamera",Yo.add(Xo),Xo.position.set(5,3,20),Jo.setAnimationLoop(en),o.on("create",(e,t)=>{e.type}),ao.Init({canvas:Qo},Xo,t.Scene),ao.FocusTo(t.Root),Wo.Init(Qo,Xo,Yo,t.Root),Wo.on("click",Ko.selection.select)}}window.Editor=tn;const on=tn;let nn="defaultDB",an=null,sn=[],rn="uid";class ln{constructor(e,t,o="id"){this.dbName=e,this._storages=t,this._key=o,this.db=null}async openDatabase(e){return new Promise((t,o)=>{const n=indexedDB.open(this.dbName);n.onupgradeneeded=e=>{const t=e.target.result;for(let e=0;e<this._storages.length;e++)t.objectStoreNames.contains(this._storages[e])||t.createObjectStore(this._storages[e],{keyPath:this._key,autoIncrement:!1})},n.onsuccess=n=>{if(this.db=n.target.result,this.db.objectStoreNames.contains(e))t(this.db);else{this.db.close();const n=this.db.version+1,a=indexedDB.open(this.dbName,n);a.onupgradeneeded=t=>{t.target.result.createObjectStore(e,{keyPath:"id",autoIncrement:!0})},a.onsuccess=e=>{this.db=e.target.result,t(this.db)},a.onerror=e=>{o(e.target.error)}}},n.onerror=e=>{o(e.target.error)}})}async addItem(e,t){const o=(await this.openDatabase(e)).transaction(e,"readwrite");return o.objectStore(e).add(t),new Promise(e=>{o.oncomplete=()=>e(),o.onerror=()=>e()})}async addItems(e,t){const o=[];for(let n=0;n<t.length;n++)o.push(this.addItem(e,t[n]));await Promise.all(o)}async getItem(e,t){const o=(await this.openDatabase(e)).transaction(e,"readonly").objectStore(e);return new Promise((e,n)=>{const a=o.get(t);a.onsuccess=()=>e(a.result),a.onerror=()=>e()})}async deleteItem(e,t){const o=(await this.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,n)=>{const a=o.delete(t);a.onsuccess=()=>e(),a.onerror=()=>n()})}async getAllItems(e){const t=(await this.openDatabase(e)).transaction(e,"readonly").objectStore(e);return new Promise((e,o)=>{const n=t.getAll();n.onsuccess=()=>e(n.result),n.onerror=()=>e()})}async updateItem(e,t){const o=(await this.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,n)=>{const a=o.put(t);a.onsuccess=()=>e(t),a.onerror=()=>n()})}async updateItemProperties(e,t,o){const n=(await this.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,a)=>{const s=n.get(t);s.onsuccess=()=>{const t=s.result;if(t){Object.assign(t,o);const s=n.put(t);s.onsuccess=()=>e(),s.onerror=()=>a()}else a("Item not found")},s.onerror=()=>a()})}async upsertItemProperties(e,t,o){console.log(e);const n=(await this.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,a)=>{const s=n.get(t);s.onsuccess=()=>{let r=s.result;if(r){Object.assign(r,o);const t=n.put(r);t.onsuccess=()=>e(),t.onerror=()=>a()}else{const s={...o,id:t},r=n.add(s);r.onsuccess=()=>e(),r.onerror=()=>a()}},s.onerror=()=>a()})}static async GetList(){try{return await indexedDB.databases()}catch(e){return[]}}static GetStoragesData(e){indexedDB.open(e).onsuccess=function(e){const t=e.target.result,o=t.transaction(t.objectStoreNames,"readonly");t.objectStoreNames.forEach(e=>{const t=o.objectStore(e);console.log("Хранилище:",e),console.log("КлюPath:",t.keyPath),console.log("Автоинкремент:",t.autoIncrement)}),t.close()}}static GetStorages(e){return new Promise((t,o)=>{const n=indexedDB.open(e);n.onsuccess=e=>{const o=e.target.result,n=[];for(let e=0;e<o.objectStoreNames.length;e++)n.push(o.objectStoreNames[e]);o.close(),t(n)},n.onerror=e=>{o(`Ошибка открытия БД: ${e.target.error}`)},n.onupgradeneeded=e=>{console.log("БД требует обновления")}})}static Create(e,t,o=!1){return new Promise((n,a)=>{const s=indexedDB.open(e,1);s.onupgradeneeded=function(e){const n=e.target.result,a=Object.keys(t);for(let e=0;e<a.length;e++){const t=a[e];if(!n.objectStoreNames.contains(t)){const e=n.createObjectStore(t,{keyPath:"uid"});o&&e.createIndex("uid","uid",{unique:!0})}}},s.onsuccess=function(e){const o=e.target.result,s=Object.keys(t),r=o.transaction(s,"readwrite");for(let e=0;e<s.length;e++){const o=s[e],n=r.objectStore(o);if(Array.isArray(t[o]))for(let e=0;e<t[o].length;e++)n.put(t[o][e]);else n.put(t[o])}r.oncomplete=function(){n()},r.onerror=function(){a()}},s.onerror=function(e){a(e.target.error)}})}static async GetFromAll(e,t){try{const e=await indexedDB.databases(),t=[],o=e.map(e=>new Promise((o,n)=>{const a=e.name,s=indexedDB.open(a);s.onsuccess=function(e){const n=e.target.result;if(n.objectStoreNames.contains("project")){const e=n.transaction("project","readonly").objectStore("project").get("info");e.onsuccess=()=>{t.push(e.result),o()},e.onerror=()=>{o()}}else o()},s.onerror=function(){console.error(`Ошибка при открытии базы данных: ${a}`),n()}}));return await Promise.all(o),t}catch(e){console.error("Ошибка при получении списка баз данных:",e)}}static DeleteDatabase(e){return new Promise((t,o)=>{an.close();const n=indexedDB.deleteDatabase(e);n.onsuccess=function(){t()},n.onerror=function(){console.warn(`Ошибка при удалении базы данных ${e}.`),o()},n.onblocked=async function(){console.warn(`Blocked ${e}.`),t()}})}static Init(e,t,o="uid"){nn=e,sn=t,rn=o}static async openDatabase(e){return new Promise((t,o)=>{const n=indexedDB.open(nn);n.onupgradeneeded=e=>{const t=e.target.result;for(let e=0;e<sn.length;e++)t.objectStoreNames.contains(sn[e])||t.createObjectStore(sn[e],{keyPath:rn,autoIncrement:!1})},n.onsuccess=n=>{if(an=n.target.result,an.objectStoreNames.contains(e))t(an);else{an.close();const n=an.version+1,a=indexedDB.open(nn,n);a.onupgradeneeded=t=>{t.target.result.createObjectStore(e,{keyPath:"id",autoIncrement:!0})},a.onsuccess=e=>{an=e.target.result,t(an)},a.onerror=e=>{o(e.target.error)}}},n.onerror=e=>{o(e.target.error)}})}static async addItem(e,t){const o=(await ln.openDatabase(e)).transaction(e,"readwrite");return o.objectStore(e).add(t),new Promise(e=>{o.oncomplete=()=>e(),o.onerror=()=>e()})}static async addItems(e,t){const o=[];for(let n=0;n<t.length;n++)o.push(ln.addItem(e,t[n]));await Promise.all(o)}static async getItem(e,t){const o=(await ln.openDatabase(e)).transaction(e,"readonly").objectStore(e);return new Promise((e,n)=>{const a=o.get(t);a.onsuccess=()=>e(a.result),a.onerror=()=>e()})}static async deleteItem(e,t){const o=(await this.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,n)=>{const a=o.delete(t);a.onsuccess=()=>e(),a.onerror=()=>n()})}static async getAllItems(e){const t=(await ln.openDatabase(e)).transaction(e,"readonly").objectStore(e);return new Promise((e,o)=>{const n=t.getAll();n.onsuccess=()=>e(n.result),n.onerror=()=>o})}static async updateItem(e,t){const o=(await ln.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,n)=>{const a=o.put(t);a.onsuccess=()=>e(t),a.onerror=()=>n()})}static async updateItemProperties(e,t,o){const n=(await ln.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,a)=>{const s=n.get(t);s.onsuccess=()=>{const t=s.result;if(t){Object.assign(t,o);const s=n.put(t);s.onsuccess=()=>e(),s.onerror=()=>a()}else a("Item not found")},s.onerror=()=>a()})}static async upsertMany(e,t,o="id"){const n=[];for(let a=0;a<t.length;a++){const s=t[a];n.push(ln.upsertItemProperties(e,s[o],s))}await Promise.all(n)}static async upsertItemProperties(e,t,o){console.log(e);const n=(await ln.openDatabase(e)).transaction(e,"readwrite").objectStore(e);return new Promise((e,a)=>{const s=n.get(t);s.onsuccess=()=>{let r=s.result;if(r){r={...r,...o};const t=n.put(r);t.onsuccess=()=>e(),t.onerror=()=>a()}else{const s={...o,id:t,uid:t},r=n.add(s);r.onsuccess=()=>e(),r.onerror=()=>a()}},s.onerror=()=>a()})}static getVersion(e){return new Promise(t=>{const o=indexedDB.open(e);o.onsuccess=e=>{const o=e.target.result,n=o.version;o.close(),t(n)},o.onerror=e=>{console.error("Ошибка при открытии БД:",e.target.error),t(null)}})}static exportToJson(e){return new Promise(async(t,o)=>{const n=await ln.getVersion(e),a=indexedDB.open(e,n);a.onerror=e=>{o(`Ошибка открытия базы данных: ${e.target.error}`)},a.onsuccess=e=>{const n=e.target.result,a={},s=n.objectStoreNames,r=n.transaction(s,"readonly"),l=[];for(let e=0;e<s.length;e++){const t=s[e],o=r.objectStore(t);l.push(new Promise(e=>{const n=[],a=o.openCursor();a.onerror=()=>{console.error(`Ошибка чтения хранилища ${t}`),e({[t]:[]})},a.onsuccess=o=>{const a=o.target.result;a?(n.push(a.value),a.continue()):e({[t]:n})}}))}Promise.all(l).then(e=>{e.forEach(e=>{const t=Object.keys(e)[0];a[t]=e[t]}),t(a)}).catch(o),r.oncomplete=()=>{n.close()}},a.onupgradeneeded=e=>{0===e.target.result.objectStoreNames.length&&t({})}})}}const cn=ln,dn=["actions","assets","models","modules","project","slides"],pn={data:()=>({selectedElement:null,loadComponent:"div",modulesLoaded:!1,progress:0}),computed:{ui(){return this.$app.ui},hierarhyAllow(){return this.$app.engine.instances.length>0},options(){return this.$app.options},app(){return this.$app.app},tools:()=>toolse,models(){return this.$app.models},ready(){return this.$app.app.ready},modal(){return this.$app.modal}},methods:{async start(){this.$app.app.ready=!0},waitCanvasSize(e){const t=window.devicePixelRatio||1;e.forEach(e=>{e.width=e.clientWidth*t,e.height=e.clientHeight*t})}},async mounted(){document.documentElement.setAttribute("data-theme","dark"),window.THREE=Ee,await Promise.all([this.$app.app.init(),this.$app.translations.init()]),await this.$app.modules.init();const e=this.$refs.editorcanvas,t=this.$refs.playcanvas;this.waitCanvasSize([e,t]);const o=new URLSearchParams(window.location.search),n=o.get("src");let a;switch(await this.$app.templates.init(),n){case"db":default:this.$app.project.uid=o.get("db")||"empty",await cn.Init(this.$app.project.uid,dn,"uid");const e=[];for(let t=0;t<dn.length;t++){const o=await cn.getAllItems(dn[t]);e.push(o)}const[t=[],n=[],s=[],r=[],l={uid:this.$app.project.uid},i=[]]=e;a={actions:t,assets:n,models:s,modules:r,project:l,slides:i};break;case"url":const c=await fetch(o.get("url"));a=await c.json(),this.$app.project.uid=a.project.uid,await cn.Init(this.$app.project.uid,dn,"uid")}this.$app.project.init(a.project),this.$app.projects.init(this.$app.project.uid),await new Promise(e=>{this.$nextTick(e)}),this.loadComponent="LoaderScreen",console.log("---LOAD ENGINE---"),await this.$app.engine.load(),console.log("---LOAD MODULES---"),await this.$app.modules.loadUserModules(a.modules),console.log("---LOAD ASSETS AND ACTIONS---"),await Promise.all([this.$app.assets.init(a.assets,e=>{this.progress=e}),this.$app.actions.init(a.actions)]),console.log("---LOAD END---"),this.$app.engine.Project.Init(t),this.$app.engine.Project.Start(),console.log("---BUILD SCENES---"),await on.Init(e),await this.$app.engine.start();const s=this.$app.engine.CssManager;await s.Init(this.$refs.playui,t),this.$app.models.on("create",e=>{s.OnCreate(e,this.$app.ui,this.$app.slides)}),this.$app.models.on("remove",(e,t)=>{s.OnRemove(t,this.$app.ui)});try{console.log("---INSTANCED MODELS---"),await this.$app.models.load(a.models)}catch(e){n&&"db"!==n||(console.warn(e),this.$app.toasts.add({message:"Error loading project",type:"alerticon",timehide:!0}))}if(console.log("---BUILD SLIDES---"),0===a.slides.length){const e=await this.$app.slides.add({name:"Main",props:{},actions:[]});a.slides.push(e)}await this.$app.slides.load(a.slides),this.progress=100,a.slides.length>0&&(console.log("---ACTIVATE FIRST SLIDE---"),this.$app.slides.goto(0)),console.log("---READY---"),this.app.ready=!0},components:{UI:$o}},un=(0,B.A)(pn,[["render",function(e,t,o,n,a,u){const m=(0,s.resolveComponent)("UI"),h=(0,s.resolveComponent)("Modal"),f=(0,s.resolveComponent)("Toasts");return(0,s.openBlock)(),(0,s.createElementBlock)("div",r,[(0,s.createElementVNode)("div",l,[(0,s.createElementVNode)("canvas",i,null,512),(0,s.createElementVNode)("canvas",c,null,512),(0,s.createElementVNode)("div",d,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(u.ui.elements,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.component),(0,s.mergeProps)({onMounted:u.ui.onElementMount,key:t},(0,s.toHandlers)(e.events||{}),{ref_for:!0},e.data),null,16,["onMounted"]))),128))],512),(0,s.createVNode)(m,{element:a.selectedElement},null,8,["element"])]),u.ready?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",p,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(a.loadComponent),{loadingProgress:a.progress,onClick:u.start},null,8,["loadingProgress","onClick"]))])),u.modal.isVisible?((0,s.openBlock)(),(0,s.createBlock)(h,{key:1})):(0,s.createCommentVNode)("v-if",!0),(0,s.createVNode)(f)])}]]),mn={class:"overbutton"},hn={class:"menulabel"},fn={class:"btnicon"},vn={name:"ExpandedButton",props:{label:"",icon:"",color:"rgb(0,0,0)"}},gn=(0,B.A)(vn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon");return(0,s.openBlock)(),(0,s.createElementBlock)("button",mn,[(0,s.createElementVNode)("div",hn,(0,s.toDisplayString)(o.label),1),(0,s.createElementVNode)("div",fn,[(0,s.createVNode)(l,{size:"100%",color:o.color,value:o.icon},null,8,["color","value"])])])}]]),yn=["fill","x","href"],bn=o.p+"assets/e5cea83d172a1097401a.svg",kn={name:"Icon",props:{value:{type:String,default:()=>"icon-checkmark"},size:{type:String,default:()=>null},color:{type:String,default:()=>null},offset:{type:Number}},computed:{style(){return this.size?{width:`${this.size}`,height:`${this.size}`}:{width:"1em",height:"1em"}},val(){return`${bn}#s-${this.value.replace("p-","")}`}}},wn=(0,B.A)(kn,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("svg",{preserveAspectRatio:"xMidYMid meet",class:"svgicon",style:(0,s.normalizeStyle)(r.style)},[(0,s.createElementVNode)("use",{class:"svguse",width:"100%",height:"100%",viewBox:"0 0 32 32",fill:o.color,x:o.offset,href:r.val},[(0,s.createElementVNode)("title",null,[(0,s.renderSlot)(e.$slots,"default",{},void 0,!0)])],8,yn)],4)}],["__scopeId","data-v-a13b2ade"]]),En={class:"modal-header"},_n={class:"modal-content"},Sn=["innerHTML"],Nn={class:"modal-footer"},Vn=["disabled","onClick"],Cn={computed:{modal(){return this.$app.modal},header(){return this.modal.header},content(){return this.modal.content},footer(){return this.modal.footer}},methods:{onSelf(){this.modal.values.closable&&this.modal.close()},onClick(e){"function"==typeof e&&e()},closeModal(e){"function"!=typeof e?this.modal.close():e()}}},Bn=(0,B.A)(Cn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"modal-overlay",onClick:t[3]||(t[3]=(0,s.withModifiers)((...e)=>r.onSelf&&r.onSelf(...e),["self"]))},[(0,s.createElementVNode)("div",{class:"modal",onClick:t[2]||(t[2]=(0,s.withModifiers)(()=>{},["stop"]))},[(0,s.createElementVNode)("header",En,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(r.header.component||"div"),(0,s.mergeProps)({class:"header"},r.header.component?r.header:null),{default:(0,s.withCtx)(()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("h3",null,[(0,s.createTextVNode)((0,s.toDisplayString)(r.header.value),1)])),[[l,`$$title.${r.header.value}`]]),(0,s.createElementVNode)("button",{class:"close-btn",onClick:t[0]||(t[0]=e=>r.closeModal(r.header.handler))},"×")]),_:1},16))]),(0,s.createElementVNode)("main",_n,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(r.content.component||"div"),(0,s.mergeProps)({class:"content"},r.content.component?r.content.props:null,(0,s.toHandlers)(r.content.events||{})),(0,s.createSlots)({default:(0,s.withCtx)(()=>[(0,s.createElementVNode)("div",{class:"content-value",innerHTML:r.content.value||""},null,8,Sn)]),_:2},[(0,s.renderList)(r.content.slots,(e,t)=>({name:t,fn:(0,s.withCtx)(t=>[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.component),(0,s.mergeProps)(t,(0,s.toHandlers)(e.events||{})),null,16))])}))]),1040))]),(0,s.createElementVNode)("footer",Nn,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(r.footer.component||"div"),(0,s.mergeProps)({class:"footer"},r.footer.component?r.footer.props:null,{onClose:r.closeModal}),{default:(0,s.withCtx)(()=>[r.footer.buttons?((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,{key:0},(0,s.renderList)(r.footer.buttons,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",null,[e.hidden?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{key:0,class:(0,s.normalizeClass)(e.class),disabled:e.disabled,onClick:t=>r.onClick(e.handler)},[(0,s.createTextVNode)((0,s.toDisplayString)(e.label||"Close"),1)],10,Vn)),[[l,`$$buttons.${e.label}`]])]))),256)):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{key:1,class:(0,s.normalizeClass)(r.footer.class),onClick:t[1]||(t[1]=e=>r.closeModal(r.footer.handler))},[(0,s.createTextVNode)((0,s.toDisplayString)(r.footer.label||"Close"),1)],2)),[[l,`$$buttons.${r.footer.label}`]])]),_:1},16,["onClose"]))])])])}],["__scopeId","data-v-7fed23f5"]]),$n=["onClick"],xn={props:{values:{type:Array},rect:{type:Object},size:{type:Object,default:{width:200,height:100}}},data:()=>({popupStyle:{}}),methods:{togglePopup(e){const t=window.innerWidth;let o=this.rect.top+window.scrollY,n=this.rect.left+window.scrollX;n+this.size.width>t&&(n=this.rect.right-this.size.width+window.scrollX),this.popupStyle={position:"absolute",top:`${o}px`,left:`${n}px`,width:`${this.size.width}px`},this.isPopupVisible=!0},hidePopup(){this.$emit("callback")}}},Dn=(0,B.A)(xn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"popup",style:(0,s.normalizeStyle)(a.popupStyle)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.values,(t,o)=>(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("p",{class:"element",key:o,onClick:o=>t.handler?t.handler(t):e.$emit("click",t)},[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(t.component||"div"),(0,s.mergeProps)({ref_for:!0},t.props),{default:(0,s.withCtx)(()=>[(0,s.createTextVNode)((0,s.toDisplayString)(t.props),1)]),_:2},1040))],8,$n)),[[l,t.tooltip]])),128)),(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=(...e)=>r.hidePopup&&r.hidePopup(...e))},"ОК")],4)}],["__scopeId","data-v-1591e2fe"]]),Tn={key:0,class:"menulabel"},In={key:1,class:"btnicon"},An={name:"SimpleButton",props:{label:{type:String},icon:{type:Object},tooltip:{type:String},handlers:{type:Object,required:!0}},methods:{onClick(){this.handlers?.click?this.handlers.click(this):this.$emit("click",this)}}},Mn=(0,B.A)(An,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"small-btn simple",onClick:t[0]||(t[0]=(...e)=>r.onClick&&r.onClick(...e))},[o.label?((0,s.openBlock)(),(0,s.createElementBlock)("div",Tn,(0,s.toDisplayString)(o.label),1)):(0,s.createCommentVNode)("v-if",!0),o.icon?((0,s.openBlock)(),(0,s.createElementBlock)("div",In,[(0,s.createVNode)(l,{size:o.icon.size||"100%",value:o.icon.value},null,8,["size","value"])])):(0,s.createCommentVNode)("v-if",!0)])),[[i,o.tooltip]])}],["__scopeId","data-v-7f0518be"]]),On={key:0,class:"menulabel"},jn={key:1,class:"btnicon"},Pn={name:"ToggleButton",props:{id:{type:String,required:!0},label:{type:String},icon:{type:Object},group:{type:Object},handlers:{type:Object,required:!0},tooltip:{type:String}},computed:{isActive(){return this.group.activeId===this.id}},mounted(){this.handlers.activate&&this.handlers.activate(this)},beforeUnmount(){this.handlers.deactivate&&this.handlers.deactivate(this)},methods:{onClick(){this.handlers.click?this.handlers.click(this):this.$emit("click",this)}}},Ln=(0,B.A)(Pn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("translate"),c=(0,s.resolveDirective)("tooltip");return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:(0,s.normalizeClass)(["small-btn simple",{active:r.isActive}]),onClick:t[0]||(t[0]=(...e)=>r.onClick&&r.onClick(...e))},[o.label?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",On,[(0,s.createTextVNode)((0,s.toDisplayString)(o.label),1)])),[[i,`$$buttons.${o.label}`]]):(0,s.createCommentVNode)("v-if",!0),o.icon?((0,s.openBlock)(),(0,s.createElementBlock)("div",jn,[(0,s.createVNode)(l,{size:o.icon.size||"100%",value:o.icon.value},null,8,["size","value"])])):(0,s.createCommentVNode)("v-if",!0)],2)),[[c,o.tooltip]])}],["__scopeId","data-v-5b95ca11"]]),Rn={class:"spinner"},Fn={name:"Spinner"},Un=(0,B.A)(Fn,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Rn)}],["__scopeId","data-v-4736cf19"]]),zn={class:"toast-container"},Hn={computed:{list(){return this.$app.toasts.list}},methods:{onClick(e){e.onclick&&e.onclick()}}},qn=(0,B.A)(Hn,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",zn,[(0,s.createVNode)(s.TransitionGroup,{name:"toast",tag:"div"},{default:(0,s.withCtx)(()=>[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.list,t=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:t.id,class:"toast"},[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(t.component||"div"),(0,s.mergeProps)({class:"toastview"},{ref_for:!0},t.data,{onClick:e=>r.onClick(t)}),{default:(0,s.withCtx)(()=>[t.component?(0,s.createCommentVNode)("v-if",!0):(0,s.renderSlot)(e.$slots,"default",{key:0},()=>[(0,s.createTextVNode)((0,s.toDisplayString)(t.data.message),1)],!0)]),_:2},1040,["onClick"]))]))),128))]),_:3})])}],["__scopeId","data-v-49ca426e"]]),Gn={class:"alert"},Wn={class:"text"},Kn={name:"Label",props:{icon:{type:String,default:"notification"},message:{type:String,default:""},type:{type:String,default:"info"}}},Yn=(0,B.A)(Kn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.createElementVNode)("div",Gn,[(0,s.createVNode)(l,{class:(0,s.normalizeClass)(`${o.type}icon`),size:"3em",value:o.icon},null,8,["class","value"]),(0,s.createElementVNode)("span",Wn,(0,s.toDisplayString)(o.message),1)])])}]]),Jn={class:"menu-container"},Xn={key:0,class:"menublock"},Qn={name:"ExtMenu",props:{list:{type:Array,default:[]},actived:{type:String}},computed:{menu(){return this.$app.menu}},methods:{onClick(e){const t=this.list.find(e=>e.id===this.actived);t&&(t.handlers?.disable?.(),t===e)?this.$emit("activate",null):(e.handler?.(e)||e.handlers?.enable?.(e)||this.$emit("click",e),this.$emit("activate",e))}}},Zn=(0,B.A)(Qn,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("ExpandedButton");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Jn,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:t,class:(0,s.normalizeClass)([e.class,"menu-item"])},[e.hidden?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",Xn,[(0,s.createVNode)(l,{onClick:(0,s.withModifiers)(t=>r.onClick(e),["stop"]),label:e.label,color:e.id&&o.actived===e.id?"#ffff00":null,icon:e.icon},null,8,["onClick","label","color","icon"])]))],2))),128))])}]]),ea=Zn,ta={class:"input-wrapper"},oa=["type","value","placeholder"],na={name:"MinimalInput",props:{type:{type:String,default:"text"},value:{type:[String,Number],default:""},placeholder:{type:String,default:""}},emits:["update:value"]},aa=(0,B.A)(na,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",ta,[(0,s.createElementVNode)("input",{type:o.type,value:o.value,onInput:t[0]||(t[0]=t=>e.$emit("update:value",t.target.value)),placeholder:o.placeholder,class:"input-field"},null,40,oa)])}],["__scopeId","data-v-f47b63dc"]]),sa=["value"],ra={name:"Elements",props:{modelValue:{type:String}},data:()=>({element:null,list:[]}),mounted(){this.list=this.$app.engine.getFactory().Elements},computed:{val:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},la=(0,B.A)(ra,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.val=e),class:"form-select"},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.list,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{value:e.path},(0,s.toDisplayString)(e.name),9,sa))),256))],512),[[s.vModelSelect,r.val]])])}]]),ia={class:"radio-group"},ca=["onClick"],da={name:"RadioButton",props:{buttons:{type:Array,required:!0},value:{type:Object}}},pa=(0,B.A)(da,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",ia,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.buttons,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("button",{key:t,class:"btn",onClick:t=>e.handler(o.value)},(0,s.toDisplayString)(e.label),9,ca))),128))])}],["__scopeId","data-v-48e97626"]]),ua=pa,ma={class:"radio-group"},ha={class:"radio-label"},fa=["name","value","checked","disabled","onChange"],va={class:"radio-custom"},ga={class:"radio-text"},ya={class:"radio-default-label"},ba={name:"RadioButton",props:{options:{type:[Array,Number],required:!0,validator:e=>Array.isArray(e)||"number"==typeof e&&e>0},modelValue:{type:[String,Number,Boolean,Object],default:null},name:{type:String,default:"radio-group"},disabled:{type:Boolean,default:!1},valueKey:{type:String,default:"value"},labelKey:{type:String,default:"label"}},emits:["update:modelValue","change"],computed:{normalizedOptions(){return"number"==typeof this.options?Array.from({length:this.options},(e,t)=>t+1):this.options}},methods:{getOptionValue(e){return"object"==typeof e&&null!==e&&(e[this.valueKey]||e.value)||e},getOptionLabel(e){return"object"==typeof e&&null!==e?e[this.labelKey]||e.label||this.getOptionValue(e):e},isChecked(e){return this.getOptionValue(e)===this.modelValue},handleChange(e){const t=this.getOptionValue(e);this.$emit("update:modelValue",t),this.$emit("change",t)}}},ka=(0,B.A)(ba,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",ma,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.options,(t,n)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:n,class:(0,s.normalizeClass)(["radio-item",{"radio-item--disabled":o.disabled}])},[(0,s.createElementVNode)("label",ha,[(0,s.createElementVNode)("input",{type:"radio",name:o.name,value:r.getOptionValue(t),checked:r.isChecked(t),disabled:o.disabled,onChange:e=>r.handleChange(t),class:"radio-input"},null,40,fa),(0,s.createCommentVNode)(" Кастомная кнопка через слот "),(0,s.createElementVNode)("span",va,[(0,s.renderSlot)(e.$slots,"button",{option:t,index:n,checked:r.isChecked(t)},()=>[(0,s.createElementVNode)("span",{class:(0,s.normalizeClass)(["radio-default-button",{"radio-default-button--checked":r.isChecked(t)}])},null,2)],!0)]),(0,s.createCommentVNode)(" Кастомная надпись через слот "),(0,s.createElementVNode)("span",ga,[(0,s.renderSlot)(e.$slots,"label",{option:t,index:n,checked:r.isChecked(t)},()=>[(0,s.createElementVNode)("span",ya,(0,s.toDisplayString)(r.getOptionLabel(t)),1)],!0)])])],2))),128))])}],["__scopeId","data-v-65d75466"]]),wa={class:"search-filter"},Ea={class:"search-input-container"},_a=["placeholder"],Sa=["disabled"],Na={name:"SearchFilter",props:{value:{type:String,default:""},placeholder:{type:String,default:"Enter text to search..."},debounce:{type:Number,default:300},label:{type:String,default:""},button:{type:String,default:"Search"}},data(){return{searchValue:this.value,debounceTimer:null}},watch:{value(e){this.searchValue=e}},methods:{handleInput(){console.log("handleInput"),this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.$emit("change",this.searchValue)},this.debounce)},handleSearch(){console.log("handleSearch"),this.searchValue.trim()&&(this.debounceTimer&&(clearTimeout(this.debounceTimer),this.debounceTimer=null),this.$emit("search",this.searchValue))},beforeUnmount(){this.debounceTimer&&clearTimeout(this.debounceTimer)}}},Va=(0,B.A)(Na,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",wa,[(0,s.createElementVNode)("div",Ea,[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(o.label),1),(0,s.withDirectives)((0,s.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.searchValue=e),type:"text",class:"search-input",placeholder:o.placeholder,onInput:t[1]||(t[1]=(0,s.withModifiers)((...e)=>r.handleInput&&r.handleInput(...e),["stop"])),onKeyup:t[2]||(t[2]=(0,s.withKeys)((...e)=>r.handleSearch&&r.handleSearch(...e),["enter"]))},null,40,_a),[[s.vModelText,a.searchValue],[l]]),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"search-button",onClick:t[3]||(t[3]=(...e)=>r.handleSearch&&r.handleSearch(...e)),disabled:!a.searchValue.trim()},[(0,s.renderSlot)(e.$slots,"button-content",{},()=>[(0,s.createElementVNode)("span",null,(0,s.toDisplayString)(o.button),1)],!0)],8,Sa)),[[l,`$$buttons.${o.button}`]])])])}],["__scopeId","data-v-37559087"]]),Ca={name:"SliderBlock",props:{value:{type:Boolean,default:()=>!1},property:{type:String,default:"top"},shift:{type:Number,default:100},zero:{type:Number,default:0}},computed:{style(){return{[this.property]:this.value?`${this.shift}px`:`${this.zero}px`}}},mounted(){"right"===this.property||"left"===this.property?this.$el.style.width=this.shift-this.zero+"px":this.$el.style.height=this.shift-this.zero+"px"}},Ba=(0,B.A)(Ca,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"slider",style:(0,s.normalizeStyle)(r.style)},[(0,s.renderSlot)(e.$slots,"default",{},void 0,!0),(0,s.createElementVNode)("div",{onClick:t[0]||(t[0]=t=>e.$emit("revert"))},[(0,s.renderSlot)(e.$slots,"button",{},void 0,!0)])],4)}],["__scopeId","data-v-b3fc2cec"]]),$a={key:0},xa={key:1},Da={key:2,class:"child-list"},Ta={key:0},Ia={name:"TreeLi",props:["value"],data:()=>({childshow:!1})},Aa=(0,B.A)(Ia,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("TreeLi",!0);return(0,s.openBlock)(),(0,s.createElementBlock)("li",null,[o.value.children?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",$a,[...t[1]||(t[1]=[(0,s.createElementVNode)("svg",{class:"edicon ics-spinner10"},[(0,s.createElementVNode)("use",{"xlink:href":"#ics-spinner10"})],-1)])])),o.value.children?((0,s.openBlock)(),(0,s.createElementBlock)("div",Da,[(0,s.createElementVNode)("span",{onClick:t[0]||(t[0]=t=>e.childshow=!e.childshow)},[t[3]||(t[3]=(0,s.createElementVNode)("input",{type:"checkbox"},null,-1)),(0,s.createTextVNode)((0,s.toDisplayString)(o.value.name),1)]),e.childshow?((0,s.openBlock)(),(0,s.createElementBlock)("ul",Ta,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.value.children,(e,t)=>((0,s.openBlock)(),(0,s.createBlock)(l,{key:t,value:e},null,8,["value"]))),128))])):(0,s.createCommentVNode)("v-if",!0)])):((0,s.openBlock)(),(0,s.createElementBlock)("span",xa,[t[2]||(t[2]=(0,s.createElementVNode)("input",{type:"checkbox"},null,-1)),(0,s.createTextVNode)((0,s.toDisplayString)(o.value.name),1)]))])}],["__scopeId","data-v-562df7a6"]]),Ma={class:"selectable-container"},Oa={class:"list"},ja={class:"grid"},Pa=["onClick"],La={key:0,class:"info"},Ra={name:"ActionsLib",data:()=>({current:null}),props:{list:{type:Array},selected:{type:Object}},watch:{selected(e,t){this.current=e}},emits:["selectItem"],methods:{onItemSelect(e){this.$emit("selectItem",e)}}},Fa=(0,B.A)(Ra,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Ma,[(0,s.createElementVNode)("div",Oa,[(0,s.createElementVNode)("div",ja,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{onClick:e=>r.onItemSelect(t),class:"grid-element",key:o},[(0,s.renderSlot)(e.$slots,"item",{item:t})],8,Pa))),128))])]),a.current?((0,s.openBlock)(),(0,s.createElementBlock)("div",La,[(0,s.renderSlot)(e.$slots,"selected",{item:a.current})])):(0,s.createCommentVNode)("v-if",!0)])}]]),Ua={class:"vlist-container"},za={class:"list"},Ha={class:"vlist"},qa=["onClick"],Ga={name:"ActionsLib",data:()=>({current:null}),props:{list:{type:Array},selected:{type:Object}},watch:{selected(e,t){this.current=e}},emits:["selectItem"],methods:{onItemSelect(e){this.$emit("selectItem",e)}}},Wa=(0,B.A)(Ga,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Ua,[(0,s.createElementVNode)("div",za,[(0,s.createElementVNode)("div",Ha,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{onClick:e=>r.onItemSelect(t),class:"vlist-element",key:o},[(0,s.renderSlot)(e.$slots,"item",{item:t})],8,qa))),128))])])])}]]),Ka={style:{"text-align":"right"}},Ya={name:"BoolEdit",props:{modelValue:{type:Boolean}},computed:{val:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},Ja=(0,B.A)(Ya,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Ka,[(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=e=>r.val=e)},null,512),[[s.vModelCheckbox,r.val]])])}]]),Xa={class:"comma-number-input-wrapper"},Qa={class:"arrow-buttons"},Za={name:"input-float",props:{value:Object,modelValue:Number,step:{type:Number,default:1},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER}},data:()=>({interval:null,separator:",",isPressed:!1,changeSpeed:100}),computed:{formattedValue:{get(){return this.modelValue},set(e){console.log(e),this.parseNumber(e),this.$emit("update:modelValue",e)}}},mounted(){const e=(new Intl.NumberFormat).format(this.modelValue);this.separator=e.charAt(1),this.$refs.input.addEventListener("wheel",this.onWheel,{passive:!1})},beforeDestroy(){this.$refs.input.removeEventListener("wheel",this.onWheel)},methods:{onFocus(){this.$nextTick(()=>{this.$refs.input.select()})},parseNumber(e){try{const t=parseFloat(e.replace(",","."));return isNaN(t)?this.modelValue:t}catch(e){return this.modelValue}},formatNumber:e=>parseFloat(e).toFixed(0).replace(".",","),onInput(e){this.formattedValue=e.target.modelValue},onWheel(e){e.preventDefault(),e.stopPropagation(),document.activeElement===this.$refs.input&&this.changeValue(e.deltaY>0?-this.step:this.step)},onKeyDown(e){"ArrowUp"===e.key?(this.changeValue(this.step),e.preventDefault()):"ArrowDown"===e.key&&(this.changeValue(-this.step),e.preventDefault())},changeValue(e){let t=(this.modelValue||0)+e;t=Math.max(Math.min(t,this.max),this.min),this.$emit("update:modelValue",parseFloat(t.toFixed(0)))},startIncrement(){this.interval&&clearInterval(this.interval),this.isPressed=!0,this.changeValue(this.step),setTimeout(()=>{this.isPressed&&(this.interval=setInterval(()=>this.changeValue(this.step),50))},400)},startDecrement(){this.interval&&clearInterval(this.interval),this.isPressed=!0,this.changeValue(-this.step),setTimeout(()=>{this.isPressed&&(this.interval=setInterval(()=>this.changeValue(-this.step),50))},400)},stopChange(){this.isPressed=!1,clearInterval(this.interval)}}},es=(0,B.A)(Za,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Xa,[(0,s.withDirectives)((0,s.createElementVNode)("input",{ref:"input","onUpdate:modelValue":t[0]||(t[0]=e=>r.formattedValue=e),onKeydown:t[1]||(t[1]=(...e)=>r.onKeyDown&&r.onKeyDown(...e)),onDblclick:t[2]||(t[2]=(...e)=>r.onFocus&&r.onFocus(...e)),class:"comma-number-input"},null,544),[[s.vModelText,r.formattedValue,void 0,{number:!0}]]),(0,s.createElementVNode)("div",Qa,[(0,s.createElementVNode)("button",{onMousedown:t[3]||(t[3]=(...e)=>r.startIncrement&&r.startIncrement(...e)),onMouseup:t[4]||(t[4]=(...e)=>r.stopChange&&r.stopChange(...e)),onMouseleave:t[5]||(t[5]=(...e)=>r.stopChange&&r.stopChange(...e))},"▲",32),(0,s.createElementVNode)("button",{onMousedown:t[6]||(t[6]=(...e)=>r.startDecrement&&r.startDecrement(...e)),onMouseup:t[7]||(t[7]=(...e)=>r.stopChange&&r.stopChange(...e)),onMouseleave:t[8]||(t[8]=(...e)=>r.stopChange&&r.stopChange(...e))},"▼",32)])])}]]),ts=["onUpdate:modelValue"],os=["onUpdate:modelValue"],ns={name:"NameEditor",data:()=>({properties:[{property:"envMap",value:null}]}),methods:{updateAsset(){for(let e=0;e<this.properties.length;e++){const t=this.properties[e];this.selected[t.property],this.$app.assets.updateAsset(this.selected,t.property,()=>{})}}},props:{selected:{type:Object}}},as=(0,B.A)(ns,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.properties,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.withDirectives)((0,s.createElementVNode)("input",{"onUpdate:modelValue":t=>e.property=t},null,8,ts),[[s.vModelText,e.property]]),(0,s.withDirectives)((0,s.createElementVNode)("input",{"onUpdate:modelValue":t=>o.selected[e.property]=t},null,8,os),[[s.vModelText,o.selected[e.property]]])]))),256)),(0,s.createElementVNode)("div",null,[(0,s.createElementVNode)("button",{class:"btn",onClick:t[0]||(t[0]=(...e)=>r.updateAsset&&r.updateAsset(...e))},"Update")])])}]]),ss=as,rs={class:"comma-number-input-wrapper"},ls={class:"arrow-buttons"},is={name:"CommaNumberInput",props:{modelValue:Number,step:{type:Number,default:.1},min:{type:Number,default:Number.MIN_SAFE_INTEGER},max:{type:Number,default:Number.MAX_SAFE_INTEGER},decimals:{type:Number,default:2}},data:()=>({interval:null,separator:",",isPressed:!1,changeSpeed:100}),computed:{formattedValue:{get(){return this.modelValue},set(e){const t=this.parseNumber(e);this.$emit("update:modelValue",t)}}},mounted(){const e=(new Intl.NumberFormat).format(this.modelValue);this.separator=e.charAt(1),this.$refs.input.addEventListener("wheel",this.onWheel,{passive:!1})},beforeDestroy(){this.$refs.input.removeEventListener("wheel",this.onWheel)},methods:{onFocus(){this.$nextTick(()=>{this.$refs.input.select()})},parseNumber(e){try{const t=parseFloat(e.replace(",","."));return isNaN(t)?this.modelValue:t}catch(e){return this.modelValue}},formatNumber(e){return parseFloat(e).toFixed(this.decimals).replace(".",",")},onInput(e){this.formattedValue=e.target.modelValue},onWheel(e){e.preventDefault(),e.stopPropagation(),document.activeElement===this.$refs.input&&this.changeValue(e.deltaY>0?-this.step:this.step)},onKeyDown(e){"ArrowUp"===e.key?(this.changeValue(this.step),e.preventDefault()):"ArrowDown"===e.key&&(this.changeValue(-this.step),e.preventDefault())},changeValue(e){let t=(this.modelValue||0)+e;t=Math.max(Math.min(t,this.max),this.min),this.$emit("update:modelValue",parseFloat(t.toFixed(this.decimals)))},startIncrement(){this.interval&&clearInterval(this.interval),this.isPressed=!0,this.changeValue(this.step),setTimeout(()=>{this.isPressed&&(this.interval=setInterval(()=>this.changeValue(this.step),50))},400)},startDecrement(){this.interval&&clearInterval(this.interval),this.isPressed=!0,this.changeValue(-this.step),setTimeout(()=>{this.isPressed&&(this.interval=setInterval(()=>this.changeValue(-this.step),50))},400)},stopChange(){this.isPressed=!1,clearInterval(this.interval)}}},cs=(0,B.A)(is,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",rs,[(0,s.withDirectives)((0,s.createElementVNode)("input",{ref:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.formattedValue=e),onKeydown:t[1]||(t[1]=(...e)=>r.onKeyDown&&r.onKeyDown(...e)),onDblclick:t[2]||(t[2]=(...e)=>r.onFocus&&r.onFocus(...e)),class:"comma-number-input"},null,544),[[s.vModelText,r.formattedValue]]),(0,s.createElementVNode)("div",ls,[(0,s.createElementVNode)("button",{onMousedown:t[3]||(t[3]=(...e)=>r.startIncrement&&r.startIncrement(...e)),onMouseup:t[4]||(t[4]=(...e)=>r.stopChange&&r.stopChange(...e)),onMouseleave:t[5]||(t[5]=(...e)=>r.stopChange&&r.stopChange(...e))},"▲",32),(0,s.createElementVNode)("button",{onMousedown:t[6]||(t[6]=(...e)=>r.startDecrement&&r.startDecrement(...e)),onMouseup:t[7]||(t[7]=(...e)=>r.stopChange&&r.stopChange(...e)),onMouseleave:t[8]||(t[8]=(...e)=>r.stopChange&&r.stopChange(...e))},"▼",32)])])}]]),ds={class:"control-container"},ps=["max"],us={class:"buttons"},ms=["disabled"],hs=["disabled"],fs={__name:"playcontrol",props:{modelValue:{type:Object},selected:{type:Object},value:{type:Object},target:{type:Object},property:{type:Object}},setup(e){const t=e,o=(0,s.ref)(!1),n=(0,s.ref)(0),a=(0,s.ref)(0),r=(0,s.ref)(0),l=(0,s.ref)(!1),i=(0,s.ref)(!1);function c(){const e=t.modelValue;i.value?e.pause():e.play()}function d(){t.modelValue.pause(),t.modelValue.currentTime=0}function p(){l.value=!1;const e=t.modelValue;if(o.value&&r.value<=e.duration)if(e.readyState<2){const t=()=>{e.currentTime=r.value,e.removeEventListener("canplay",t)};e.addEventListener("canplay",t),e.load()}else e.currentTime=r.value}function u(e){return!e||isNaN(e)?"0:00":`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`}return(0,s.onMounted)(()=>{const e=t.modelValue,c=()=>{e.readyState>=1&&(n.value=e.duration,o.value=!0)},d=()=>{l.value||(a.value=e.currentTime,r.value=e.currentTime)},p=()=>i.value=!0,u=()=>i.value=!1,m=()=>i.value=!1;e.addEventListener("loadedmetadata",c),e.addEventListener("canplay",c),e.addEventListener("timeupdate",d),e.addEventListener("play",p),e.addEventListener("playing",p),e.addEventListener("pause",u),e.addEventListener("ended",m),c(),(0,s.onUnmounted)(()=>{e.removeEventListener("loadedmetadata",c),e.removeEventListener("canplay",c),e.removeEventListener("timeupdate",d),e.removeEventListener("play",p),e.removeEventListener("playing",p),e.removeEventListener("pause",u),e.removeEventListener("ended",m)})}),(e,t)=>{const m=(0,s.resolveComponent)("icon");return(0,s.openBlock)(),(0,s.createElementBlock)("div",ds,[(0,s.createElementVNode)("span",null,(0,s.toDisplayString)(u(a.value))+" / "+(0,s.toDisplayString)(u(n.value)),1),(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"range",min:"0",max:n.value,step:"0.01","onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),onMousedown:t[1]||(t[1]=e=>l.value=!0),onMouseup:p,onTouchstart:t[2]||(t[2]=e=>l.value=!0),onTouchend:p},null,40,ps),[[s.vModelText,r.value,void 0,{number:!0}]]),(0,s.createElementVNode)("div",us,[(0,s.createElementVNode)("button",{class:"btn square",onClick:c,disabled:!o.value},[(0,s.createVNode)(m,{value:i.value?"pause2":"play3"},null,8,["value"])],8,ms),(0,s.createCommentVNode)(' <button class="btn square" @click="pause" :disabled="!ready">\r\n                <icon value="pause2"></icon>\r\n            </button> '),(0,s.createElementVNode)("button",{class:"btn square",onClick:d,disabled:!o.value},[(0,s.createVNode)(m,{value:"stop2"})],8,hs)])])}}},vs=(0,B.A)(fs,[["__scopeId","data-v-ae734b3c"]]),gs={style:{display:"grid","grid-template-columns":"96px 1fr"}},ys={style:{"text-align":"center"}},bs={props:{selected:{type:Object},label:{type:String},value:{type:Number},property:{type:Object}},computed:{val:{get(){return this.value},set(e){this.$emit("update:value",e)}}}},ks=(0,B.A)(bs,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("FloatInput");return(0,s.openBlock)(),(0,s.createElementBlock)("div",gs,[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(o.label),1),(0,s.createElementVNode)("div",ys,[(0,s.createVNode)(l,{min:o.property.min||0,step:o.property.step||.01,value:r.val,onChanged:t[0]||(t[0]=e=>r.val=e)},null,8,["min","step","value"])])])}]]),ws={class:"v3","'":""},Es={class:"v3value"},_s={class:"v3label"},Ss={props:{modelValue:{type:Object,default:new Ee.Vector3},decimals:{type:Number,default:4},step:{type:Number,default:1}},computed:{value:{get(){return this.modelValue}}},methods:{updateValue(e,t){console.log(t)}}},Ns=(0,B.A)(Ss,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("float");return(0,s.openBlock)(),(0,s.createElementBlock)("div",ws,[((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(["x","y","z"],e=>(0,s.createElementVNode)("div",Es,[(0,s.createElementVNode)("label",_s,(0,s.toDisplayString)(e),1),(0,s.createVNode)(l,{modelValue:r.value[e],"onUpdate:modelValue":[t=>r.value[e]=t,t=>r.updateValue(e,t)],decimals:o.decimals,step:o.step},null,8,["modelValue","onUpdate:modelValue","decimals","step"])])),64))])}]]),Vs={style:{display:"flex","align-items":"center",gap:"1px","flex-direction":"column"}},Cs={key:0,class:"tools"},Bs={key:1,class:"titleinfo"},$s={key:0,class:"vector3"},xs={class:"vector3value"},Ds={class:"vector3label"},Ts={data:()=>({expanded:!0,vprops:["x","y","z"]}),props:{label:String,modelValue:{type:Object,default:new Ee.Vector3},decimals:{type:Number,default:2},step:{type:Number,default:1}},computed:{value:{get(){return this.modelValue}}},watch:{values(e,t){}},methods:{updateValue(e,t){"number"==typeof t&&this.$emit("update:modelValue",{...this.value,[e]:t})},onUpdate(e){const t=new CustomEvent("update:modelValue",{detail:e,bubbles:!1});this.$emit("update:modelValue",t.detail)}}},Is=(0,B.A)(Ts,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("float");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Vs,[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["title",a.expanded?"":"min"])},[(0,s.createElementVNode)("div",{class:"label",onClick:t[0]||(t[0]=e=>a.expanded=!a.expanded)},(0,s.toDisplayString)(a.expanded?"▼":"▶")+" "+(0,s.toDisplayString)(o.label),1),a.expanded?((0,s.openBlock)(),(0,s.createElementBlock)("div",Cs,[(0,s.renderSlot)(e.$slots,"tools",{},void 0,!0)])):((0,s.openBlock)(),(0,s.createElementBlock)("div",Bs,"x:"+(0,s.toDisplayString)(o.modelValue.x.toFixed(o.decimals))+",y:"+(0,s.toDisplayString)(o.modelValue.y.toFixed(o.decimals))+",z:"+(0,s.toDisplayString)(o.modelValue.z.toFixed(o.decimals)),1))],2),a.expanded?((0,s.openBlock)(),(0,s.createElementBlock)("div",$s,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.vprops,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",xs,[(0,s.createElementVNode)("label",Ds,(0,s.toDisplayString)(e),1),(0,s.createVNode)(l,{modelValue:r.value[e],"onUpdate:modelValue":[t=>r.value[e]=t,t=>r.updateValue(e,t)],decimals:o.decimals,step:o.step},null,8,["modelValue","onUpdate:modelValue","decimals","step"])]))),256))])):(0,s.createCommentVNode)("v-if",!0),(0,s.createCommentVNode)(' <div v-if="expanded" class="v3"\'> '),(0,s.createCommentVNode)(' <div v-for="(el) in vprops" class="v3value"> '),(0,s.createCommentVNode)(' <label class="v3label">{{ el }}</label> '),(0,s.createCommentVNode)(' <input v-model="value[el]"></input> '),(0,s.createCommentVNode)(" <float v-model='value[el]' :decimals :step @update:modelValue='updateValue(el, $event)' /> "),(0,s.createCommentVNode)(" </div> "),(0,s.createCommentVNode)(" </div> "),(0,s.createCommentVNode)(' <V3 v-if="expanded" :modelValue="value" :decimals :step  @update:modelValue=\'onUpdate\' /> ')])}],["__scopeId","data-v-51aee5ea"]]),As={style:{display:"flex","align-items":"center",gap:"3px","flex-direction":"column"}},Ms={class:"label"},Os={key:0,class:"tools"},js={key:1,class:"titleinfo"},Ps={key:0,class:"vector3"},Ls={class:"vector3value"},Rs={class:"vector3label"},Fs={data:()=>({expanded:!0,vprops:["x","y","z"]}),props:{rotation:{type:Object,default:{x:0,y:0,z:0}},quaternion:Object,label:String,modelValue:Object,decimals:{type:Number,default:2},step:{type:Number,default:1}},methods:{onChangeVal(e){e.x>359&&(e.x=0),e.x<-359&&(e.x=0),e.y>359&&(e.y=0),e.y<-359&&(e.y=0),e.z>359&&(e.z=0),e.z<-359&&(e.z=0);const t=new CustomEvent("update:modelValue",{detail:new Ee.Euler(Jt(Math.round(e.x)),Jt(Math.round(e.y)),Jt(Math.round(e.z)),"XYZ"),bubbles:!1});this.$emit("update:rotation",t.detail)}},computed:{formattedValue:{get(){return{x:Math.round(Yt(this.rotation.x)),y:Math.round(Yt(this.rotation.y)),z:Math.round(Yt(this.rotation.z))}}}}},Us=(0,B.A)(Fs,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("float");return(0,s.openBlock)(),(0,s.createElementBlock)("div",As,[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["title",a.expanded?"":"min"]),onClick:t[0]||(t[0]=e=>a.expanded=!a.expanded)},[(0,s.createElementVNode)("div",Ms,(0,s.toDisplayString)(a.expanded?"▼":"▶")+" "+(0,s.toDisplayString)(o.label),1),a.expanded?((0,s.openBlock)(),(0,s.createElementBlock)("div",Os,[(0,s.renderSlot)(e.$slots,"tools",{},void 0,!0)])):((0,s.openBlock)(),(0,s.createElementBlock)("div",js,"x:"+(0,s.toDisplayString)(r.formattedValue.x)+",y:"+(0,s.toDisplayString)(r.formattedValue.y)+",z:"+(0,s.toDisplayString)(r.formattedValue.z),1))],2),a.expanded?((0,s.openBlock)(),(0,s.createElementBlock)("div",Ps,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.vprops,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",Ls,[(0,s.createElementVNode)("label",Rs,(0,s.toDisplayString)(e),1),(0,s.createVNode)(l,{modelValue:r.formattedValue[e],"onUpdate:modelValue":[t=>r.formattedValue[e]=t,r.onChangeVal],decimals:o.decimals,step:o.step},null,8,["modelValue","onUpdate:modelValue","decimals","step"])]))),256))])):(0,s.createCommentVNode)("v-if",!0),(0,s.createCommentVNode)(' <V3 v-if="expanded" :modelValue="formattedValue" :decimals :step @update:modelValue=\'onChangeVal\' /> ')])}],["__scopeId","data-v-4cb417f8"]]),zs={style:{display:"flex","align-items":"center",gap:"1px","flex-direction":"column"}},Hs={name:"QuaternionEditor",props:{modelValue:{type:Ee.Quaternion,required:!0},decimals:{type:Number,default:2},step:{type:Number,default:1}},data:()=>({expanded:!0,x:0,y:0,z:0}),watch:{modelValue:{handler(e){this.updateEulerFromQuaternion(e)},immediate:!0,deep:!0}},methods:{updateEulerFromQuaternion(e){const t=(new Ee.Euler).setFromQuaternion(e,"XYZ");this.x=this.roundValue(t.x),this.y=this.roundValue(t.y),this.z=this.roundValue(t.z)},updateQuaternion(){const e=new Ee.Euler(this.x,this.y,this.z,"XYZ"),t=(new Ee.Quaternion).setFromEuler(e,"XYZ");this.$emit("update:modelValue",t)},roundValue:e=>Math.round(100*e)/100}},qs=(0,B.A)(Hs,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("V3");return(0,s.openBlock)(),(0,s.createElementBlock)("div",zs,[(0,s.createCommentVNode)(' <div class="title" :class="expanded ? \'\' : \'min\'">\r\n            <div class="label" @click="expanded = !expanded">{{expanded?\'▼\':\'▶\' }} {{ label }}</div>\r\n            <div v-if="expanded"class="tools"><slot name="tools"></slot></div>\r\n            <div v-else class="titleinfo">x:{{ modelValue.x.toFixed(decimals) }},y:{{ modelValue.y.toFixed(decimals) }},z:{{ modelValue.z.toFixed(decimals) }}</div>\r\n        </div> '),a.expanded?((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,modelValue:{x:a.x,y:a.y,z:a.z},decimals:o.decimals,step:o.step,"onUpdate:modelValue":r.updateQuaternion},null,8,["modelValue","decimals","step","onUpdate:modelValue"])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-96995396"]]),Gs={class:"block_container"},Ws={key:0,class:"editrow"},Ks={class:"label"},Ys={name:"LabelEditor",props:{modelValue:{type:String,default:""},label:{type:String,default:""},tooltip:{type:String,default:""}},data:()=>({editMode:!1,val:""}),watch:{modelValue(){this.editMode=!1}},methods:{startEdit(){this.val=this.modelValue,this.editMode=!0,this.$nextTick(()=>{this.$refs.editInput.focus()})},complete(e){console.log(e),e.ctrlKey||e.shiftKey||(e&&e.preventDefault(),this.$emit("update:modelValue",this.val),this.editMode=!1)},endEdit(){return this.editMode?(this.editMode=!1,this.val):this.modelValue}},mounted(){}},Js=(0,B.A)(Ys,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.createElementVNode)("div",Gs,[e.editMode?((0,s.openBlock)(),(0,s.createElementBlock)("div",Ws,[(0,s.withDirectives)((0,s.createElementVNode)("textarea",{rows:"10",cols:"33",ref:"editInput",class:"editinput","onUpdate:modelValue":t[0]||(t[0]=t=>e.val=t),onKeyup:t[1]||(t[1]=(0,s.withKeys)((...e)=>r.complete&&r.complete(...e),["enter"]))},null,544),[[s.vModelText,e.val]]),(0,s.createVNode)(l,{class:"okicon",value:"checkmark",size:"1em",onClick:r.complete},null,8,["onClick"])])):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"editrow",onClick:t[2]||(t[2]=(...e)=>r.startEdit&&r.startEdit(...e)),key:"tooltip-"+o.modelValue},[(0,s.createElementVNode)("span",Ks,(0,s.toDisplayString)(o.modelValue),1),(0,s.createVNode)(l,{value:"pencil",size:"1em"})])),[[i,o.tooltip||o.modelValue]])])])}],["__scopeId","data-v-44f8aea6"]]),Xs={class:"block_container"},Qs={key:0,class:"editrow"},Zs={class:"label"},er={name:"LabelEditor",props:{modelValue:{type:String,default:""},label:{type:String,default:""},tooltip:{type:String,default:""}},data:()=>({editMode:!1,val:""}),watch:{modelValue(){this.editMode=!1}},methods:{startEdit(){this.val=this.modelValue,this.editMode=!0,this.$nextTick(()=>{this.$refs.editInput.focus()})},complete(e){e&&e.preventDefault(),this.$emit("update:modelValue",this.val),this.editMode=!1},endEdit(){return this.editMode?(this.editMode=!1,this.val):this.modelValue}},mounted(){}},tr=(0,B.A)(er,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.createElementVNode)("div",Xs,[e.editMode?((0,s.openBlock)(),(0,s.createElementBlock)("div",Qs,[(0,s.withDirectives)((0,s.createElementVNode)("input",{ref:"editInput",class:"editinput","onUpdate:modelValue":t[0]||(t[0]=t=>e.val=t),onKeyup:t[1]||(t[1]=(0,s.withKeys)((...e)=>r.complete&&r.complete(...e),["enter"]))},null,544),[[s.vModelText,e.val]]),(0,s.createVNode)(l,{class:"okicon",value:"checkmark",size:"1em",onClick:r.complete},null,8,["onClick"])])):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"editrow",onClick:t[2]||(t[2]=(...e)=>r.startEdit&&r.startEdit(...e)),key:"tooltip-"+o.modelValue},[(0,s.createElementVNode)("span",Zs,(0,s.toDisplayString)(o.modelValue),1),(0,s.createVNode)(l,{value:"pencil",size:"1em"})])),[[i,o.tooltip||o.modelValue]])])])}],["__scopeId","data-v-1e1887cc"]]),or={class:"transform-container"},nr={class:"label"},ar={class:"transforms"},sr={key:1},rr={key:3},lr={key:5},ir={props:{modelValue:{type:Object,default:{}},value:{type:Object,default:{}},target:{type:Object}},beforeUnmount(){this.value},mounted(){ao.Transformer.addEventListener("objectChange",this.onTransformerEvent)},methods:{assignFromModel(e){this.value&&this.value[e]?(this.target[e]={x:this.value[e].x,y:this.value[e].y,z:this.value[e].z},this.$emit("save")):console.warn(`Value or property ${e} is undefined`)},removeTransform(e){this.target&&this.target[e]&&this.target[e]&&(delete this.target[e],"rotation"===e&&this.value.rotation.set(0,0,0,"XYZ"),this.$emit("save"))},onTransformerEvent(e){switch(console.log(ao.Transformer,this.target,this.value.position),ao.Transformer.mode){case"translate":this.target.position={...this.value.position};break;case"rotate":this.target.rotation={x:this.value.rotation.x,y:this.value.rotation.y,z:this.value.rotation.z};break;case"scale":this.target.scale={...this.value.scale}}this.$emit("save")},async onChangeTransform(e,t){switch(e){case"position":this.value.position.copy(t),this.target.position={x:t.x||0,y:t.y||0,z:t.z||0};break;case"rotation":this.value.rotation.set(t.x,t.y,t.z,"XYZ"),this.target.rotation={x:t.x,y:t.y,z:t.z};break;case"scale":this.value.scale.copy(t),this.target.scale={x:t.x,y:t.y,z:t.z}}this.$emit("save",e)}}},cr=(0,B.A)(ir,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("V3block"),c=(0,s.resolveComponent)("EulerBlock"),d=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[(0,s.createElementVNode)("div",or,[(0,s.createElementVNode)("div",nr,[(0,s.createCommentVNode)("v-if",!0)]),(0,s.createElementVNode)("div",ar,[o.target.position?((0,s.openBlock)(),(0,s.createBlock)(i,{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>r.onChangeTransform("position",e)),label:"Position",step:.1,modelValue:o.target.position,decimals:4},{tools:(0,s.withCtx)(()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"square",onClick:t[2]||(t[2]=e=>r.removeTransform("position"))},[(0,s.createVNode)(l,{value:"bin",size:"1em"})])),[[d,"Delete position"]])]),_:1},8,["modelValue"])):((0,s.openBlock)(),(0,s.createElementBlock)("div",sr,[(0,s.createElementVNode)("button",{class:"copybutton",onClick:t[4]||(t[4]=e=>r.assignFromModel("position"))},"Copy model position")])),o.target.rotation?((0,s.openBlock)(),(0,s.createBlock)(c,{key:2,"onUpdate:rotation":t[6]||(t[6]=e=>r.onChangeTransform("rotation",e)),label:"Rotation",step:1,decimals:0,rotation:o.target.rotation},{tools:(0,s.withCtx)(()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"square",onClick:t[5]||(t[5]=e=>r.removeTransform("rotation"))},[(0,s.createVNode)(l,{value:"bin",size:"1em"})])),[[d,"Remove rotation"]])]),_:1},8,["rotation"])):((0,s.openBlock)(),(0,s.createElementBlock)("div",rr,[(0,s.createElementVNode)("button",{class:"copybutton",onClick:t[7]||(t[7]=e=>r.assignFromModel("rotation"))},"Copy model rotation")])),o.target.scale?((0,s.openBlock)(),(0,s.createBlock)(i,{key:4,"onUpdate:modelValue":t[9]||(t[9]=e=>r.onChangeTransform("scale",e)),label:"Scale",step:.01,modelValue:o.target.scale},{tools:(0,s.withCtx)(()=>[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{class:"square",onClick:t[8]||(t[8]=e=>r.removeTransform("scale"))},[(0,s.createVNode)(l,{value:"bin",size:"1em"})])),[[d,"Remove size"]])]),_:1},8,["modelValue"])):((0,s.openBlock)(),(0,s.createElementBlock)("div",lr,[(0,s.createElementVNode)("button",{class:"copybutton",onClick:t[10]||(t[10]=e=>r.assignFromModel("scale"))},"Copy model scale")]))])])])}]]),dr={style:{display:"grid","grid-template-columns":"96px 1fr"}},pr={name:"EditColor",props:{modelValue:{type:Object}},computed:{val:{get(){return`#${this.modelValue?.getHexString()||"ffffff"}`},set(e){this.modelValue&&this.modelValue.set(e),this.$emit("update:modelValue",this.modelValue||new Ee.Color(e))}}}},ur=(0,B.A)(pr,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",dr,[(0,s.withDirectives)((0,s.createElementVNode)("input",{style:{width:"100%"},ref:"col",type:"color","onUpdate:modelValue":t[0]||(t[0]=e=>r.val=e)},null,512),[[s.vModelText,r.val]])])}]]),mr={style:{display:"grid","grid-template-columns":"96px 1fr"}},hr={name:"ColorString",props:{modelValue:{type:String}},computed:{val:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},fr=(0,B.A)(hr,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",mr,[(0,s.withDirectives)((0,s.createElementVNode)("input",{style:{width:"100%"},ref:"col",type:"color","onUpdate:modelValue":t[0]||(t[0]=e=>r.val=e)},null,512),[[s.vModelText,r.val]])])}]]),vr={class:"image-container"},gr={ref:"canva"},yr={key:0,class:"selector"},br={props:{modelValue:{type:Object,default:null},value:{type:Object},label:{type:String,default:""},tooltip:{type:String,default:""},selectable:{type:Boolean}},data:()=>({txtr:null}),watch:{value(e){this.redraw()}},methods:{onUpdate({result:e,file:t}){console.log(e);const o=new Blob([e],{type:t.type}),n=URL.createObjectURL(o);this.txtr=n;const a=(new THREE.TextureLoader).load(n,()=>{URL.revokeObjectURL(n)});this.$emit("update:modelValue",a.image),this.$app.storage.writeFile("texture.png",e)}},methods:{redraw(){const e=this.$refs.canva,t=e.getContext("2d");if(t.clearRect(0,0,e.width,e.height),this.value?.resource?.image)try{console.log(this.value);const o=this.value.resource.image;e.width=o.width,e.height=o.height,t.drawImage(o,0,0)}catch(e){}}},mounted(){this.redraw()}},kr=(0,B.A)(br,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",vr,[(0,s.createCommentVNode)(' <FileSelect @update:modelValue="onUpdate" acceptedTypes="image/\\*" /> '),(0,s.createElementVNode)("canvas",gr,null,512),o.selectable?((0,s.openBlock)(),(0,s.createElementBlock)("div",yr,[(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=t=>e.$emit("select"))},"SELECT")])):(0,s.createCommentVNode)("v-if",!0)])}]]),wr={class:"image-container"},Er=["src"];var _r=o(92);const Sr=new class{constructor(){this.renderer=null,this.scene=null,this.camera=null,this.canvas=null,this.db=null,this.dbName="ModelPreviews",this.dbVersion=1,this.storeName="previews",this.initDatabase(),this.initThreeJS()}async initDatabase(){return new Promise((e,t)=>{const o=indexedDB.open(this.dbName,this.dbVersion);o.onerror=()=>t(o.error),o.onsuccess=()=>{this.db=o.result,e()},o.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains(this.storeName)||t.createObjectStore(this.storeName,{keyPath:"id"})}})}initThreeJS(){this.canvas=document.createElement("canvas"),this.canvas.width=256,this.canvas.height=256,this.renderer=new Ee.WebGLRenderer({canvas:this.canvas,antialias:!0,preserveDrawingBuffer:!0,alpha:!0}),this.renderer.setSize(this.canvas.width,this.canvas.height),this.renderer.setClearColor(0,0),this.scene=new Ee.Scene;const e=new Ee.AmbientLight(16777215,.6);this.scene.add(e);const t=new Ee.DirectionalLight(16777215,.8);t.position.set(1,1,1),this.scene.add(t)}async loadModel(e){try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const o=await t.blob(),n=URL.createObjectURL(o);let a;if(!e.toLowerCase().endsWith(".glb")&&!e.toLowerCase().endsWith(".gltf"))throw new Error("Unsupported format. Only GLB/GLTF supported");return a=await this.loadGLTF(n),URL.revokeObjectURL(n),a}catch(e){throw console.error("Error loading model:",e),e}}loadGLTF(e){return new Promise((t,o)=>{(new _r.B).load(e,e=>t(e.scene),null,e=>o(e))})}fitCameraToObject(e,t){const o=(new Ee.Box3).setFromObject(e),n=o.getCenter(new Ee.Vector3),a=o.getSize(new Ee.Vector3),s=Math.max(a.x,a.y,a.z),r=t.fov*(Math.PI/180);let l=Math.abs(s/Math.sin(r/2));return l*=1.5,t.position.set(n.x,n.y,n.z+l),t.lookAt(n),{center:n,size:a}}async generatePreview(e){try{const t=await this.loadModel(e);this.scene.add(t),this.camera=new Ee.PerspectiveCamera(45,this.canvas.width/this.canvas.height,.1,1e3),this.fitCameraToObject(t,this.camera),this.renderer.render(this.scene,this.camera);const o=this.canvas.toDataURL("image/png"),n=this.generateId();return await this.saveToDatabase(n,o,e),this.scene.remove(t),n}catch(e){throw console.error("Error generating preview:",e),e}}generateId(){return`preview_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async saveToDatabase(e,t,o){return new Promise((n,a)=>{const s=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName),r={id:e,screenshot:t,originalUrl:o,createdAt:(new Date).toISOString()},l=s.add(r);l.onsuccess=()=>n(e),l.onerror=()=>a(l.error)})}async getPreview(e){return new Promise((t,o)=>{const n=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).get(e);n.onsuccess=()=>{n.result?t(n.result):o(new Error("Preview not found"))},n.onerror=()=>o(n.error)})}async deletePreview(e){return new Promise((t,o)=>{const n=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).delete(e);n.onsuccess=()=>t(),n.onerror=()=>o(n.error)})}async getAllPreviews(){return new Promise((e,t)=>{const o=this.db.transaction([this.storeName],"readonly").objectStore(this.storeName).getAll();o.onsuccess=()=>e(o.result),o.onerror=()=>t(o.error)})}async clearAllPreviews(){return new Promise((e,t)=>{const o=this.db.transaction([this.storeName],"readwrite").objectStore(this.storeName).clear();o.onsuccess=()=>e(),o.onerror=()=>t(o.error)})}},Nr=Sr,Vr={props:{modelValue:{type:[Object,String],default:null},value:{type:Object},label:{type:String,default:""},image:{type:String},tooltip:{type:String,default:""},selectable:{type:Boolean}},computed:{isString(){return"string"==typeof this.modelValue}},data:()=>({img:null}),watch:{modelValue(e){this.redraw()}},methods:{async redraw(){if(this.img=null,this.value[this.image])return void(this.img=this.value[this.image]);const e=await Nr.generatePreview(this.modelValue),t=await Nr.getPreview(e);this.img=t.screenshot}},mounted(){this.redraw()}},Cr=(0,B.A)(Vr,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",wr,[a.img?((0,s.openBlock)(),(0,s.createElementBlock)("img",{key:0,style:{width:"100%",height:"100%"},src:a.img},null,8,Er)):(0,s.createCommentVNode)("v-if",!0)])}]]),Br={class:"image-uploader"},$r=["accept"],xr={name:"FileSelect",props:{buttonText:{type:String,default:"Select Image"},maxFileSize:{type:Number,default:5242880},acceptedTypes:{type:String,default:"image/*"}},methods:{triggerFileInput(){this.$refs.fileInput.click()},handleFileSelect(e){const t=e.target.files[0];if(!t)return;if(console.log(t),!t.type.match(this.acceptedTypes.replace("*",".*")))return void this.$emit("error","Invalid file type");if(t.size>this.maxFileSize)return void this.$emit("error",`File is too large (max ${this.maxFileSize/1024/1024}MB)`);const o=new FileReader;o.onload=e=>{this.$emit("update:modelValue",{result:e.target.result,file:t})},o.onerror=()=>this.$emit("error","Failed to read file"),o.readAsArrayBuffer(t),e.target.value=""}}},Dr=(0,B.A)(xr,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Br,[(0,s.createElementVNode)("button",{onClick:t[0]||(t[0]=(...e)=>r.triggerFileInput&&r.triggerFileInput(...e)),class:"upload-button"},(0,s.toDisplayString)(o.buttonText),1),(0,s.createElementVNode)("input",{type:"file",ref:"fileInput",accept:o.acceptedTypes,onChange:t[1]||(t[1]=(...e)=>r.handleFileSelect&&r.handleFileSelect(...e)),style:{display:"none"}},null,40,$r)])}]]),Tr={__name:"twosidebool",props:{modelValue:{type:Boolean,default:!1},labels:{type:Array}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=t,a=()=>{n("update:modelValue",!o.modelValue)};return(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"toggle-switch",onClick:a},[(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["slider",{active:e.modelValue}])},[(0,s.createElementVNode)("span",{class:(0,s.normalizeClass)(["left-label",{active:!e.modelValue}])},[(0,s.renderSlot)(t.$slots,"left",{},()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.labels[0]),1)])],2),o[0]||(o[0]=(0,s.createElementVNode)("span",{class:"knob"},null,-1)),(0,s.createElementVNode)("span",{class:(0,s.normalizeClass)(["right-label",{active:e.modelValue}])},[(0,s.renderSlot)(t.$slots,"right",{},()=>[(0,s.createTextVNode)((0,s.toDisplayString)(e.labels[1]),1)])],2)],2)]))}},Ir=(0,B.A)(Tr,[["__scopeId","data-v-27cb6eff"]]),Ar={class:"selected-value"},Mr={class:"select-dropdown"},Or=["onClick"],jr={__name:"sectionselect",props:{modelValue:{type:String,default:""},list:{type:Array,default:()=>[]},placeholder:{type:String,default:"Выберите вариант"}},emits:["update:modelValue"],setup(e,{emit:t}){const o=e,n=t,a=(0,s.ref)(o.modelValue),r=(0,s.ref)(!1),l=(0,s.computed)(()=>{const e=o.list.find(e=>e.value===a.value);return e?e.label:o.placeholder});(0,s.watch)(()=>o.modelValue,e=>{e!==a.value&&(a.value=e)});const i=()=>{r.value=!r.value},c=()=>{setTimeout(()=>{r.value=!1},150)},d=e=>{const t=document.querySelector(".custom-select");t&&!t.contains(e.target)&&(r.value=!1)};return(0,s.onMounted)(()=>{document.addEventListener("click",d)}),(0,s.onUnmounted)(()=>{document.removeEventListener("click",d)}),(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createCommentVNode)(' <div class="text-align-editor">\r\n        <select v-model="localValue" @change="emitUpdate">\r\n            <option v-for="item in list" :value="item.value">{{ item.label || item.value }}</option>\r\n        </select>\r\n    </div> '),(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["custom-select",{"select-open":r.value}])},[(0,s.createElementVNode)("div",{class:"select-header",onClick:i,onBlur:c,tabindex:"0"},[(0,s.createElementVNode)("span",Ar,(0,s.toDisplayString)(l.value),1),(0,s.createElementVNode)("div",{class:(0,s.normalizeClass)(["select-arrow",{rotated:r.value}])},[...o[0]||(o[0]=[(0,s.createElementVNode)("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none"},[(0,s.createElementVNode)("path",{d:"M1 1.5L6 6.5L11 1.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],2)],32),(0,s.createVNode)(s.Transition,{name:"slide-fade",persisted:""},{default:(0,s.withCtx)(()=>[(0,s.withDirectives)((0,s.createElementVNode)("div",Mr,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.list,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:e.value,class:(0,s.normalizeClass)(["select-option",{selected:a.value===e.value}]),onClick:t=>(e=>{a.value=e.value,n("update:modelValue",e.value),r.value=!1})(e)},(0,s.toDisplayString)(e.label),11,Or))),128))],512),[[s.vShow,r.value]])]),_:1})],2)],2112))}},Pr=(0,B.A)(jr,[["__scopeId","data-v-55e4162a"]]),Lr={class:"property-form"},Rr={class:"label"},Fr={class:"editor"},Ur={name:"PropertyForm",props:{model:{type:Object,required:!0},properties:{type:Array,required:!0}},methods:{updateValue(e,t){!function(e,t,o){const n=t.split("."),a=n.pop();let s=e;for(const e of n)e in s||(s[e]={}),s=s[e];s[a]=o}(this.model,e,t),this.$emit("update:"+e,t),this.$emit("update:model",e,t)},getValue(e){return t=this.model,e.split(".").reduce((e,t)=>e?e[t]:void 0,t);var t}}},zr=(0,B.A)(Ur,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Lr,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.properties,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:t,class:"row"},[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Rr,[(0,s.createTextVNode)((0,s.toDisplayString)(e.label||e.key),1)])),[[l,`inspector.${e.label||e.key}`]]),(0,s.createElementVNode)("div",Fr,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.component),{modelValue:r.getValue(e.prop),"onUpdate:modelValue":t=>r.updateValue(e.prop,t)},null,8,["modelValue","onUpdate:modelValue"])),(0,s.createCommentVNode)(' <component v-if="prop.type === \'custom\'" :is="prop.component" v-model="model[prop.key]"\r\n                    @update:modelValue="updateValue(prop.key, $event)" />\r\n\r\n                <input v-else-if="prop.type === \'string\'" type="text" v-model="model[prop.key]"\r\n                    @input="updateValue(prop.key, $event.target.value)" />\r\n\r\n                <input v-else-if="prop.type === \'int\'" type="number" step="1" v-model.number="model[prop.key]"\r\n                    @input="updateValue(prop.key, parseInt($event.target.value))" />\r\n\r\n                <input v-else-if="prop.type === \'float\'" type="number" step="0.01" v-model.number="model[prop.key]"\r\n                    @input="updateValue(prop.key, parseFloat($event.target.value))" />\r\n\r\n                <select v-else-if="prop.type === \'select\'" v-model="model[prop.key]"\r\n                    @change="updateValue(prop.key, $event.target.value)">\r\n                    <option v-for="(opt, i) in prop.options" :key="i" :value="opt.value ?? opt">\r\n                        {{ opt.label ?? opt }}\r\n                    </option>\r\n                </select>\r\n\r\n                <input v-else-if="prop.type === \'checkbox\'" type="checkbox" v-model="model[prop.key]"\r\n                    @change="updateValue(prop.key, $event.target.checked)" />\r\n\r\n                <div v-else-if="prop.type === \'radio\'">\r\n                    <label v-for="(opt, i) in prop.options" :key="i">\r\n                        <input type="radio" :value="opt.value ?? opt" v-model="model[prop.key]"\r\n                            @change="updateValue(prop.key, $event.target.value)" />\r\n                        {{ opt.label ?? opt }}\r\n                    </label>\r\n                </div> ')])]))),128))])}],["__scopeId","data-v-59b50a68"]]),Hr={class:"labelField"},qr={name:"Label",props:{modelValue:{type:String},value:{type:Object}}},Gr=(0,B.A)(qr,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("tooltip");return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Hr,[(0,s.createTextVNode)((0,s.toDisplayString)(o.modelValue||""),1)])),[[l,o.modelValue]])}],["__scopeId","data-v-45c328bf"]]),Wr={style:{display:"flex","flex-direction":"column"}},Kr={style:{display:"flex","flex-direction":"row","justify-content":"space-between"}},Yr={style:{display:"flex","flex-direction":"row","justify-content":"space-between"}},Jr={props:{modelValue:{type:Object,default:{cast:!1,receive:!1}}},computed:{cast:{get(){return!!this.modelValue&&this.modelValue.cast},set(e){this.$emit("update:modelValue",{...this.modelValue?this.modelValue:{},cast:e})}},receive:{get(){return!!this.modelValue&&this.modelValue.receive},set(e){this.$emit("update:modelValue",{...this.modelValue?this.modelValue:{},receive:e})}}}},Xr=(0,B.A)(Jr,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("BoolEdit"),i=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Wr,[(0,s.createElementVNode)("div",Kr,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",null,[...t[2]||(t[2]=[(0,s.createTextVNode)("$$Cast:",-1)])])),[[i]]),(0,s.createVNode)(l,{modelValue:r.cast,"onUpdate:modelValue":t[0]||(t[0]=e=>r.cast=e),"update:modelValue":"cast=$event"},null,8,["modelValue"])]),(0,s.createElementVNode)("div",Yr,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",null,[...t[3]||(t[3]=[(0,s.createTextVNode)("$$Receive:",-1)])])),[[i]]),(0,s.createVNode)(l,{modelValue:r.receive,"onUpdate:modelValue":t[1]||(t[1]=e=>r.receive=e),"update:modelValue":"receive=$event"},null,8,["modelValue"])])])}]]),Qr={class:"dimension-control"},Zr={class:"controls"},el={class:"control-group"},tl={class:"control-row"},ol={class:"control-group"},nl={class:"control-row"},al={name:"DimensionControl",props:{value:{type:Object,default:{}},target:{type:Object}},emits:["update:target"],setup(e,{emit:t}){const o=e=>{if("number"==typeof e)return{value:e,unit:"px"};if("auto"===e||"fit-content"===e||"min-content"===e||"max-content"===e)return{value:0,unit:e};const t=e.match(/^([\d.]+)(\D+)$/);return t?{value:parseFloat(t[1]),unit:t[2]}:{value:0,unit:"px"}},n=o(e.target.width||"100px"),a=(0,s.ref)(n.value),r=(0,s.ref)(n.unit),l=o(e.target.height||"100px"),i=(0,s.ref)(l.value),c=(0,s.ref)(l.unit),d=(e,t)=>["auto","fit-content","min-content","max-content","none"].includes(t)?t:`${e}${t}`;return(0,s.watch)([a,r],()=>{t("update:target","width",d(a.value,r.value))}),(0,s.watch)([i,c],()=>{t("update:target","height",d(i.value,c.value))}),(0,s.watch)(()=>e.target.width,e=>{const t=o(e||"100px");a.value=t.value,r.value=t.unit}),(0,s.watch)(()=>e.target.height,e=>{const t=o(e||"100px");i.value=t.value,c.value=t.unit}),{widthValue:a,widthUnit:r,heightValue:i,heightUnit:c}}},sl=(0,B.A)(al,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Qr,[(0,s.createElementVNode)("div",Zr,[(0,s.createElementVNode)("div",el,[t[5]||(t[5]=(0,s.createElementVNode)("span",null,"Width",-1)),(0,s.createElementVNode)("div",tl,[(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.widthUnit=e)},[...t[4]||(t[4]=[(0,s.createStaticVNode)('<option value="px" data-v-f12dc314>px</option><option value="%" data-v-f12dc314>%</option><option value="em" data-v-f12dc314>em</option><option value="rem" data-v-f12dc314>rem</option><option value="vh" data-v-f12dc314>vh</option><option value="vw" data-v-f12dc314>vw</option><option value="auto" data-v-f12dc314>auto</option><option value="fit-content" data-v-f12dc314>fit-content</option><option value="min-content" data-v-f12dc314>min-content</option><option value="max-content" data-v-f12dc314>max-content</option>',10)])],512),[[s.vModelSelect,n.widthUnit]]),["auto","fit-content","min-content","max-content"].includes(n.widthUnit)?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=e=>n.widthValue=e),type:"number",min:"0"},null,512)),[[s.vModelText,n.widthValue,void 0,{number:!0}]])])]),(0,s.createElementVNode)("div",ol,[t[7]||(t[7]=(0,s.createElementVNode)("span",null,"Height",-1)),(0,s.createElementVNode)("div",nl,[(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>n.heightUnit=e)},[...t[6]||(t[6]=[(0,s.createStaticVNode)('<option value="px" data-v-f12dc314>px</option><option value="%" data-v-f12dc314>%</option><option value="em" data-v-f12dc314>em</option><option value="rem" data-v-f12dc314>rem</option><option value="vh" data-v-f12dc314>vh</option><option value="vw" data-v-f12dc314>vw</option><option value="auto" data-v-f12dc314>auto</option><option value="fit-content" data-v-f12dc314>fit-content</option><option value="min-content" data-v-f12dc314>min-content</option><option value="max-content" data-v-f12dc314>max-content</option>',10)])],512),[[s.vModelSelect,n.heightUnit]]),["auto","fit-content","min-content","max-content"].includes(n.heightUnit)?(0,s.createCommentVNode)("v-if",!0):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("input",{key:0,"onUpdate:modelValue":t[3]||(t[3]=e=>n.heightValue=e),type:"number",min:"0"},null,512)),[[s.vModelText,n.heightValue,void 0,{number:!0}]])])])])])}],["__scopeId","data-v-f12dc314"]]),rl={class:"text-color-editor"},ll={name:"TextColorEditor",props:{modelValue:{type:String}},data:()=>({defaultColor:"#000000"}),computed:{textColor:{get(){return this.modelValue||"#000000"},set(e){this.$emit("update:modelValue",e)}}},emits:["update:modelValue"]},il=(0,B.A)(ll,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",rl,[(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"color",id:"colorPicker","onUpdate:modelValue":t[0]||(t[0]=e=>r.textColor=e)},null,512),[[s.vModelText,r.textColor]])])}],["__scopeId","data-v-73332108"]]),cl={class:"font-size-editor"},dl={class:"controls"},pl={class:"size-control"},ul=["value"],ml={name:"FontSizeEditor",data:()=>({fontSizeValue:16,fontSizeUnit:"px",defaultSize:"16px",availableUnits:["px","em","rem","pt","pc","in","cm","mm","ex","ch","vw","vh","vmin","vmax","%"],sizePresets:[{label:"Маленький (12px)",value:"12px"},{label:"Средний (16px)",value:"16px"},{label:"Большой (24px)",value:"24px"},{label:"Заголовок (32px)",value:"32px"}]}),computed:{currentFontSize(){return`${this.fontSizeValue}${this.fontSizeUnit}`}},methods:{updateFontSize(){this.$emit("update:modelValue",this.currentFontSize)},resetSize(){const e=this.defaultSize.match(/(\d+\.?\d*)(\D+)/);e?(this.fontSizeValue=parseFloat(e[1]),this.fontSizeUnit=e[2]):(this.fontSizeValue=16,this.fontSizeUnit="px"),this.updateFontSize()},applyPreset(e){const t=e.match(/(\d+\.?\d*)(\D+)/);t&&(this.fontSizeValue=parseFloat(t[1]),this.fontSizeUnit=t[2],this.updateFontSize())},parseSize(e){const t=e.match(/(\d+\.?\d*)(\D+)/);return t?{value:parseFloat(t[1]),unit:t[2]}:null},init(){const e=this.parseSize(this.modelValue);e&&(this.fontSizeValue=e.value,this.fontSizeUnit=e.unit,this.defaultSize=this.modelValue)}},emits:["update:modelValue"],props:{modelValue:{type:String,default:"16px",validator:e=>/^\d*\.?\d+(px|em|rem|pt|pc|in|cm|mm|ex|ch|vw|vh|vmin|vmax|%)$/.test(e)}},watch:{modelValue(){this.init()}},created(){this.init()}},hl=(0,B.A)(ml,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",cl,[(0,s.createElementVNode)("div",dl,[(0,s.createElementVNode)("div",pl,[(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"number",id:"fontSizeValue","onUpdate:modelValue":t[0]||(t[0]=e=>a.fontSizeValue=e),min:"0",step:"0.1",onInput:t[1]||(t[1]=(...e)=>r.updateFontSize&&r.updateFontSize(...e))},null,544),[[s.vModelText,a.fontSizeValue,void 0,{number:!0}]]),(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>a.fontSizeUnit=e),onChange:t[3]||(t[3]=(...e)=>r.updateFontSize&&r.updateFontSize(...e))},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(a.availableUnits,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{value:e,key:e},(0,s.toDisplayString)(e),9,ul))),128))],544),[[s.vModelSelect,a.fontSizeUnit]])])])])}],["__scopeId","data-v-f859e98c"]]),fl={class:"container"},vl={class:"list-container"},gl={class:"list-head"},yl={class:"list-slider"},bl={key:0},kl={key:1,class:"grid"},wl=["onClick"],El={class:"grid-item"},_l={class:"textwrap tcenter w100"},Sl={class:"textwrap w100"},Nl={style:{display:"flex","justify-content":"center"}},Vl={key:0,class:"extension"},Cl={class:"form-block"},Bl={class:"form-row"},$l={name:"LibForm",props:{modelValue:{type:Object},rows:{type:Array}},computed:{val(){return this.modelValue}}},xl=(0,B.A)($l,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Cl,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.rows,e=>((0,s.openBlock)(),(0,s.createElementBlock)("div",Bl,[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(e.label),1),((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.component),(0,s.mergeProps)({class:"form-component"},{ref_for:!0},e.props,{value:r.val,modelValue:r.val[e.prop],"onUpdate:modelValue":t=>r.val[e.prop]=t}),null,16,["value","modelValue","onUpdate:modelValue"]))]))),256))])}]]),Dl={name:"ItemsLib",props:{selected:{type:Object},selectedIndex:{type:Number},rows:{type:Array},list:{type:Array},head:{type:Object,default:{}},styles:{type:Object,default:{item:{width:"72px",height:"72px"}}},icons:{type:Object,default:{}},options:{type:Object,default:{id:"uid",name:"name",icon:"icon",icontip:"tooltip"}},busy:{type:Boolean,default:!1}},computed:{target(){return this.selected}},mounted(){this.$emit("open")},components:{LibForm:xl}},Tl=(0,B.A)(Dl,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("LibForm"),c=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",fl,[(0,s.createElementVNode)("div",vl,[(0,s.createElementVNode)("div",gl,[(0,s.renderSlot)(e.$slots,"head",(0,s.normalizeProps)((0,s.guardReactiveProps)(o.head)),()=>[(0,s.createElementVNode)("div",null,(0,s.toDisplayString)(o.head.title),1)],!0)]),(0,s.createElementVNode)("div",yl,[o.busy?((0,s.openBlock)(),(0,s.createElementBlock)("div",bl)):((0,s.openBlock)(),(0,s.createElementBlock)("div",kl,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.list,(t,n)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{onClick:o=>e.$emit("selected",t,n),class:(0,s.normalizeClass)([{selected:o.selected===t||o.selectedIndex===n},"grid-element"])},[(0,s.renderSlot)(e.$slots,"item",{item:t},()=>[(0,s.createElementVNode)("div",El,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",_l,[(0,s.createTextVNode)((0,s.toDisplayString)(t[o.options.name]||t[o.options.id]),1)])),[[c,t[o.options.name]||t[o.options.id]]]),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Sl,[(0,s.createTextVNode)((0,s.toDisplayString)(t.url),1)])),[[c,t.url]]),(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Nl,[(0,s.createVNode)(l,{value:o.icons[t.type],size:"2em"},null,8,["value"])])),[[c,t[o.options.icontip]]])])],!0)],10,wl))),256))]))])]),o.selected?((0,s.openBlock)(),(0,s.createElementBlock)("div",Vl,[(0,s.renderSlot)(e.$slots,"edit",{selected:o.selected,rows:o.rows},()=>[(0,s.createVNode)(i,{modelValue:r.target,"onUpdate:modelValue":t[0]||(t[0]=e=>r.target=e),rows:o.rows},null,8,["modelValue","rows"])],!0)])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-119c099c"]]),Il={class:"pitem"},Al={class:"textwrap w100 tcenter"},Ml={style:{display:"flex","justify-content":"center"},class:"tcenter"},Ol={props:{item:{type:Object}},computed:{date(){return new Date(this.item.created).toLocaleString()}}},jl=(0,B.A)(Ol,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Il,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Al,[(0,s.createTextVNode)((0,s.toDisplayString)(o.item.name),1)])),[[l,o.item.name]]),(0,s.createElementVNode)("div",Ml,(0,s.toDisplayString)(r.date),1)])}],["__scopeId","data-v-a84bc2fe"]]),Pl={class:"container"},Ll={class:"block"},Rl={class:"label"},Fl={class:"value"},Ul={data:()=>({result:""}),props:{text:{type:String}},emits:["update:text"]},zl=(0,B.A)(Ul,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Pl,[(0,s.createElementVNode)("div",Ll,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Rl,[(0,s.createTextVNode)(" $$"+(0,s.toDisplayString)(o.text),1)])),[[l]]),(0,s.createElementVNode)("div",Fl,[(0,s.withDirectives)((0,s.createElementVNode)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.result=e),onInput:t[1]||(t[1]=t=>e.$emit("update:text",a.result))},null,544),[[s.vModelText,a.result]])])])])}],["__scopeId","data-v-3bf1bb00"]]),Hl={class:"container"},ql={class:"block"},Gl={class:"label"},Wl={data:()=>({result:""}),props:{text:{type:String}}},Kl=(0,B.A)(Wl,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Hl,[(0,s.createElementVNode)("div",ql,[(0,s.createElementVNode)("div",Gl,(0,s.toDisplayString)(o.text),1)])])}],["__scopeId","data-v-11e695e2"]]),Yl={class:"form-group"},Jl=["disabled"],Xl={key:0,class:"form-group"},Ql=["disabled"],Zl={key:1,class:"form-group"},ei=["disabled"],ti={key:2,class:"form-group"},oi=["disabled"],ni=["disabled"],ai={class:"form-actions"},si=["disabled"],ri=["disabled"],li={key:3,class:"helper-actions"},ii={key:4,class:"info-message"},ci={key:5,class:"error-message"},di={__name:"auth",emits:["success"],setup(e,{emit:t}){const o=Eo.default.default||Eo.default,n=t,a=(0,s.ref)("login"),r=(0,s.ref)(!1),l=(0,s.ref)(""),i=(0,s.ref)(""),c=(0,s.reactive)({email:"",password:"",code:"",newPassword:"",confirmPassword:""}),d=(0,s.computed)(()=>{switch(a.value){case"login":return"Login";case"recover":return"Отправить код";case"verify":return"Подтвердить код";case"reset":return"Установить пароль"}}),p=(0,s.computed)(()=>"login"===a.value?"Cancel":"Назад"),u=(0,s.computed)(()=>{switch(a.value){case"login":return"Вход...";case"recover":return"Отправка...";case"verify":return"Проверка...";case"reset":return"Сохранение..."}});function m(){f(),a.value="recover",c.password="",c.code="",c.newPassword="",c.confirmPassword=""}function h(){f(),"login"===a.value?(c.email="",c.password=""):(a.value="login",c.code="",c.newPassword="",c.confirmPassword="")}function f(){l.value="",i.value=""}async function v(){if(f(),c.email)try{if(r.value=!0,"login"===a.value){const e=await fetch("/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c.email,password:c.password})});if(!e.ok)throw await g(e);const t=await e.json();n("success",t)}else if("recover"===a.value){const e=await fetch("/auth/recovery",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c.email})});if(!e.ok)throw await g(e);i.value="Код отправлен на указанный email",a.value="verify"}else if("verify"===a.value){if(!c.code)return void(l.value="Код обязателен");const e=await fetch("/auth/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c.email,code:c.code})});if(!e.ok)throw await g(e);i.value="Код подтверждён. Введите новый пароль.",a.value="reset"}else if("reset"===a.value){if(!c.newPassword||!c.confirmPassword)return void(l.value="Заполните оба поля пароля");if(c.newPassword!==c.confirmPassword)return void(l.value="Пароли не совпадают");console.log(c.newPassword),await o.app.setPassword(c.newPassword),i.value="Пароль изменён.",a.value="login",c.password="",c.newPassword="",c.confirmPassword="",c.code=""}}catch(e){l.value="string"==typeof e?e:e?.message||"Ошибка сервера"}finally{r.value=!1}else l.value="Email обязателен"}async function g(e){try{const t=await e.json();return t?.message||t?.error||`HTTP ${e.status}`}catch{return`HTTP ${e.status}`}}return(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("form",{onSubmit:(0,s.withModifiers)(v,["prevent"]),class:"login-form"},[(0,s.createElementVNode)("div",Yl,[t[5]||(t[5]=(0,s.createElementVNode)("label",{for:"email"},"Email:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{id:"email",type:"email","onUpdate:modelValue":t[0]||(t[0]=e=>c.email=e),required:"",placeholder:"Введите email",disabled:r.value},null,8,Jl),[[s.vModelText,c.email]])]),(0,s.createCommentVNode)(" LOGIN: email + password "),"login"===a.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",Xl,[t[6]||(t[6]=(0,s.createElementVNode)("label",{for:"password"},"Пароль:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{id:"password",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>c.password=e),required:"",placeholder:"Введите пароль",disabled:r.value},null,8,Ql),[[s.vModelText,c.password]])])):(0,s.createCommentVNode)("v-if",!0),(0,s.createCommentVNode)(" VERIFY CODE "),"verify"===a.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",Zl,[t[7]||(t[7]=(0,s.createElementVNode)("label",{for:"code"},"Код из письма:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{id:"code",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>c.code=e),required:"",placeholder:"Введите код",disabled:r.value},null,8,ei),[[s.vModelText,c.code]])])):(0,s.createCommentVNode)("v-if",!0),(0,s.createCommentVNode)(" RESET PASSWORD "),"reset"===a.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",ti,[t[8]||(t[8]=(0,s.createElementVNode)("label",{for:"newPassword"},"Новый пароль:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{id:"newPassword",type:"password","onUpdate:modelValue":t[3]||(t[3]=e=>c.newPassword=e),required:"",placeholder:"Введите новый пароль",disabled:r.value},null,8,oi),[[s.vModelText,c.newPassword]]),t[9]||(t[9]=(0,s.createElementVNode)("label",{for:"confirmPassword",style:{"margin-top":"8px"}},"Повтор пароля:",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{id:"confirmPassword",type:"password","onUpdate:modelValue":t[4]||(t[4]=e=>c.confirmPassword=e),required:"",placeholder:"Повторите пароль",disabled:r.value},null,8,ni),[[s.vModelText,c.confirmPassword]])])):(0,s.createCommentVNode)("v-if",!0),(0,s.createElementVNode)("div",ai,[(0,s.createElementVNode)("button",{type:"submit",disabled:r.value},(0,s.toDisplayString)(r.value?u.value:d.value),9,si),(0,s.createCommentVNode)(" Cancel / Back "),(0,s.createElementVNode)("button",{type:"button",onClick:h,disabled:r.value},(0,s.toDisplayString)(p.value),9,ri)]),"login"===a.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",li,[(0,s.createElementVNode)("a",{href:"#",onClick:(0,s.withModifiers)(m,["prevent"])},"Забыли пароль?")])):(0,s.createCommentVNode)("v-if",!0),i.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",ii,(0,s.toDisplayString)(i.value),1)):(0,s.createCommentVNode)("v-if",!0),l.value?((0,s.openBlock)(),(0,s.createElementBlock)("div",ci,(0,s.toDisplayString)(l.value),1)):(0,s.createCommentVNode)("v-if",!0)],32))}},pi=(0,B.A)(di,[["__scopeId","data-v-867ec93e"]]),ui={props:{text:{type:Object,default:{value:"TEXT",size:"1em"}},path:{type:String},visible:{type:Boolean},styles:{type:Object}},mounted(){this.$emit("mounted",{path:this.path,element:this.$refs.container})}},mi=(0,B.A)(ui,[["render",function(e,t,o,n,a,r){return(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{ref:"container",class:"cardroot",style:(0,s.normalizeStyle)({fontSize:o.text.size,...o.styles})},(0,s.toDisplayString)(o.text.value),5)),[[s.vShow,o.visible]])}],["__scopeId","data-v-4de6bc04"]]);var hi=o(828);const fi={class:"toastcontainer"},vi={class:"alert"},gi={class:"text"},yi={class:"buttons"},bi=["onClick"],ki={name:"QueryToast",props:{icon:{type:String,default:"notification"},message:{type:String,default:""},type:{type:String,default:"info"},buttons:{type:Array}}},wi=(0,B.A)(ki,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon");return(0,s.openBlock)(),(0,s.createElementBlock)("div",fi,[(0,s.createElementVNode)("div",vi,[(0,s.createVNode)(l,{class:(0,s.normalizeClass)(`${o.type}icon`),size:"3em",value:o.icon},null,8,["class","value"]),(0,s.createElementVNode)("span",gi,(0,s.toDisplayString)(o.message),1)]),(0,s.createElementVNode)("div",yi,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.buttons,e=>((0,s.openBlock)(),(0,s.createElementBlock)("button",{onClick:e.handler,class:"btn"},(0,s.toDisplayString)(e.label),9,bi))),256))])])}]]),Ei=Eo.default.default||Eo.default;let _i=0;const Si=(0,s.reactive)({list:[],add({message:e,icon:t,onclick:o,timehide:n=!0,type:a,...r},l=(0,s.markRaw)(Yn)){const i=(0,s.reactive)({id:_i++,data:{message:e,icon:t,type:a,...r},component:l});return n&&(i.timeout=setTimeout(()=>{Si.remove(i.id)},3e3)),i.onclick=o||Si.remove.bind(this,i.id),Si.list.push(i),i},remove(e){for(let t=Si.list.length-1;t>=0;t--)Si.list[t].id===e&&Si.list.splice(t,1)}});Ei.On("init",()=>{window.vue.component("QueryToast",wi)});const Ni=Si,Vi=(0,s.ref)(!1),Ci=(0,s.reactive)({isVisible:!1,header:null,content:null,footer:null,values:null,open({header:e,content:t,footer:o,...n}){Ci.header=e||{},Ci.content=t||{},Ci.footer=o||{},Ci.values={closable:!1,...n},Vi.value=!0},close(e){e||(Vi.value=!1)},get isVisible(){return Vi.value},queryText(e,t,o){Ci.open({header:{value:e.title,handler:Ci.close},content:{component:"queryform",props:e,events:{"update:text":o}},footer:{buttons:[...t.map(t=>(t.handler=()=>{t.callback(e.answer),Ci.close()},t)),{label:"Close",class:"additional",handler:Ci.close}]}})},confirmReq(e,t){Ci.open({header:{value:e.title,handler:Ci.close},content:{component:"confirmform",props:e},footer:{buttons:[...t.map(t=>(t.handler=()=>{t.callback(e.answer),Ci.close()},t))]}})}}),Bi=Ci,$i=Eo.default.default||Eo.default;class xi extends Error{constructor(){super("Not all required parameters are specified."),this.isReqError=!0}}class Di extends Error{constructor(){super("This module has already been added."),this.isExistError=!0}}const Ti=[{name:"engine",entry:"/editor/engine/mf.js",index:"engine",system:!0},{name:"tools",entry:"/mods/tools/mf.js",index:"tools",system:!0}],Ii=[],Ai={};function Mi(e){return new Promise(t=>{(0,hi.loadRemote)(`${e.name}/${e.index}`).then(async o=>{Ii.push({name:e.name,index:e.index,entry:e.entry,title:e.title||e.name,id:e.id,uid:e.uid,global:e.global,description:e.description}),Ai[e.name]=o,o.Init&&await o.Init(),t()})})}async function Oi(e){if(e.uid=`${e.index}:${e.entry}`,!e.name?.length||!e.index?.length||!e.entry?.length)throw new xi;if(Ii.find(t=>t.uid===e.uid))throw new Di;try{(0,hi.registerRemotes)([{...e}],{force:!0}),await Mi(e)}catch(e){throw e}const t=await async function(e){const t={id:e.entry,...e};return await cn.upsertItemProperties("modules",t.uid,t),t}(e);return Ii.push(t),console.log(Ii),t}function ji(){const e=(0,s.reactive)({selected:null,list:Ii,processed:!1,styles:{item:{width:"128px",height:"128px"}},title:"Project modules"}),t={label:"Add",class:"secondary",hidden:(0,s.computed)(()=>!e.selected||e.selected.uid||e.processed),handler:async()=>{e.processed=!0;try{console.log("try"),e.selected=await Oi(e.selected),console.log("try OK")}catch(t){return console.log(t.message),t.isReqError?Ni.add({message:"Not all required fields are filled in"}):Ni.add({message:"Error adding module"}),e.processed=!1,void(e.selected.uid=null)}Ni.add({message:"The module has been loaded successfully."})}},o={label:"Registration",class:"secondary",hidden:(0,s.computed)(()=>e.selected&&!e.selected.uid),handler:()=>{e.selected=(0,s.reactive)({name:"",entry:"",index:""})}},n={label:"Report",class:"primary",hidden:(0,s.computed)(()=>!e.selected||!e.selected.uid),handler:()=>{e.selected=null}},a={label:"Remove",class:"additional",hidden:(0,s.computed)(()=>!e.selected?.id),handler:async()=>{const t=`${e.selected.index}:${e.selected.entry}`,o=Ii.findIndex(e=>`${e.index}:${e.entry}`===t);if(o>=0){const t=Ai[e.selected.name];if(t.Remove&&!await t.Remove())return;const n=Ii.splice(o,1);console.log(n),cn.deleteItem("modules",n[0].uid),$i.toasts.add({message:"The module has been removed and will not be loaded the next time you use it.\nPlease refresh the page to take effect."}),e.selected=null}}},r={label:"Close",class:"primary",handler:async()=>{Bi.close()}},l=(0,s.reactive)([o,a,t,n,r]);Bi.open({header:{value:"Managing modules",handler:()=>{Bi.close()}},content:{component:"ItemsLib",props:e,events:{selected:t=>{e.selected=t,console.log(e.selected)}},slots:{item:{component:"ModuleItem"},edit:{component:"ModuleEdit",props:e,events:{edit:(t,o)=>{e.selected[t]=o}}}}},footer:{buttons:l}})}async function Pi(){const e=(0,s.reactive)({selected:null,list:[],processed:!1,canadd:!1,styles:{item:{width:"128px",height:"128px"}},head:{title:""}}),t={label:"Add to project",class:"secondary",hidden:(0,s.computed)(()=>e.processed||!e.selected||!e.canadd),handler:async()=>{e.processed=!0;try{await Oi({...e.selected})}catch(t){return t.isExistError?Ni.add({message:t.message}):Ni.add({message:"Error adding module"}),void(e.processed=!1)}e.canadd=-1===Ii.findIndex(t=>t.uid===e.selected.uid),Ni.add({message:"The module has been added to project."}),e.processed=!1}},o={label:"Close",class:"primary",handler:async()=>{Bi.close()}},n=(0,s.reactive)([t,o]),a=async(t="")=>{const o=await fetch("modules.json"),n=await o.json();e.list=n.filter(e=>e.name.includes(t)||e.description.includes(t))};Bi.open({header:{value:"Global modules",handler:()=>{Bi.close()}},content:{component:"ItemsLib",props:e,events:{selected:t=>{e.selected=t,e.canadd=-1===Ii.findIndex(t=>t.uid===e.selected.uid),console.log(e.selected,e.canadd)}},slots:{head:{component:"SearchFilter",events:{search(t){e.selected=null,e.canadd=-1===Ii.findIndex(t=>t.uid===e.selected.uid),a(t)},change(t){t||(e.selected=null,e.canadd=-1===Ii.findIndex(t=>t.uid===e.selected.uid),a())}}},item:{component:"ModuleItem"},edit:{component:"ModuleView",props:e}}},footer:{buttons:n}}),a()}const Li=(0,s.reactive)({init:async function(){(0,hi.createInstance)({name:"slider.editor",remotes:[]}),Ii.length=0,await(0,hi.registerRemotes)([...Ti]),await Promise.all(Ti.map(e=>new Promise(t=>{(0,hi.loadRemote)(`${e.name}/${e.index}`).then(o=>{Ai[e.name]=o,t()})})))},showLib:ji,getMod:function(e){return Ai[e]},loadUserModules:async function(e){await(0,hi.registerRemotes)(e),await Promise.all(e.map(e=>Mi(e)))},AddModules:async function(e){for(let t=0;t<e.length;t++){const o=e[t];try{await Oi(o)}catch(e){continue}}}});$i.On("init",()=>{$i.menu.hierarhy.list.unshift({icon:"plug",tooltip:"Modules",handler:ji}),window.vue.component("ModuleEdit",(0,s.defineAsyncComponent)(async()=>{const e=await o.e(689).then(o.bind(o,689));return e.default||e})),window.vue.component("ModuleItem",(0,s.defineAsyncComponent)(async()=>{const e=await o.e(920).then(o.bind(o,920));return e.default||e})),window.vue.component("ModuleView",(0,s.defineAsyncComponent)(async()=>{const e=await o.e(833).then(o.bind(o,833));return e.default||e})),$i.menu.addMenu("app",{path:"app.list.libraries",icon:"",text:"Libraries",link:"#",children:[{path:"app.list.libraries.modules",icon:"plug",text:"Modules",handler:Pi}]})});const Ri=Li,Fi=class{constructor(){this._events={"*":[]}}subs(e,t,o){null==this._events[e]&&(this._events[e]=[]),this._events[e].push({handler:o,once:t})}on(e,t){this.subs(e,!1,t)}once(e,t){this.subs(e,!0,t)}off(e,t){const o=this._events[e];if(o){for(let e=o.length-1;e>=0;e--)o[e].handler===t&&o.splice(e,1);0===o.length&&delete this._events[e]}}clear(e){this._events[e]=[]}clearAll(){this._events={"*":[]}}emit(e,...t){const o=[];this._events[e]&&o.push(...this._events[e]),this._events["*"].length&&o.push(...this._events["*"].map(t=>({handler:t.handler.bind(this,e),once:t.once})));for(let e=o.length-1;e>=0;e--){const n=o[e];n.handler.apply(null,t),n.once&&o.splice(e,1)}}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}},Ui=Eo.default.default||Eo.default,{translateText:zi}=At,Hi=new Fi;let qi;async function Gi(e,t,o){if(!t)return;if(o[t.uid])return o[t.uid];const n=t.parent;let a=o[n];a||(a=await Gi(e,e.find(e=>e.uid===n),o));const s=await Wi(t,a);return o[s.uid]=s,s}async function Wi(e,t){const o=await qi.BuildElement(e,t||Ui.engine.getManager().Root);if(!o)return;const n=(0,s.reactive)(o);return(t||Xi).add(n),Hi.emit("create",n),o.visible=!1,n}async function Ki(e){console.log(e);try{const t=qi.exportToJSON(e),o=JSON.parse(Xt({name:e.name,paths:e.paths,path:e.paths.join("."),parent:e.parent?.uid||null,actions:e.actions||[],states:e.states,type:e.type,uid:e.uid,...t}));await cn.upsertItemProperties("models",e.uid,o)}catch(e){console.warn(e)}}function Yi(e){let t=Xi;for(let o=0;o<e.length;o++)t=t.children.find(t=>t.uid===e[o]);return t}function Ji(e,t,o=[]){for(let n=0;n<e.length;n++){const a=e[n];a.isElement&&a.states[t]&&o.push(a),a.children?a.children.length&&Ji(a.children,t,o):console.warn("No child")}}const Xi=(0,s.reactive)({add(e){Xi.children.push(e)},load:async function(e){qi=Ui.engine.getFactory();const t={};for(let o=e.length-1;o>=0;o--){const n=e[o],a=await Gi(e,n,t),s=e.findIndex(e=>e.uid===a.uid);s>=0&&e.splice(s,1)}},createElement:Wi,save:Ki,remove:async function e(t){let o=Xi,n=Xi;for(let e=0;e<t.length;e++)o=n,n=o.children.find(o=>o.uid===t[e]);Ui.selection.selected===n&&Ui.selection.select(null);const a=o.children.findIndex(e=>e===n);if(a>=0){for(let t=0;t<n.children.length;t++){const o=n.children[t];o.isElement&&e(o.paths)}o.children.splice(a,1),n.parent&&n.parent.remove(n),cn.deleteItem("models",n.uid),qi.RemoveInstance(n.uid),Hi.emit("remove",t,n)}},createFromAsset:async function(e,t){if(console.log("createFromAsset",e),!Ui.slides.actived)return void Ui.toasts.add({message:"You need to create a slide first",key:"slideNeed"});let o;o=t?Yi(t):Ui.selection.selected?.isElement?Yi(Ui.selection.selected.paths):null;const n={name:Qt(e.name||"asset",Array.from(qi.instances.values().map(e=>e.name))),...e.toModel()},a=await Wi(n,o);Ui.assets.useAsset(e.uid,a.uid),Ki(a)},createTo:function(e){console.log("createTo",e);const t={uid:`Element${Date.now()}`,name:"Element",type:"Group",paths:[],path:""};e&&e.isElement&&t.paths.push(...e.paths),t.paths.push(t.uid),t.path=t.paths.join(".");const o={parent:e,modelValue:t,list:Ui.app.types.filter(e=>e.isModel).sort((e,t)=>e.label.localeCompare(t.label))};Ui.modal.open({header:{value:zi("addelement.header",{"#suffix":e?zi("addelement.header.v1",{"#parentname":e.name||e.uid}):zi("addelement.header.v2")}),handler:()=>{Ui.modal.close()}},content:{component:"ElementAdd",props:o,events:{"update:modelValue":e=>{Object.keys(e).forEach(o=>{t[o]=e[o]})}}},footer:{buttons:[{label:"Add",class:"secondary",handler:async()=>{const o=Ui.engine.getFactory().getTypeConfig(t.type);o.template&&Object.keys(o.template).forEach(e=>{t[e]=o.template[e]});try{const o=await Wi(t,e);o&&await Ki(o)}catch(e){console.warn(e),Ui.toasts.add({message:`Error on create ${t.type}`})}Ui.modal.close()}},{label:"Cancel",class:"primary",handler:async()=>{Ui.modal.close()}}]}})},find:Yi,getState:function(e,t){return e.states[t]||(e.states[t]={actions:[]},Hi.emit("stateadd",t,e.paths)),e.states[t]},findStates:function(e){const t=[];return Ji(Xi.children,e,t),t},findObjectsByType:function(e){const t=[];return function o(n){n instanceof e&&t.push({type:n.type,name:n.name,path:n.path}),n.children&&Array.isArray(n.children)&&n.children.forEach(e=>o(e))}(Xi),t},children:[],uid:null,data:{},on:Hi.on.bind(Hi),off:Hi.off.bind(Hi)});Ui.On("init",()=>{Ui.slides.on("change",e=>{Ji(Xi.children,e,[])}),Ui.slides.on("remove",e=>{const t=[];Ji(Xi.children,e,t);for(let o=0;o<t.length;o++)delete t[o].states[e]})});const Qi=Xi,Zi={class:"slide-tools"},ec={key:0},tc=["value"],oc={key:1},nc={name:"CameraSelector",props:{modelValue:{type:String}},computed:{selectedCamera:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},cameras(){return this.$app.models.findObjectsByType(Ee.Camera)||[]}}},ac=(0,B.A)(nc,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Zi,[r.cameras.length>0?((0,s.openBlock)(),(0,s.createElementBlock)("div",ec,[(0,s.withDirectives)((0,s.createElementVNode)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedCamera=e)},[t[1]||(t[1]=(0,s.createElementVNode)("option",{value:null},"No",-1)),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.cameras,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{key:e.path,value:e.path}," ("+(0,s.toDisplayString)(e.type)+") "+(0,s.toDisplayString)(e.name||`Camera ${e.uid}`),9,tc))),128))],512),[[s.vModelSelect,r.selectedCamera]])])):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",oc,[...t[2]||(t[2]=[(0,s.createTextVNode)(" There are no cameras available in the project. ",-1)])])),[[l,"No cam in project"]])])}]]),sc=Eo.default.default||Eo.default,rc=new Fi;async function lc(e){const t=e||pc.actived,o={actions:t.actions,name:t.name,index:t.index,camera:t.camera,uid:t.uid,props:t.props,background:t.background,environment:t.environment},n=JSON.parse(Xt(o));try{await cn.upsertItemProperties("slides",o.uid,n)}catch(e){console.warn(e)}}function ic(e){const t=pc.actived;pc.actived="number"==typeof e?pc.children[e]:pc.children.find(t=>t.uid===e),pc.actived&&(rc.emit("change",pc.actived.uid),async function(e,t){let o=[],n=Qi.findStates(e.uid);t&&(o=Qi.findStates(t.uid),await async function(e,t,o){const n=[],a=[];for(let e=0;e<t.length;e++){const s=t[e];o.findIndex(e=>e.uid===s.uid)>=0?n.push(s):a.push(s)}const s=[...a,...n];await Promise.all([sc.engine.ActionsManager.Execute(s,"slide.out"),sc.engine.ActionsManager.Run(e.actions,e,"slide.out")]),await sc.engine.ActionsManager.Execute(a,"disable.on");for(let e=0;e<a.length;e++)dc(a[e])}(t,o,n)),await async function(e,t,o){const n=[],a=[];for(let e=0;e<t.length;e++){const s=t[e];o.findIndex(e=>e.uid===s.uid)>=0?a.push(s):n.push(s)}console.log("Slide In");try{if(e.camera?.path&&e.camera?.path!==sc.engine.getManager().Camera?.path){const t=e.camera.path.split("."),o=Qi.find(t);o&&(sc.engine.getManager().SetCamera(o),o.updateProjectionMatrix())}console.log(e.background),e.background&&(e.background.isAsset?sc.engine.getManager().Scene.background=e.background.resource:sc.engine.getManager().Scene.background=e.background)}catch(e){console.warn(e)}const s=[...n,...a],r=s.map(t=>({...t.states[e.uid],model:t}));await Promise.all([sc.engine.ActionsManager.Execute(r,"slide.in.before"),sc.engine.ActionsManager.Run(e.actions,e,"slide.in.before")]),await sc.engine.ActionsManager.Execute(n,"enable.on"),await Promise.all([sc.engine.ActionsManager.Execute(r,"slide.in"),sc.engine.ActionsManager.Run(e.actions,e,"slide.in")]);const l=[];for(let t=0;t<s.length;t++)l.push(cc(s[t],e.uid));await Promise.all(l),await Promise.all([sc.engine.ActionsManager.Execute(r,"slide.in.after"),sc.engine.ActionsManager.Run(e.actions,e,"slide.in.after")])}(e,n,o)}(pc.actived,t))}async function cc(e,t){const{position:o,rotation:n,scale:a,actions:s=[],visible:r=!1,...l}=e.states[t];o&&e.position.copy(o),n&&e.rotation.setFromVector3(n,"XYZ"),a&&e.scale.copy(a);const i=Object.keys(l).map(async t=>{const o=t.split("."),n=l[t];let a=o[0],s=e;try{for(let e=0;e<o.length-1;e++)s=s[o[e]],a=o[e+1];return s[a]=await sc.engine.getFactory().CreateValue(n),{success:!0,key:t}}catch(e){return console.warn(e),{success:!1,key:t,error:e}}});await Promise.all(i),e.visible=r,e.state=e.states[t]||{model:e}}function dc(e,t){e.visible=!1}const pc=(0,s.reactive)({load:async function(e){pc.children.length=0;const t=e.sort((e,t)=>e.index-t.index);for(let e=0;e<t.length;e++){const o={name:"",camera:{path:null},actions:[],index:e,props:{},background:null,environment:{},...t[e]};pc.children.push(o)}Qi.on("remove",e=>{const t=e.join(".");sc.engine.Project.Camera?.path===t&&sc.engine.Project.ResetCamera();for(let e=0;e<pc.children.length;e++){const o=pc.children[e];o.camera?.path===t&&(o.camera.path=null,lc(o))}})},add:async function(e){const t=`sl${Date.now()}`,o={index:pc.children.length,name:t,uid:t,background:null,environment:{},camera:{path:null},props:{},actions:[],...e};return pc.children.push(o),await lc(o),rc.emit("add",o.uid),o},remove:async function(e){console.log("remove");let t=e||pc.actived.uid;const o=pc.children.findIndex(e=>e.uid===t);if(o>=0){pc.actived.uid===t&&(0===o?await ic(1):await ic(o-1)),pc.children.splice(o,1),await cn.deleteItem("slides",t);const e=pc.children.find(e=>e.next===t);e&&pc.children.length>=o&&(e.next=pc.children[o].uid),rc.emit("remove",t)}},save:lc,actived:null,children:[],GoToNext(){pc.next()},goto:ic,next(){const e=pc.children.findIndex(e=>e.uid===pc.actived.uid);e>=pc.children.length-1||pc.goto(e+1)},back(){const e=pc.children.findIndex(e=>e.uid===pc.actived.uid);0!==e&&pc.goto(e-1)},on:rc.on.bind(rc),off:rc.off.bind(rc)});sc.On("init",()=>{window.vue.component("CameraSelector",ac),sc.menu.hierarhy.list.push({icon:"dvr",tooltip:"Slide options",handler:()=>{var e;e=pc.actived,sc.modal.open({header:{value:"Slide options",handler:()=>{sc.modal.close()}},content:{component:"ModalForm",props:(0,s.reactive)({model:e,properties:[{label:"Name",prop:"name",component:"LabelEdit"},{label:"Camera",prop:"camera.path",component:"CameraSelector"}],head:{title:""}}),events:{"update:model":(t,o)=>{lc(e)},"update:camera.path":t=>{if(console.log(t),e.camera.path!==sc.engine.getManager().Camera?.path){if(!t)return void sc.engine.getManager().ResetCamera();const e=t.split("."),o=Qi.find(e);sc.engine.getManager().SetCamera(o),o.updateProjectionMatrix()}}}},footer:{buttons:(0,s.reactive)([{label:"Close",class:"primary",handler:async()=>{sc.modal.close()}}])}})}})});const uc=pc;let mc;const hc={},fc=[],vc=[],gc=(0,s.reactive)({ready:!1,getAssetsManager:()=>hc.AssetsManager,getSlidesManager:()=>hc.SlidesManager,getFactory:()=>hc.Factory,getManager:e=>hc[e]||mc,async load(){console.log("Engine load");const{AssetsManager:e,CssManager:t,MouseManager:o,ActionsManager:n,Project:a,Factory:s}=Ri.getMod("engine");hc.AssetsManager=e,hc.SlidesManager=uc,hc.Factory=s,hc.MouseManager=o,hc.ActionsManager=n,hc.CssManager=t,hc.Project=mc=a,console.log("Engine load complete"),console.log(vc);const r=[];for(let e=0;e<vc.length;e++)r.push(vc[e](mc));vc.length=0,await Promise.all(r)},async start(){gc.ready=!0;const e=[];for(let t=0;t<fc.length;t++)e.push(fc[t](mc));return fc.length=0,await Promise.all(e),console.log(mc),mc},onload(e){fc.push(e)},onInit(e){vc.push(e)}}),yc=new Proxy(gc,{get:(e,t)=>t in e?e[t]:hc[t]}),bc={class:"blocks-container"},kc={class:"blockslabel"},wc={key:0,class:"blocks"},Ec={class:"blocklabel"},_c={class:"blocktitle"},Sc=["onClick"],Nc={class:"actionview"},Vc={key:0,class:"actionrow"},Cc={key:1,class:"actionform"},Bc={class:"actionline",style:{display:"flex","justify-content":"center"}},$c={key:2,class:"actionline",style:{display:"flex","justify-content":"center"}},xc={name:"ActionIspector",provide(){return{action:this.action}},props:{value:{type:Object,default:{uid:"",hook:""}},isState:{type:Boolean,default:!1},target:{type:Object},state:{type:Object}},data:()=>({expanded:!1,played:!1}),computed:{action(){return this.$app.actions.list.find(e=>e.uid===this.value.uid)}},methods:{onUpdate(e,t){const o=e.split(".");let n=this.action;for(let e=0;e<o.length-1;e++){const t=o[e];n[t]||(n[t]={}),n=n[t]}n[o[o.length-1]]=t,this.$emit("update:action",{[e]:t})},async remove(){this.$app.modal.confirmReq((0,s.reactive)({title:`Remove action '${this.action.name}' ?`,text:"",answer:"",template:""}),[{label:"YES",class:"primary",callback:e=>{this.$emit("remove")}},{label:"NO",class:"secondary",callback:e=>{}}])},async play(){await this.$app.engine.getManager("ActionsManager").Call(this.action,this.target)},reset(){}}},Dc=(0,B.A)(xc,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Nc,[r.action?((0,s.openBlock)(),(0,s.createElementBlock)("div",Vc,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"label",onClick:t[0]||(t[0]=e=>a.expanded=!a.expanded)},[(0,s.createElementVNode)("span",null,(0,s.toDisplayString)(a.expanded?"▼":"▶"),1),(0,s.createTextVNode)(" "+(0,s.toDisplayString)(r.action.name||r.action.uid),1)])),[[i,r.action.type]]),(0,s.createElementVNode)("button",{onClick:t[1]||(t[1]=(...e)=>r.remove&&r.remove(...e))},[(0,s.createVNode)(l,{value:"bin",size:"1em"})])])):(0,s.createCommentVNode)("v-if",!0),r.action?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Cc,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(r.action.type),{onUpdate:r.onUpdate,onPlay:r.play,onReset:r.reset,options:{inspector:!0,expanded:a.expanded},name:r.action.name},{inspector:(0,s.withCtx)(()=>[(0,s.createElementVNode)("div",Bc,[(0,s.createElementVNode)("button",{class:"square",onClick:t[2]||(t[2]=(...e)=>r.play&&r.play(...e))},[(0,s.createVNode)(l,{value:a.played?"stop2":"play3",size:"1.2em"},null,8,["value"])]),(0,s.createCommentVNode)(' <button @click="reset">\r\n                            <icon value="undo" size="1em"></icon>\r\n                        </button> ')])]),_:1},40,["onUpdate","onPlay","onReset","options","name"]))],512)),[[s.vShow,a.expanded]]):(0,s.createCommentVNode)("v-if",!0),a.expanded?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",$c,[(0,s.createCommentVNode)(' <button class="square" @click="play">\r\n                <icon :value="played ? \'stop2\' : \'play3\'" size="1em"></icon>\r\n            </button>\r\n            <button class="square" @click="reset">\r\n                <icon value="undo" size="1em"></icon>\r\n            </button> ')]))])}]]),Tc=["onMouseover","onClick"],Ic={props:["items","x","y"],data:()=>({isActive:!1,highlightedIndex:null}),methods:{highlight(e){this.highlightedIndex=e},deactivate(){this.highlightedIndex=null,this.$emit("select",null)},selectItem(e){this.$emit("select",e)}}},Ac=(0,B.A)(Ic,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",{class:"menu",onMouseleave:t[0]||(t[0]=(...e)=>r.deactivate&&r.deactivate(...e)),style:(0,s.normalizeStyle)({top:o.y-3+"px",left:o.x+"px"})},[(0,s.createElementVNode)("ul",null,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.items,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("li",{key:t,onMouseover:e=>r.highlight(t),onClick:t=>r.selectItem(e),class:(0,s.normalizeClass)({highlighted:a.highlightedIndex===t})},(0,s.toDisplayString)(e),43,Tc))),128))])],36)}],["__scopeId","data-v-56d3c090"]]),Mc={name:"ActionsIspector",props:{modelValue:{type:Object,default:{}},value:{type:Object,default:{data:{}}},target:{type:Object,default:null},property:{type:Object}},computed:{eventTypes(){return this.$app.events.types},actions(){return this.$app.actions},hooks(){return this.$app.actions.hooks.filter(e=>!this.getActionsHooks().includes(e))}},mounted(){},methods:{async addEvent(e){this.events.length=0,this.events.push(...["create.on","enable.on","disable.on","mouse.over","mouse.out"].filter(e=>!this.getActionsHooks().includes(e))),this.menuX=e.clientX,this.menuY=e.clientY,this.listshow=!0,await this.$nextTick();const t=this.$refs.hooksList.$el.offsetHeight,o=window.innerHeight;this.menuY+t>o&&(this.menuY=o-t-10)},onSelectEvent(e){this.listshow=!1,e&&this.openActionsList(e)},openActionsList(e){this.$app.actions.showLib(async t=>{t&&(this.target.actions.push({uid:t.uid,hook:e}),this.$emit("save"))})},onRemove(e,t){const o=this.target.actions.findIndex(o=>o.uid===e.uid&&o.hook===t);o>=0&&(this.target.actions.splice(o,1),this.$emit("update:target",null,null))},getActionsHooks(){return[...new Set(this.target.actions.map(e=>e.hook))]},async reset(e){},async play(e){},onEdit(e,t){this.$app.actions.save({uid:e.uid,...t})}},data:()=>({actLibShow:!1,actListShow:!1,actsButtons:[],regActType:null,selectedActionType:null,regbusy:!1,selectdAction:null,eventType:"",listshow:!1,show:!0,events:[],menuX:0,menuY:0,played:!1}),components:{Action:Dc,HooksList:Ac}},Oc=(0,B.A)(Mc,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveComponent)("Action"),c=(0,s.resolveComponent)("HooksList");return(0,s.openBlock)(),(0,s.createElementBlock)(s.Fragment,null,[(0,s.createCommentVNode)("Actions View"),(0,s.createElementVNode)("div",bc,[(0,s.createElementVNode)("div",kc,[(0,s.createElementVNode)("div",{onClick:t[0]||(t[0]=e=>a.show=!a.show)},"Add : "),(0,s.createElementVNode)("button",{onClick:t[1]||(t[1]=(...e)=>r.addEvent&&r.addEvent(...e))},[(0,s.createVNode)(l,{value:"plus",size:"0.9em"})])]),a.show?((0,s.openBlock)(),(0,s.createElementBlock)("div",wc,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.getActionsHooks(),(e,n)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:n,class:"block"},[(0,s.createElementVNode)("div",Ec,[(0,s.createElementVNode)("div",_c,(0,s.toDisplayString)(e),1),(0,s.createCommentVNode)("play block for all actions in hook"),t[2]||(t[2]=(0,s.createElementVNode)("div",{style:{display:"flex","justify-content":"center",gap:"5px"}},[(0,s.createCommentVNode)('LATER <button class="square" @click="play(eventType)">\r\n                            <icon :value="played ? \'stop2\' : \'play3\'" size="1em"></icon>\r\n                        </button>\r\n                        <button class="square" @click="reset(eventType)">\r\n                            <icon value="undo" size="1em"></icon>\r\n                        </button> ')],-1)),(0,s.createElementVNode)("button",{onClick:t=>r.openActionsList(e)},[(0,s.createVNode)(l,{value:"plus",size:"0.9em"})],8,Sc)]),(0,s.createCommentVNode)("Models actions"),(0,s.createCommentVNode)(' <Action :value="action" :target="value"\r\n                    v-for="(action, index) in value.model.data.actions.filter(a => a.hook === eventType)"\r\n                    :ref="`action${action.uid}`" :key="index"\r\n                    @update:action="onEdit(action,$event)">\r\n                </Action> '),(0,s.createCommentVNode)("States actions"),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(o.target.actions.filter(t=>t.hook===e),(t,n)=>((0,s.openBlock)(),(0,s.createBlock)(i,{value:t,target:o.value,state:o.target,ref_for:!0,ref:`action${t.uid}`,key:n,"onUpdate:action":e=>r.onEdit(t,e),onRemove:o=>r.onRemove(t,e)},null,8,["value","target","state","onUpdate:action","onRemove"]))),128))]))),128))])):(0,s.createCommentVNode)("v-if",!0),a.listshow?((0,s.openBlock)(),(0,s.createBlock)(s.Teleport,{key:1,to:"body"},[(0,s.createVNode)(c,{ref:"hooksList",x:a.menuX,y:a.menuY,items:r.hooks,onSelect:r.onSelectEvent},null,8,["x","y","items","onSelect"])])):(0,s.createCommentVNode)("v-if",!0)]),(0,s.createCommentVNode)(" // Actions View")],2112)}]]),jc={class:"form-container"},Pc={class:"form-column"},Lc={class:"row"},Rc={class:"rowlabel"},Fc={class:"rowvalue"},Uc={key:0},zc=["value"],Hc={key:0,class:"row"},qc={class:"rowlabel"},Gc={class:"rowvalue"},Wc=["value"],Kc={key:1},Yc={class:"row"},Jc={class:"rowlabel"},Xc={class:"rowvalue"},Qc={key:1,class:"row"},Zc={class:"rowlabel"},ed={class:"rowvalue"},td={key:2,class:"bottomform"},od={key:0},nd={name:"ActionLibSelect",provide(){return{action:(0,s.computed)(()=>this.selected)}},data:()=>({selectedGroup:null}),props:{selected:{type:Object},progress:{type:Number}},computed:{types(){return this.$app.actions.library.filter(e=>e.group===this.selectedGroup)},groups(){return this.$app.actions.groups},selectedType(){return this.$app.actions.library.find(e=>e.component===this.selected.type)},selectType:{get(){return this.selected.type},set(e){this.$emit("change:type",e)}}},methods:{onUpdate(e,t){this.$emit("edit",e,t)},end(){this.$emit("edit","name",this.$refs.nameeditor.endEdit()),this.$emit("edit","url",this.$refs.urleditor.endEdit())}},mounted(){this.selectedGroup=this.selected.group}},ad=(0,B.A)(nd,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("LabelEdit"),i=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",jc,[(0,s.createElementVNode)("div",Pc,[(0,s.createElementVNode)("div",Lc,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Rc,[...t[4]||(t[4]=[(0,s.createTextVNode)("$$Group:",-1)])])),[[i]]),(0,s.createElementVNode)("div",Fc,[o.selected.uid?((0,s.openBlock)(),(0,s.createElementBlock)("div",Uc,(0,s.toDisplayString)(o.selected.group),1)):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("select",{key:1,style:{width:"100%"},"onUpdate:modelValue":t[0]||(t[0]=e=>a.selectedGroup=e)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.groups,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{key:t,value:e},(0,s.toDisplayString)(e),9,zc))),128))],512)),[[s.vModelSelect,a.selectedGroup]])])]),a.selectedGroup?((0,s.openBlock)(),(0,s.createElementBlock)("div",Hc,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",qc,[...t[5]||(t[5]=[(0,s.createTextVNode)("$$Type:",-1)])])),[[i]]),(0,s.createElementVNode)("div",Gc,[o.selected.uid?((0,s.openBlock)(),(0,s.createElementBlock)("div",Kc,(0,s.toDisplayString)(r.selectedType.name),1)):(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("select",{key:0,style:{width:"100%"},"onUpdate:modelValue":t[1]||(t[1]=e=>r.selectType=e)},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.types,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{key:t,value:e.component},(0,s.toDisplayString)(e.name),9,Wc))),128))],512)),[[s.vModelSelect,r.selectType]])])])):(0,s.createCommentVNode)("v-if",!0),(0,s.createElementVNode)("div",Yc,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Jc,[...t[6]||(t[6]=[(0,s.createTextVNode)("$$Name:",-1)])])),[[i]]),(0,s.createElementVNode)("div",Xc,[(0,s.createVNode)(l,{style:{width:"100%"},ref:"nameeditor","onUpdate:modelValue":t[2]||(t[2]=t=>e.$emit("edit","name",t)),modelValue:o.selected.name},null,8,["modelValue"])])]),o.selected.description?((0,s.openBlock)(),(0,s.createElementBlock)("div",Qc,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Zc,[...t[7]||(t[7]=[(0,s.createTextVNode)("$$Description:",-1)])])),[[i]]),(0,s.createElementVNode)("div",ed,(0,s.toDisplayString)(o.selected.description),1)])):(0,s.createCommentVNode)("v-if",!0),((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(o.selected.type),{class:"vertflex",onUpdate:r.onUpdate},null,40,["onUpdate"])),t[9]||(t[9]=(0,s.createElementVNode)("span",{style:{flex:"1"}},null,-1)),o.selected.uid?(0,s.createCommentVNode)("v-if",!0):((0,s.openBlock)(),(0,s.createElementBlock)("div",td,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("button",{onClick:t[3]||(t[3]=t=>e.$emit("save")),class:"primary"},[...t[8]||(t[8]=[(0,s.createTextVNode)("SAVE",-1)])])),[[i,"buttons.Save"]])]))]),o.progress>0?((0,s.openBlock)(),(0,s.createElementBlock)("div",od,(0,s.toDisplayString)(o.progress),1)):(0,s.createCommentVNode)("v-if",!0)])}]]),sd={class:"itemElement"},rd={class:"itemrow"},ld={props:{item:{type:Object}}},id=(0,B.A)(ld,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",sd,[(0,s.createElementVNode)("div",rd,(0,s.toDisplayString)(o.item.name),1)])}]]),cd=Eo.default.default||Eo.default;let dd;function pd(e){const t=(0,s.reactive)({selected:null,list:md.list}),o={label:"Close",class:"secondary",handler:async()=>{t.selected=null,Bi.close(),e&&e()}},n=(0,s.reactive)({label:"Create",class:"primary",handler:async()=>{const e=md.library[0];t.selected={type:e.component,group:e.group,targets:["*"],description:e.description,...e.template}}}),a={label:"Delete",class:"additional",hidden:(0,s.computed)(()=>!t.selected||!t.selected.uid),handler:async()=>{const e=md.list.findIndex(e=>e===t.selected);e>=0&&md.list.splice(e,1),async function(e){await cn.deleteItem("actions",e)}(t.selected.uid),t.selected=null}},r={label:"Select",class:"additional",hidden:(0,s.computed)(()=>!t.selected||!t.selected.uid||!e),handler:async()=>{e(t.selected),Bi.close()}},l=(0,s.reactive)([r,n,a,o]);Bi.open({header:{value:e?"Select an action":"Action Library",handler:()=>{Bi.close()}},content:{component:"ItemsLib",props:t,events:{selected:e=>{e.uid&&(t.selected=e)}},slots:{item:{component:"ActionItem"},edit:{component:"ActionLibSelect",props:{selected:t.selected},events:{"change:type":e=>{const o=md.library.find(t=>t.component===e);t.selected={...o.template,type:o.component,group:o.type,description:o.description}},save:async()=>{const e=md.library.find(e=>e.component===t.selected.type);if(e.check){if(!await e.check(t.selected))return void Ni.add({message:"Неверные параметры"})}else Object.keys(e.template).forEach(o=>{o in t.selected||(t.selected[o]=JSON.parse(JSON.stringify(e.template[o])))});t.selected.uid=`${t.selected.type}${Date.now()}`,await ud(t.selected),await dd.Add(t.selected)},edit:(e,o)=>{const n=e.split(".");let a=t.selected;for(let e=0;e<n.length-1;e++){const t=n[e];a[t]||(a[t]={}),a=a[t]}a[n[n.length-1]]=o,ud(t.selected)}}}}},footer:{buttons:l}})}async function ud(e){e.uid&&await cn.upsertItemProperties("actions",e.uid,JSON.parse(JSON.stringify({id:e.uid,...e})))}const md=(0,s.reactive)({init:async function(e){dd||(dd=yc.ActionsManager,await dd.Init((0,s.reactive)(e)),dd.on("add",e=>{md.list.push(e)}),dd.on("remove",e=>{}),dd.on("register",e=>{}),md.list.push(...dd.Actions))},register:function(e){console.log(e),md.library.push(e)},save:ud,showLib:pd,exportData:async function(){return await cn.getAllItems("actions")},removeFrom:async function(e,{hook:t,uid:o}){},hooks:["enable.on","slide.in.before","slide.in","slide.in.after","slide.out.before","slide.out","slide.out.after","disable.on","mouse.in","mouse.click","mouse.out"],list:[],library:[],get groups(){const e=md.library.reduce((e,t)=>(e.includes(t.group)||e.push(t.group),e),[]);return console.log(e),e},get values(){return Object.values(md.list)}});cd.On("init",()=>{window.vue.component("ActionsList",Oc),window.vue.component("ActionLibSelect",ad),window.vue.component("ActionItem",id),cd.menu.hierarhy.list.push({icon:"dice",tooltip:"Actions",handler:pd}),cd.inspector.addToModels(["Object3D"],[{label:"Models actions",readonly:!0,content:{prop:"actions",component:"ActionsList",state:!1}},{label:"States actions",readonly:!0,content:{prop:"actions",component:"ActionsList",state:!0}}])});const hd=md,fd={class:"assetblock"},vd={name:"AssetView",data:()=>({cmps:{hdr:"assethdr"}}),props:{value:{type:Object},modelValue:{type:String},property:{type:Object}},methods:{onAssetChange(e){e&&this.$emit("update:value",e.uid)},cleanProp(){delete this.value[this.property.prop],this.$emit("update:value",null)}},computed:{val(){return this.value[this.property.prop]},asset(){return this.val?this.$app.assets.list.find(e=>e.uid===this.val):null}},components:{assethdr:Ae}},gd=(0,B.A)(vd,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("icon"),i=(0,s.resolveDirective)("tooltip");return(0,s.openBlock)(),(0,s.createElementBlock)("div",fd,[((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(a.cmps[o.property.type]),{onSetasset:r.onAssetChange,asset:r.asset},null,40,["onSetasset","asset"])),r.asset?(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,onClick:r.cleanProp,class:"icon",value:"bin",size:"1em"},null,8,["onClick"])),[[i,"Удалить"]]):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-5867b901"]]),yd={class:"image-container"},bd={ref:"canva"},kd={class:"selector"},wd={props:{modelValue:{type:Object,default:null},value:{type:Object},label:{type:String,default:""},tooltip:{type:String,default:""},selectable:{type:Boolean}},data:()=>({txtr:null}),watch:{value(e){this.redraw()},modelValue(e){this.redraw()}},methods:{onUpdate({result:e,file:t}){console.log(e);const o=new Blob([e],{type:t.type}),n=URL.createObjectURL(o);this.txtr=n;const a=(new THREE.TextureLoader).load(n,()=>{URL.revokeObjectURL(n)});this.$emit("update:modelValue",a.image),this.$app.storage.writeFile("texture.png",e)}},methods:{redraw(){const e=this.$refs.canva,t=e.getContext("2d");if(t.clearRect(0,0,e.width,e.height),this.modelValue)try{const o=this.modelValue.image;e.width=o.width,e.height=o.height,t.drawImage(o,0,0)}catch(e){}}},mounted(){console.log(this.modelValue,this.value),this.redraw()}},Ed=(0,B.A)(wd,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",yd,[(0,s.createElementVNode)("canvas",bd,null,512),(0,s.createElementVNode)("div",kd,[(0,s.createElementVNode)("button",{class:"btn",onClick:t[0]||(t[0]=t=>e.$emit("select",o.value))},"SELECT")])])}]]),_d={class:"form-container"},Sd={class:"info"},Nd={class:"row"},Vd={class:"rowlabel"},Cd={class:"rowvalue"},Bd={class:"row"},$d={class:"rowlabel"},xd={class:"rowvalue"},Dd=["value"],Td=["value"],Id={key:1},Ad={class:"rowlabel"},Md={key:0},Od={name:"AssetEdit",props:{selected:{type:Object,default:{name:"-"}},progress:{type:Number}},computed:{types(){return this.$app.assets.types},inspector(){return this.$app.inspector.blocksFor(["asset",this.selected.type]).filter(e=>!e.inspectorOnly)}},methods:{updateInspector(e){this.inspector=this.$app.inspector.blocksFor(this.selected.getTypes())},onChange(e,t){console.log(e,t),this.$emit("edit",e,t)},end(){this.$emit("edit","name",this.$refs.nameeditor.endEdit()),this.$emit("edit","url",this.$refs.urleditor.endEdit())},async onComponentUpdate(e,t){if(t.onupdate)await t.onupdate(this.selected,e,t,()=>{this.$emit("edit",t.prop,e)});else{const o=t.prop.split(".");let n=o[0],a=this.selected;for(let e=0;e<o.length-1;e++)a=a[o[e]],n=o[e+1];a[n]=e,this.$emit("edit",t.prop,e)}},onComponentChange(){_saveHandler(this.selected)}}},jd=(0,B.A)(Od,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("LabelEdit"),i=(0,s.resolveDirective)("translate");return(0,s.openBlock)(),(0,s.createElementBlock)("div",_d,[(0,s.createElementVNode)("div",Sd,[(0,s.createElementVNode)("div",Nd,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Vd,[...t[3]||(t[3]=[(0,s.createTextVNode)("$$Name:",-1)])])),[[i]]),(0,s.createElementVNode)("div",Cd,[(0,s.createVNode)(l,{style:{width:"100%"},ref:"nameeditor","onUpdate:modelValue":[t[0]||(t[0]=e=>r.onChange("name",e)),t[1]||(t[1]=e=>o.selected.name=e)],modelValue:o.selected.name},null,8,["modelValue"])])]),(0,s.createElementVNode)("div",Bd,[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",$d,[...t[4]||(t[4]=[(0,s.createTextVNode)("$$Type:",-1)])])),[[i]]),(0,s.createElementVNode)("div",xd,[o.selected.uid?((0,s.openBlock)(),(0,s.createElementBlock)("div",Id,(0,s.toDisplayString)(o.selected.type),1)):((0,s.openBlock)(),(0,s.createElementBlock)("select",{key:0,class:"typeslist",value:o.selected.type,onChange:t[2]||(t[2]=e=>r.onChange("type",e.target.value))},[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.types,e=>((0,s.openBlock)(),(0,s.createElementBlock)("option",{value:e},(0,s.toDisplayString)(e),9,Td))),256))],40,Dd))])]),(0,s.createCommentVNode)(' <div class="row">\r\n                <div class="rowlabel">URL</div>\r\n                <div class="rowvalue">\r\n                    <LabelEdit style="width: 100%;" ref="urleditor" @update:value="onChange(\'url\', $event)"\r\n                        :value="selected.url">\r\n                    </LabelEdit>\r\n                </div>\r\n            </div> '),((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(r.inspector,(e,t)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:t,class:"row"},[(0,s.withDirectives)(((0,s.openBlock)(),(0,s.createElementBlock)("div",Ad,[(0,s.createTextVNode)((0,s.toDisplayString)(e.label),1)])),[[i]]),e.content?((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.content.component),(0,s.mergeProps)({key:0,class:"rowvalue",value:o.selected,modelValue:o.selected[e.content.prop],"onUpdate:modelValue":[t=>o.selected[e.content.prop]=t,t=>r.onComponentUpdate(t,e.content)],property:e.content},{ref_for:!0},e.content.props,{onModify:t=>r.onComponentChange(t,e.content)}),null,16,["value","modelValue","onUpdate:modelValue","property","onModify"])):(0,s.createCommentVNode)("v-if",!0),e.head?((0,s.openBlock)(),(0,s.createBlock)((0,s.resolveDynamicComponent)(e.head.component),(0,s.mergeProps)({key:1,class:"rowvalue",value:o.selected,modelValue:o.selected[e.head.prop],"onUpdate:modelValue":[t=>o.selected[e.head.prop]=t,t=>r.onComponentUpdate(t,e.head)],property:e.head},{ref_for:!0},e.head.props,{onModify:t=>r.onComponentChange(t,e.head)}),null,16,["value","modelValue","onUpdate:modelValue","property","onModify"])):(0,s.createCommentVNode)("v-if",!0)]))),128)),t[5]||(t[5]=(0,s.createElementVNode)("div",null,null,-1))]),(0,s.createElementVNode)("div",null,[o.progress>0?((0,s.openBlock)(),(0,s.createElementBlock)("div",Md,(0,s.toDisplayString)(o.progress),1)):(0,s.createCommentVNode)("v-if",!0)])])}],["__scopeId","data-v-d1f2452c"]]),Pd={class:"moditem"},Ld={class:"title"},Rd={class:"image"},Fd=["src"],Ud={name:"AssetItem",props:["item"]},zd=(0,B.A)(Ud,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Pd,[(0,s.createElementVNode)("div",Ld,(0,s.toDisplayString)(o.item.name),1),(0,s.createElementVNode)("div",Rd,[o.item.images?((0,s.openBlock)(),(0,s.createElementBlock)("img",{key:0,src:o.item.images[0].url},null,8,Fd)):(0,s.createCommentVNode)("v-if",!0)])])}],["__scopeId","data-v-e24059a8"]]),Hd={class:"form-container"},qd={class:"info"},Gd={class:"row"},Wd={class:"rowvalue"},Kd={class:"line"},Yd=["src"],Jd={key:0},Xd={name:"AssetView",props:{selected:{type:Object,default:{name:"-"}},progress:{type:Number}},computed:{types(){return this.$app.assets.types},inspector(){return this.$app.inspector.blocksFor(["asset",this.selected.type]).filter(e=>!e.inspectorOnly)}},methods:{updateInspector(e){this.inspector=this.$app.inspector.blocksFor(this.selected.getTypes())},onChange(e,t){this.$emit("edit",e,t)},end(){this.$emit("edit","name",this.$refs.nameeditor.endEdit()),this.$emit("edit","url",this.$refs.urleditor.endEdit())},async onComponentUpdate(e,t){if(t.onupdate)await t.onupdate(this.selected,e,t,()=>{this.$emit("edit",t.prop,e)});else{const o=t.prop.split(".");let n=o[0],a=this.selected;for(let e=0;e<o.length-1;e++)a=a[o[e]],n=o[e+1];a[n]=e,this.$emit("edit",t.prop,e)}},onComponentChange(){_saveHandler(this.selected)}}},Qd=(0,B.A)(Xd,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",Hd,[(0,s.createElementVNode)("div",qd,[(0,s.createElementVNode)("div",Gd,[t[0]||(t[0]=(0,s.createElementVNode)("div",{class:"rowlabel"},"Name",-1)),(0,s.createElementVNode)("div",Wd,(0,s.toDisplayString)(o.selected.name),1)]),(0,s.createElementVNode)("div",Kd,[(0,s.createElementVNode)("img",{src:o.selected.images[0].url},null,8,Yd)])]),(0,s.createElementVNode)("div",null,[o.progress>0?((0,s.openBlock)(),(0,s.createElementBlock)("div",Jd,(0,s.toDisplayString)(o.progress),1)):(0,s.createCommentVNode)("v-if",!0)])])}],["__scopeId","data-v-321414c5"]]),Zd=Eo.default.default||Eo.default,ep={asset:[{label:"URL:",content:{prop:"url",component:"LabelEdit",onupdate(e,t,o,n){console.log(e),np.Update(e,t,o)}}},{label:"$$Clone:",head:{component:"BoolEdit",prop:"clone",async onupdate(e,t,o,n){await np.Update(e,t,o)}}}],model:[{label:"$$Shadow:",content:{component:"ShadowEdit",prop:"shadow",onupdate:async(e,t,o,n)=>{await np.Update(e,t,o)}}},{label:"$$Environment map",inspectorOnly:!0,content:{component:"AssetSelector",prop:"envMap",type:"hdr",onupdate:async(e,t,o,n)=>{await np.Update(e,t,o)}}}],image:[{label:"Image",content:{inspectorOnly:!0,prop:"img",component:"ImageView",props:{acceptedTypes:"image/*",selectable:!1},async onupdate(e,t,o){console.log(t),e.img=t}}}],hdr:[]},tp={model:()=>!0},op={model:"codepen",image:"image",hdr:"loop2",video:"film"};let np;function ap(e=[]){return console.log(e),dp.list.filter(t=>0===e.length||e.includes(t.type)).map(e=>({...e.data}))}async function sp(e){e.uid=`asset_${Date.now()}`;const t=np.Add(e);await t.load(e=>{console.log(`${t.uid}:${e}%`)}),t.on("update",()=>{rp(t)}),dp.list.push(t),await cn.addItem("assets",JSON.parse(JSON.stringify(e)))}async function rp(e){console.log("Save asset");try{if(!e.uid)return;await cn.updateItem("assets",JSON.parse(JSON.stringify({id:e.uid,...e.data})))}catch(e){console.error("Error saving asset:",e),Zd.toasts.add({message:"Error saving asset"})}}async function lp(e){switch(e.type){case"model":if(Zd.models.children.some(t=>t.isUseAsset&&t.isUseAsset(e.uid)))return Zd.toasts.add({message:"Cannot delete, asset in use"}),!1;break;case"hdr":if(dp.list.find(t=>t.data.envMap===e.uid))return Zd.toasts.add({message:"Cannot delete, asset in use"}),!1}const t=dp.list.findIndex(t=>t.uid===e.uid);return t>=0&&(dp.list.splice(t,1),np.Remove(e.uid),await cn.deleteItem("assets",e.uid)),!0}function ip(e,t=!0){return new Promise(o=>{const n=(0,s.reactive)({selected:null,list:ap(e),icons:op}),a=(0,s.reactive)([{label:"Select",class:"primary",hidden:(0,s.computed)(()=>!t||!n.selected),handler:async()=>{Bi.close(),o(n.selected)}},{label:"Remove",class:"additional",hidden:(0,s.computed)(()=>!n.selected?.uid),handler:async()=>{lp(n.selected)&&(n.selected=null,n.list=ap(e))}},{label:"Save",class:"primary",hidden:(0,s.computed)(()=>!n.selected||n.selected.uid||n.busy),handler:async()=>{if(!tp[n.selected.type]||await tp[n.selected.type](n.selected)){Zd.toasts.add({message:"Start load asset"});try{n.selected=await sp(n.selected)}catch(e){return Zd.toasts.add({message:e.message}),void(n.selected.uid=null)}n.list=ap(e),Zd.toasts.add({message:"Asset saved"})}}},{label:"Create",class:"secondary",handler:async()=>{n.selected={name:"",type:dp.types[0],url:""}}},{label:"Close",class:"additional",handler:async()=>{Bi.close(),o()}}]);Bi.open({header:{value:t?"Select asset":"Project assets",handler:()=>{Bi.close()}},content:{component:"ItemsLib",props:n,events:{selected:e=>{n.selected=e}},slots:{edit:{component:"AssetEdit",props:{selected:n.selected},events:{edit:(e,t)=>{n.selected[e]=t,n.selected.uid&&rp({data:n.selected})}}}}},footer:{buttons:a}})})}async function cp(){console.log("openAssetsLib");const e=[{label:"Name",prop:"name",component:"Label"}],t={model:[{label:"Preview",component:"ModelPreview",prop:"url",props:{image:"preview"}}],hdr:[],image:[],video:[]},o=(0,s.reactive)({selected:null,selectedIndex:-1,list:[],busy:!1,styles:{item:{width:"128px",height:"128px"}},icons:op,head:{title:""},rows:[]});async function n(e){o.busy=!0;const t=await fetch("https://s3.eu-west-1.amazonaws.com/3dbuilder.reneos.com/assets/assets.json",{cache:"no-store",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}}),n=await t.json();o.list=n.map(e=>({...e,name:e.name||e.uid})).filter(t=>!e||t.name.includes(e)),o.busy=!1}const a={label:"Add to project",class:"secondary",hidden:(0,s.computed)(()=>o.processed||o.selectedIndex<0||!o.canadd),handler:async()=>{o.processed=!0;try{await sp({...o.selected})}catch(e){return e.isExistError?Zd.toasts.add({message:e.message}):Zd.toasts.add({message:"Error adding asset"}),void(o.processed=!1)}o.canadd=-1===dp.list.findIndex(e=>e.uid===o.selected.uid),Zd.toasts.add({message:"The asset has been added to project."}),o.processed=!1}},r={label:"Close",class:"primary",handler:async()=>{Bi.close()}},l=(0,s.reactive)([a,r]);Bi.open({header:{value:"Global assets",handler:()=>{Bi.close()}},content:{component:"ItemsLib",props:o,events:{open:()=>{n()},selected:(n,a)=>{o.selected=n,o.selectedIndex=a,o.rows=[...e,...t[o.selected.type]],o.canadd=-1===dp.list.findIndex(e=>e.uid===o.selected.uid)}},slots:{head:{component:"SearchFilter",events:{search(e){n(e)},change(e){e||n()}}},item:{component:"AssetItem"}}},footer:{buttons:l}})}const dp=(0,s.reactive)({init:async function(e,t){console.log("Init assets"),np=yc.getManager("AssetsManager"),await np.Init(e,t);const o=Array.from(np.Assets.values());o.forEach(e=>{e.on("update",()=>{rp(e)})}),dp.list.push(...o)},create:sp,update:async function(e,t,o){await np.Update(e,t,o)},save:rp,selectAsset:ip,editAsset:function(e){const t=(0,s.reactive)({current:e}),o=(0,s.reactive)([{label:"Save",class:"secondary",handler:async()=>{e.uid?await rp({data:e}):await sp(e),Bi.close()}},{label:"Cancel",class:"primary",handler:async()=>{Bi.close()}}]);Bi.open({header:{value:"Select asset",handler:()=>{Bi.close()}},content:{component:"AssetEdit",props:t,events:{edit:(t,o)=>{e[t]=o}}},footer:{buttons:o}})},remove:lp,setAsset:function(e,t){e.assets||(e.assets=[]),e.assets.push({uid:t.uid}),Zd.engine.getFactory().AddAsset(e.uid,t)},openAssetsLib:cp,useAsset:function(e,t){const o=dp.list.find(t=>t.uid===e);o&&o.uses.add(t)},getAsset:function(e){return dp.list.find(t=>t.uid===e)},types:["model","hdr","image"],icons:op,list:[],exportData:async()=>Array.from(np.Assets.values()),get inspector(){return ep},getInspector:e=>ep[e]||[],getManager:()=>np});Zd.On("init",()=>{Zd.menu.hierarhy.list.push({icon:"cube",tooltip:"Assets",handler:()=>{ip([],!1)}}),Zd.menu.addMenu("app",{path:"app.list.libraries",icon:"",text:"Assets",link:"#",children:[{path:"app.list.libraries.assets",icon:"plug",text:"Assets",handler:async()=>{cp()}}]}),window.vue.component("AssetView",Qd),window.vue.component("AssetItem",zd),window.vue.component("AssetSelector",gd),window.vue.component("AssetEdit",jd),window.vue.component("AssetImage",Ed),Object.keys(ep).forEach(e=>{Zd.inspector.addToModels([e],ep[e])})});const pp=dp,up=(Boolean,Eo.default.default||Eo.default);let mp;const hp=(0,s.reactive)({init:async function(){console.log("app init"),mp=new cn("slider",["data","templates"]),await mp.openDatabase("slider")},save:async function(){const e={uid:"currproject",id:"currproject",actions:hd.exportData(),assets:pp.exportData(),elements:Elements.exportData()};return await cn.updateItem("projects",e),e.uid},saveData:function(e,t,o){return mp.upsertItemProperties(e,t,o)},readData:function(e,t){return mp.getItem(e,t)},GetDB:function(){return mp},draggedNode:null,ready:!1,cameras:[],get types(){return up.engine.getFactory().GetTypes()},user:{registered:!1,name:"Guest",options:{manual:"false"!==localStorage.getItem("options.manual")}},setPassword:async function(e){try{const{error:t,me:o}=await gqlc.Set({me:[{password:[{$args:{value:e}}]}]})}catch(e){up.toasts.add({message:"Error on change password"})}},async logout(){const e=await fetch("/auth/logout"),t=await e.json();console.log(t),window.location.reload()}});up.On("init",async()=>{up.menu.addMenu("app",{path:"app.list.help",icon:"question",text:"Help",link:"#",children:[{path:"app.list.help.channel",icon:"bullhorn",text:"Channel",handler:async()=>{window.open("https://t.me/webslider","_blank")}},{path:"app.list.help.chat",icon:"bubbles",text:"Chat",tooltip:"Discuss",handler:()=>{window.open("https://t.me/chatslider","_blank")}},{path:"app.list.help.docs",icon:"books",text:"Documents",tooltip:"Documents",handler:()=>{window.open("/docs/","_blank")}}]}),setTimeout(async()=>{},7e3)});const fp=hp,vp=(Eo.default.default||Eo.default,(0,s.reactive)({event(e,t){gtag("event",e,t)}})),gp=[],yp=[],bp={},kp={},wp={},Ep=(0,s.reactive)({ready:!1,cameras:[],blocksFor:e=>e.flatMap(e=>kp[e]||[]),handlers:wp,setHandler(e,t){wp[e]=t},getHandlers:()=>wp,addBlocks(e,t){Object.keys(_blocks).forEach(o=>{t(o)&&_blocks[o].push(...e)})},addToAssets(e,t){for(let o=0;o<e.length;o++){const n=e[o];"*"!==n?(bp[n]||(bp[n]=[]),bp[n].push(...t)):yp.push(...t)}},addToModels(e,t){for(let o=0;o<e.length;o++){const n=e[o];"*"!==n?(kp[n]||(kp[n]=[]),kp[n].push(...t)):gp.push(...t)}}}),_p=Eo.default.default||Eo.default;function Sp(e){ao.Transformer.setMode(e)}function Np(e,t){e.children??=[],(t.children||[]).forEach(t=>{let o=e.children.find(e=>e.path===t.path);o?Np(o,t):e.children.push(t)})}const Vp=(0,s.reactive)({addMenu:function(e,t){const o=Vp[e].list.find(e=>e.path===t.path);o?Np(o,t):Vp[e].list.push(t)},app:{list:[{path:"app.list.project",icon:"",text:"Project",link:"#"},{path:"app.list.libraries",icon:"",text:"Libraries",link:"#"},{path:"app.list.help",icon:"question",text:"Help",link:"#"}]},top:{list:[{icon:"sphere",hint:"Local/global space",handler:function(){ao.Transformer.setSpace("local"===ao.Transformer.space?"world":"local")}},{icon:"move",hint:"Moving",handler:Sp.bind(null,"translate")},{icon:"loop2",hint:"Rotation",handler:Sp.bind(null,"rotate")},{icon:"enlarge2",hint:"Scale",handler:Sp.bind(null,"scale")},{icon:"target",hint:"Zoom in on selected",handler:ao.FocusToSelect},{icon:"cross",hint:"Deselect",handler:()=>{_p.selection.select(null)}}],options:{size:"1.5em"}},hierarhy:{list:[],options:{}},tools:{list:[]}}),Cp=Vp,Bp={class:"importer"},$p={class:"row"},xp={class:"row"},Dp={class:"label"},Tp={class:"row"},Ip={class:"label"},Ap={class:"row"},Mp={class:"label"},Op={class:"row"},jp={class:"label"},Pp={name:"Importer",data:()=>({merge:!1,assets:new Set,models:new Set,slides:new Set,modules:new Set}),methods:{onChangeElements(e){e.isSelected?this.models.add(e.path):this.models.delete(e.path),this.$emit("changelist",{assets:this.assets,models:this.models,slides:this.slides,modules:this.modules})},onChangeModules(e){e.isSelected?this.modules.add(e.name):this.modules.delete(e.name),this.$emit("changelist",{assets:this.assets,models:this.models,slides:this.slides,modules:this.modules})},onChangeSlides(e){e.isSelected?this.slides.add(e.uid):this.slides.delete(e.uid),this.$emit("changelist",{assets:this.assets,models:this.models,slides:this.slides,modules:this.modules})},onChangeAssets(e){e.isgroup?e.isSelected?e.children.map(e=>this.assets.add(e.uid)):this.assets.clear():e.isSelected?this.assets.add(e.uid):this.assets.delete(e.uid),this.$emit("changelist",{assets:this.assets,models:this.models,slides:this.slides,modules:this.modules})}},props:{project:{type:Object}},components:{TreeView:at},computed:{assetsTree(){return this.project.assets.reduce((e,t)=>{let o=e.find(e=>e.type===t.type);return o||(o={isgroup:!0,type:t.type,children:[],uid:t.type},e.push(o)),o.children.push(t),e},[])}}},Lp=(0,B.A)(Pp,[["render",function(e,t,o,n,a,r){const l=(0,s.resolveComponent)("TreeView");return(0,s.openBlock)(),(0,s.createElementBlock)("div",Bp,[(0,s.createElementVNode)("div",$p,[(0,s.createElementVNode)("div",null,[t[2]||(t[2]=(0,s.createTextVNode)("Импортировать в текущий проект ",-1)),(0,s.withDirectives)((0,s.createElementVNode)("input",{type:"checkbox",onChange:t[0]||(t[0]=t=>e.$emit("options",{merge:a.merge})),"onUpdate:modelValue":t[1]||(t[1]=e=>a.merge=e)},null,544),[[s.vModelCheckbox,a.merge]])])]),(0,s.createElementVNode)("div",xp,[t[3]||(t[3]=(0,s.createElementVNode)("div",{class:"title"},"Assets",-1)),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(l,{childsFiled:"children",tree:r.assetsTree,onChangeSelect:r.onChangeAssets},{label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",Dp,(0,s.toDisplayString)(e.name||e.uid),1)]),_:1},8,["tree","onChangeSelect"])])]),(0,s.createElementVNode)("div",Tp,[t[4]||(t[4]=(0,s.createElementVNode)("div",{class:"title"},"Модули",-1)),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(l,{childsFiled:"childrenz",tree:o.project.modules,onChangeSelect:r.onChangeModules},{label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",Ip,(0,s.toDisplayString)(e.name||e.uid),1)]),_:1},8,["tree","onChangeSelect"])])]),(0,s.createElementVNode)("div",Ap,[t[5]||(t[5]=(0,s.createElementVNode)("div",{class:"title"},"Элементы",-1)),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(l,{childsFiled:"childrenz",tree:o.project.models,onChangeSelect:r.onChangeElements},{label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",Mp,(0,s.toDisplayString)(e.name||e.uid),1)]),_:1},8,["tree","onChangeSelect"])])]),(0,s.createElementVNode)("div",Op,[t[6]||(t[6]=(0,s.createElementVNode)("div",{class:"title"},"Слайды",-1)),(0,s.createElementVNode)("div",null,[(0,s.createVNode)(l,{childsFiled:"childrenz",tree:o.project.slides,onChangeSelect:r.onChangeSlides},{label:(0,s.withCtx)(({node:e})=>[(0,s.createElementVNode)("div",jp,(0,s.toDisplayString)(e.name||e.uid),1)]),_:1},8,["tree","onChangeSelect"])])])])}]]),Rp=Eo.default.default||Eo.default,Fp=new Fi;const Up=(0,s.reactive)({uid:null,init:function(e){for(let t=0;t<e.length;t++){const o=e[t];Up.data[o.uid]=o}Up.options=Up.data.options||{fullscreen:!1,showslides:!0},Up.info=Up.data.info||{name:"Project"}},data:{},exportToJson:async function(){const e=await cn.exportToJson(Up.uid),t=new Blob([JSON.stringify(e)],{type:"application/json"}),o=`project${Up.uid}.json`;if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(t,o);else{const e=window.document.createElement("a");e.href=window.URL.createObjectURL(t),e.download=o,e.style="display: none",e.click()}},importProject:async function(){try{const e=await function(e=".json"){return new Promise(t=>{const o=document.createElement("input");o.type="file",o.accept=e,o.style.display="none",o.addEventListener("change",()=>{o.files&&o.files[0]&&t(o.files[0]),document.body.removeChild(o)}),document.body.appendChild(o),o.click()})}(),t=await function(e){return new Promise((t,o)=>{if(!e.name.endsWith(".json"))return void o(new Error("Выберите файл с расширением .json"));const n=new FileReader;n.onload=e=>{try{const o=JSON.parse(e.target.result);t(o)}catch(e){o(new Error("Ошибка парсинга JSON: "+e.message))}},n.onerror=()=>{o(new Error("Ошибка чтения файла"))},n.readAsText(e)})}(e);(0,s.reactive)({actions:{},assets:{},elements:{},slides:{},modules:{}}),await cn.addItems("actions",t.actions),await cn.addItems("assets",t.assets),await cn.addItems("models",t.models),await cn.addItems("slides",t.slides),await cn.addItems("modules",t.modules),await cn.addItems("project",t.project);const o=new URL(window.location.href);return window.location.href=o.toString(),t}catch(e){throw console.error("Ошибка:",e.message),e}},play:async function(e="data"){Rp.analitycs.event("project_play");const t=await cn.exportToJson(Up.uid);t.assets=[...Rp.engine.getAssetsManager().Assets.values()].map(e=>e.data);let o=`../player?src=${e}`;"db"===e&&(o+=`&db=${Up.uid}`);const n=window.open(o,"Player");if(n){if("data"===e){const e=async(o=0)=>{try{if(n.closed)return void console.error("Окно плеера было закрыто");n.postMessage({type:"INIT_DATA",payload:t},window.location.origin)}catch(t){console.error("Ошибка при отправке данных:",t),o<5&&setTimeout(()=>e(o+1),500*(o+1))}};setTimeout(e,3e3)}}else console.error("Не удалось открыть окно. Возможно, браузер заблокировал pop-up.")},children:[],on:Fp.on.bind(Fp),off:Fp.off.bind(Fp),options:{fullscreen:!1,showslides:!0},info:{name:"Project"}});Rp.On("init",()=>{window.vue.component("Importer",Lp),window.vue.component("ElementAdd",gt),Rp.menu.hierarhy.list.push({icon:"equalizer2",tooltip:"Project options",handler:()=>{!function(){const e=(0,s.reactive)({model:Up.options,properties:[{label:"Show slides",prop:"showslides",component:"BoolEdit"},{label:"Fullscreen",prop:"fullscreen",component:"BoolEdit"}],head:{title:""}}),t={label:"Close",class:"primary",handler:async()=>{Rp.modal.close()}},o=(0,s.reactive)([t]);Rp.modal.open({header:{value:"Project options",handler:()=>{Rp.modal.close()}},content:{component:"ModalForm",props:e,events:{"update:model":(e,t)=>{!async function(){await cn.upsertItemProperties("project","options",JSON.parse(Xt(Up.options)))}()}}},footer:{buttons:o}})}()}}),Rp.menu.addMenu("app",{path:"app.list.project",icon:"",text:"Project",link:"#",children:[{path:"app.list.project.create",icon:"file-empty",text:"Create",handler:async()=>{Rp.projects.create()}},{path:"app.list.project.open",icon:"menu",text:"Open",tooltip:"Open project",handler:()=>{Rp.projects.open()}},{path:"app.list.project.export",icon:"download",text:"Export",tooltip:"Export project",handler:()=>{Rp.project.exportToJson()}},{path:"app.list.project.import",icon:"upload",text:"Import",link:"#",tooltip:"Import project",handler:()=>{Rp.project.importProject()}},{path:"app.list.project.remove",icon:"bin",text:"Delete",handler:()=>{Rp.projects.remove()}}]})});const zp=Up,Hp=Eo.default.default||Eo.default,qp=[];let Gp="";function Wp(e={}){return new Promise(t=>{const o=(0,s.reactive)({title:"Creating a project",text:"Please enter the project name *",answer:"",template:""}),n=(0,s.reactive)({label:"Create",class:"primary",disabled:o.answer.length<1,callback:async o=>{const n=`project${Date.now()}`;await cn.Create(n,{project:[{uid:"info",id:n,name:o,created:Date.now(),last:Date.now()},{uid:"options",showslides:!0}],assets:e.assets||[],actions:e.actions||[],models:e.models||[],slides:e.slides||[],modules:e.modules||[]}),Hp.analitycs.event("project_create"),t(n)}});Bi.queryText(o,[n],e=>{o.answer=e,n.disabled=o.answer.length<1})})}async function Kp(e){const t=new URL(window.location.href);t.searchParams.set("src","db"),t.searchParams.set("db",e),window.location.href=t.toString()}async function Yp(){const e=await cn.GetFromAll("project","info");return Jp.list.length=0,Jp.list.push(...e.filter(e=>void 0!==e).map(e=>(e.uid=e.id,e))),Jp.list}const Jp=(0,s.reactive)({init:async function(e){console.log(e),Gp=e},create:async function(){const e=await Wp();e&&Kp(e)},createProject:Wp,open:async function(){const e=await Yp(),t=(0,s.reactive)({list:e.filter(e=>e.uid!==Hp.project.uid)});Bi.open({header:{value:"Open project",handler:Bi.close},content:{component:"ItemsLib",props:t,events:{selected:e=>{Kp(e.id),Bi.close()}},slots:{item:{component:"ProjectItem"}}},footer:{buttons:[{label:"Close",class:"primary",handler:Bi.close}]}})},goto:Kp,remove:async function(e){console.log(e);const t=e||Gp;console.log(t),await cn.DeleteDatabase(t),console.log("Removed");const o=Jp.list.findIndex(e=>e.uid===t);o>=0&&Jp.list.splice(o,1),window.location.href=new URL(`${window.location.origin}${window.location.pathname}`).toString()},getList:Yp,loadExample:async function(e){const t=(await qp[e]()).default,o=`project${e}`;await cn.Init(o,["project","assets","models","slides","actions","modules"],"uid"),await cn.addItems("actions",t.actions),await cn.addItems("assets",t.assets),await cn.addItems("models",t.models),await cn.addItems("modules",t.modules),await cn.addItems("project",t.project),await cn.addItems("slides",t.slides);const n=new URL(window.location.href);n.searchParams.set("project",o),window.location.href=n.toString()},play:async function(e="data"){const t=await cn.exportToJson(Gp);console.log(t),t.project={ui:{slides:!0,fullscreen:!0}};let o=`../player?target=${e}`;"src"===e&&(o+=`&src=${Gp}`);const n=window.open(o,"Player");if(n){if("data"===e){const e=async(o=0)=>{try{if(n.closed)return void console.error("Окно плеера было закрыто");n.postMessage({type:"INIT_DATA",payload:t},window.location.origin),console.log("Данные отправлены")}catch(t){console.error("Ошибка при отправке данных:",t),o<5&&setTimeout(()=>e(o+1),500*(o+1))}};setTimeout(e,1e3)}}else console.error("Не удалось открыть окно. Возможно, браузер заблокировал pop-up.")},importProject:async function(){try{const e=await function(e=".json"){return new Promise(t=>{const o=document.createElement("input");o.type="file",o.accept=e,o.style.display="none",o.addEventListener("change",()=>{o.files&&o.files[0]&&t(o.files[0]),document.body.removeChild(o)}),document.body.appendChild(o),o.click()})}(),t=await function(e){return new Promise((t,o)=>{if(!e.name.endsWith(".json"))return void o(new Error("Выберите файл с расширением .json"));const n=new FileReader;n.onload=e=>{try{const o=JSON.parse(e.target.result);t(o)}catch(e){o(new Error("Ошибка парсинга JSON: "+e.message))}},n.onerror=()=>{o(new Error("Ошибка чтения файла"))},n.readAsText(e)})}(e);let o=!1;const n=(0,s.reactive)({actions:{},assets:{},elements:{},slides:{},modules:{}});return Bi.open({header:{value:"Импорт",handler:()=>{Bi.close()}},content:{component:"Importer",props:{project:t},events:{options:e=>{o=e.merge},changelist:e=>{Object.keys(e).forEach(t=>{n[t]=e[t]})}}},footer:{buttons:[{label:"Импорт",class:"secondary",handler:async()=>{const e=`project${Date.now()}`;await cn.Init(e,["project","assets","elements","slides","actions","modules"],"uid"),await cn.addItems("actions",t.actions),await cn.addItems("assets",t.assets),await cn.addItems("elements",t.elements),await cn.addItems("slides",t.slides),await cn.addItems("modules",t.modules),await cn.addItems("project",t.project);const o=new URL(window.location.href);o.searchParams.set("project",e),window.location.href=o.toString(),Bi.close()}},{label:"Отмена",class:"primary",handler:async()=>{Bi.close()}}]}}),t}catch(e){throw console.error("Ошибка:",e.message),e}},load:async function(){},player:null,list:[]}),Xp=Jp,Qp=(0,s.reactive)({uid:"",selected:null,Control:ao,slide:{},select(e){if(!e)return Qp.selected=null,Qp.uid=null,void ao.Select(null);e.nonSelect||(Qp.selected=e,Qp.uid=e.uid),e.isObject3D&&ao.Select(e)}}),Zp=Qp,eu=Eo.default.default||Eo.default,tu=new class{#e=null;get handle(){return this.#e}async requestAccess(){this.#e=await window.showDirectoryPicker({mode:"readwrite"}),await cn.upsertItemProperties("project","storage",{handle:this.#e})}updateHandle(e){this.#e=e}async writeFile(e,t){this.#t();const o=await this.#e.getFileHandle(e,{create:!0}),n=await o.createWritable();await n.write(t),await n.close()}async readFile(e){this.#t();const t=await this.#e.getFileHandle(e),o=await t.getFile();return await o.text()}async listFiles(){this.#t();const e=[];for await(const[t,o]of this.#e.entries())"file"===o.kind&&e.push(t);return e}#t(){if(!this.#e)throw new Error("Folder access not granted")}};let ou;const nu=(0,s.reactive)({getHandle:()=>tu.handle,init:async function(){const e=await cn.getItem("project","storage");if(e)tu.updateHandle(e.handle);else{const e=(0,s.reactive)({title:"Укажите папку для хранения моделей",text:"",answer:"",template:""}),t=(0,s.reactive)({label:"ОК",class:"primary",callback:async e=>{await tu.requestAccess(),ou&&ou()}});eu.modal.confirmReq(e,[t])}},requestAccess:tu.requestAccess.bind(tu),writeFile:tu.writeFile.bind(tu),readFile:tu.readFile.bind(tu),listFiles:tu.listFiles.bind(tu),access:()=>new Promise(e=>{ou=e})}),au={class:"itemElement"},su={class:"itemrow"},ru={class:"itemrow"},lu={class:"itemrow"},iu={props:{item:{type:Object}}},cu=(0,B.A)(iu,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",au,[(0,s.createElementVNode)("div",su,(0,s.toDisplayString)(o.item.title),1),(0,s.createElementVNode)("div",ru,(0,s.toDisplayString)(o.item.price),1),(0,s.createElementVNode)("div",lu,(0,s.toDisplayString)(o.item.autor?.name),1)])}]]),du={class:"product-card"},pu={class:"product-title"},uu={key:0,class:"card-section"},mu={class:"card-value"},hu={class:"card-section"},fu={class:"card-image"},vu=["src","alt"],gu={class:"card-section"},yu={key:0,class:"carousel"},bu={class:"carousel-container"},ku=["src","onClick","alt"],wu={class:"card-section"},Eu={class:"card-value"},_u=["href"],Su={key:1,class:"card-section"},Nu={class:"card-value"},Vu=(0,s.defineComponent)({name:"ProductCard",props:{selected:{type:Object,required:!0,validator:e=>!0}},computed:{data(){return this.selected}},data:()=>({img:0}),setup:e=>({formattedPrice:(0,s.computed)(()=>void 0===e.selected.price||null===e.selected.price?"Цена не указана":new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(e.selected.price))}),methods:{onImageClick(e){this.img=e}}}),Cu=(0,B.A)(Vu,[["render",function(e,t,o,n,a,r){return(0,s.openBlock)(),(0,s.createElementBlock)("div",du,[(0,s.createCommentVNode)(" Заголовок "),(0,s.createElementVNode)("h2",pu,(0,s.toDisplayString)(e.data.title),1),e.data.description?((0,s.openBlock)(),(0,s.createElementBlock)("div",uu,[(0,s.createElementVNode)("span",mu,(0,s.toDisplayString)(e.data.description),1)])):(0,s.createCommentVNode)("v-if",!0),(0,s.createCommentVNode)(" Основное изображение "),(0,s.createElementVNode)("div",hu,[(0,s.createElementVNode)("div",fu,[e.data.images&&e.data.images.length?((0,s.openBlock)(),(0,s.createElementBlock)("img",{key:0,src:e.data.images[e.img],alt:e.data.title,class:"image-preview"},null,8,vu)):(0,s.createCommentVNode)("v-if",!0)])]),(0,s.createCommentVNode)(" Карусель изображений "),(0,s.createElementVNode)("div",gu,[e.data.images&&e.data.images.length?((0,s.openBlock)(),(0,s.createElementBlock)("div",yu,[(0,s.createElementVNode)("div",bu,[((0,s.openBlock)(!0),(0,s.createElementBlock)(s.Fragment,null,(0,s.renderList)(e.data.images,(t,o)=>((0,s.openBlock)(),(0,s.createElementBlock)("div",{key:o,class:"carousel-item"},[(0,s.createElementVNode)("img",{src:t,onClick:t=>e.onImageClick(o),alt:`${e.data.title} - изображение ${o+1}`,class:"carousel-image"},null,8,ku)]))),128))])])):(0,s.createCommentVNode)("v-if",!0)]),(0,s.createElementVNode)("div",wu,[t[0]||(t[0]=(0,s.createElementVNode)("span",{class:"card-label"},null,-1)),(0,s.createElementVNode)("span",Eu,[(0,s.createElementVNode)("a",{href:"../player?src=url&url="+e.data.url,target:"_blank"},"Preview",8,_u)])]),(0,s.createCommentVNode)(" Цена "),(0,s.createCommentVNode)(' <div class="card-section">\r\n            <span class="card-label">Price:</span>\r\n            <span class="card-value">{{ formattedPrice }}</span>\r\n        </div> '),(0,s.createCommentVNode)(" Автор "),e.data.autor?((0,s.openBlock)(),(0,s.createElementBlock)("div",Su,[t[1]||(t[1]=(0,s.createElementVNode)("span",{class:"card-label"},"Autor:",-1)),(0,s.createElementVNode)("span",Nu,(0,s.toDisplayString)(e.data.autor.name),1)])):(0,s.createCommentVNode)("v-if",!0)])}],["__scopeId","data-v-73ea6e84"]]),Bu=Eo.default.default||Eo.default,$u=[];const xu=(0,s.reactive)({init:async function(){},preview:async function(e,t,o=0,n=100){},load:async function(e){}});Bu.On("init",()=>{window.vue.component("TemplateItem",cu),window.vue.component("TemplateView",Cu),Bu.menu.addMenu("app",{path:"app.list.libraries",icon:"",text:"Libraries",link:"#",children:[{path:"app.list.libraries.templates",icon:"codepen",text:"Templates",handler:async()=>{!async function(){await async function(){const[e,t]=await Promise.all([fetch("https://s3.eu-west-1.amazonaws.com/3dbuilder.reneos.com/templates/index.json",{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},cache:"no-store"}).then(e=>e.json()),Bu.app.GetDB().getAllItems("templates")]);$u.length=0,$u.push(...e,...t)}();const e=(0,s.reactive)({selected:null,list:$u}),t={label:"Close",class:"secondary",handler:async()=>{e.selected=null,Bu.modal.close()}},o={label:"Use",class:"additional",hidden:(0,s.computed)(()=>!e.selected),handler:async()=>{const t=await fetch(e.selected.url,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},cache:"no-store"}),o=await t.json(),n=await Bu.projects.createProject(o);Bu.projects.goto(n)}},n=(0,s.reactive)([o,t]);Bu.modal.open({header:{value:"Templates",handler:()=>{Bu.modal.close()}},content:{component:"ItemsLib",props:e,events:{selected:async t=>{e.selected=t},open:async()=>{}},slots:{item:{component:"TemplateItem"},edit:{component:"TemplateView",props:{data:e.selected},events:{"change:type":t=>{const o=xu.library.find(e=>e.component===t);e.selected={...o.template,type:o.component,group:o.type,description:o.description}},edit:(t,o)=>{const n=t.split(".");let a=e.selected;for(let e=0;e<n.length-1;e++){const t=n[e];a[t]||(a[t]={}),a=a[t]}a[n[n.length-1]]=o,async function(){}(e.selected)}}}}},footer:{buttons:n}})}()}}]})});const Du=xu,{setLanguage:Tu,setTranslations:Iu,getCurrentLanguage:Au,updateTranslations:Mu}=(Eo.default.default||Eo.default,At),Ou={ru:[],en:[]};async function ju(e){const t=await fetch(`contents/${e}.json`),o=await t.json();Iu(e,o);for(let t=0;t<Ou[e].length;t++){const o=await fetch(Ou[e][t]),n=await o.json();Mu(e,n)}Tu(e),Pu.lang=e}const Pu=(0,s.reactive)({init:async function(e="en"){await ju(e)},addTranslations:async function(e,t){if(Ou[e].push(t),e===Au()){const o=await fetch(t),n=await o.json();Mu(e,n)}},change:ju,languages:[{label:"English",value:"en"},{label:"Русский",value:"ru"}],lang:"en"}),Lu=Pu,Ru=Eo.default.default||Eo.default,Fu={},Uu=(0,s.reactive)({elements:[],onElementMount(e){Fu[e.path]&&(Fu[e.path](e.element),delete Fu[e.path])},addElement(e,t){return console.log(e),new Promise((o,n)=>{if(!window.vue._context.components[e])return Ru.toasts.add({message:`Component "${e}" is not registered`}),void n(new Error(`Component "${e}" is not registered`));const a=(0,s.reactive)(t.data),r={component:e,data:a,events:t.events};this.elements.push(r),Fu[t.data.path]=e=>{r.element=e,o({data:a,element:e})}})},removeElement(e){const t=this.elements.findIndex(t=>t.element===e);t>=0&&this.elements.splice(t,1)}});Ru.On("init",()=>{Uu.elements.length=0});const zu=Uu,Hu=Eo.default.default||Eo.default;console.log=()=>{};const qu=window.vue=(0,s.createApp)(un);qu.config.errorHandler=(e,t,o)=>{if(console.error("Vue 3 Error:",e),console.error("Component:",t),console.error("Where:",o),console.group("🔍 Vue 3 Error Debug"),console.error("Error:",e),t){console.error("Component name:",t.$options.name||"Anonymous"),console.error("Component file:",t.$options.__file||"Unknown"),console.error("Component props:",t.$props),console.error("Component data:",t.$data),console.error("Component $el:",t.$el);const e=[];let o=t.$parent;for(;o;)e.push(o.$options.name||"Anonymous"),o=o.$parent;console.error("Parent chain:",e.reverse())}console.error("Hook/method:",o),console.error("Error stack:",e.stack),console.groupEnd()},window.addEventListener("error",e=>{console.error("Global Error:",e.error)}),window.addEventListener("unhandledrejection",e=>{console.error("Unhandled Promise Rejection:",e.reason)}),qu.use(e=>{e.config.globalProperties.$app=Hu.Init(a)}),Object.keys(n).forEach(e=>{qu.component(e,n[e])}),qu.provide("globalComponents",qu._context.components),qu.directive("tooltip",Pt),qu.directive("translate",At.directive),qu.mount("#app"),window.isEditor=!0},828:(e,t,o)=>{o.r(t),o.d(t,{Module:()=>Ye,ModuleFederation:()=>pt,createInstance:()=>ut,getInstance:()=>wt,getRemoteEntry:()=>qe,getRemoteInfo:()=>Ge,init:()=>ht,loadRemote:()=>ft,loadScript:()=>n.k0,loadScriptNode:()=>n.oe,loadShare:()=>vt,loadShareSync:()=>gt,preloadRemote:()=>yt,registerGlobalPlugins:()=>R,registerPlugins:()=>kt,registerRemotes:()=>bt,registerShared:()=>Et});var n=o(615);const a="RUNTIME-001",s="RUNTIME-002",r="RUNTIME-003",l="RUNTIME-004",i="RUNTIME-005",c="RUNTIME-006",d="RUNTIME-007",p="RUNTIME-008",u="RUNTIME-009",m=(e,t,o,n)=>{const a=[`${[t[e]]} #${e}`];return o&&a.push(`args: ${JSON.stringify(o)}`),a.push((e=>`View the docs to see how to solve: https://module-federation.io/guide/troubleshooting/${e.split("-")[0].toLowerCase()}/${e}`)(e)),n&&a.push(`Original Error Message:\n ${n}`),a.join("\n")},h={[a]:"Failed to get remoteEntry exports.",[s]:'The remote entry interface does not contain "init"',[r]:"Failed to get manifest.",[l]:"Failed to locate remote.",[i]:"Invalid loadShareSync function call from bundler runtime",[c]:"Invalid loadShareSync function call from runtime",[d]:"Failed to get remote snapshot.",[p]:"Failed to load script resources.",[u]:"Please call createInstance first."},f="[ Federation Runtime ]",v=(0,n.h)(f);function g(e,t){e||y(t)}function y(e){if(e instanceof Error)throw e.message.startsWith(f)||(e.message=`${f}: ${e.message}`),e;throw new Error(`${f}: ${e}`)}function b(e){e instanceof Error?(e.message.startsWith(f)||(e.message=`${f}: ${e.message}`),v.warn(e)):v.warn(e)}function k(e,t){return-1===e.findIndex(e=>e===t)&&e.push(t),e}function w(e){return"version"in e&&e.version?`${e.name}:${e.version}`:"entry"in e&&e.entry?`${e.name}:${e.entry}`:`${e.name}`}function E(e){return void 0!==e.entry}function _(e){return!e.entry.includes(".json")}function S(e){return e&&"object"==typeof e}const N=Object.prototype.toString;function V(e){return Array.isArray(e)?e:[e]}function C(e){const t={url:"",type:"global",globalName:""};return(0,n.OL)()||(0,n.tf)()?"remoteEntry"in e?{url:e.remoteEntry,type:e.remoteEntryType,globalName:e.globalName}:t:"ssrRemoteEntry"in e?{url:e.ssrRemoteEntry||t.url,type:e.ssrRemoteEntryType||t.type,globalName:e.globalName}:t}const B="object"==typeof globalThis?globalThis:window,$=(()=>{try{return document.defaultView}catch{return B}})(),x=$;function D(e,t,o){Object.defineProperty(e,t,{value:o,configurable:!1,writable:!0})}function T(e,t){return Object.hasOwnProperty.call(e,t)}T(B,"__GLOBAL_LOADING_REMOTE_ENTRY__")||D(B,"__GLOBAL_LOADING_REMOTE_ENTRY__",{});const I=B.__GLOBAL_LOADING_REMOTE_ENTRY__;function A(e){T(e,"__VMOK__")&&!T(e,"__FEDERATION__")&&D(e,"__FEDERATION__",e.__VMOK__),T(e,"__FEDERATION__")||(D(e,"__FEDERATION__",{__GLOBAL_PLUGIN__:[],__INSTANCES__:[],moduleInfo:{},__SHARE__:{},__MANIFEST_LOADING__:{},__PRELOADED_MAP__:new Map}),D(e,"__VMOK__",e.__FEDERATION__)),e.__FEDERATION__.__GLOBAL_PLUGIN__??=[],e.__FEDERATION__.__INSTANCES__??=[],e.__FEDERATION__.moduleInfo??={},e.__FEDERATION__.__SHARE__??={},e.__FEDERATION__.__MANIFEST_LOADING__??={},e.__FEDERATION__.__PRELOADED_MAP__??=new Map}function M(e,t){if("string"==typeof t){if(e[t])return{value:e[t],key:t};{const o=Object.keys(e);for(const n of o){const[o,a]=n.split(":"),s=`${o}:${t}`,r=e[s];if(r)return{value:r,key:s}}return{value:void 0,key:t}}}throw new Error("key must be string")}A(B),A($);const O=()=>$.__FEDERATION__.moduleInfo,j=e=>((e,t)=>{const o=M(t,w(e)).value;if(o&&!o.version&&"version"in e&&e.version&&(o.version=e.version),o)return o;if("version"in e&&e.version){const{version:t,...o}=e,n=w(o),a=M($.__FEDERATION__.moduleInfo,n).value;if(a?.version===t)return a}})(e,$.__FEDERATION__.moduleInfo),P=(e,t)=>{const o=w(e);return $.__FEDERATION__.moduleInfo[o]=t,$.__FEDERATION__.moduleInfo},L=(e,t)=>{const o=t||`__FEDERATION_${e}:custom__`;return{remoteEntryKey:o,entryExports:B[o]}},R=e=>{const{__GLOBAL_PLUGIN__:t}=$.__FEDERATION__;e.forEach(e=>{-1===t.findIndex(t=>t.name===e.name)?t.push(e):b(`The plugin ${e.name} has been registered.`)})},F=e=>B.__FEDERATION__.__PRELOADED_MAP__.get(e),U=e=>B.__FEDERATION__.__PRELOADED_MAP__.set(e,!0),z="default",H="global",q="[0-9A-Za-z-]+",G=`(?:\\+(${q}(?:\\.${q})*))`,W="0|[1-9]\\d*",K="[0-9]+",Y="\\d*[a-zA-Z-][a-zA-Z0-9-]*",J=`(?:${K}|${Y})`,X=`(?:${W}|${Y})`,Q=`(?:-(${X}(?:\\.${X})*))`,Z=`${W}|x|X|\\*`,ee=`[v=\\s]*(${Z})(?:\\.(${Z})(?:\\.(${Z})(?:${Q})?${G}?)?)?`,te=`^\\s*(${ee})\\s+-\\s+(${ee})\\s*$`,oe="((?:<|>)?=?)",ne=`(\\s*)${oe}\\s*([v=\\s]*(${K})\\.(${K})\\.(${K})(?:-?(${J}(?:\\.${J})*))?${G}?|${ee})`,ae="(?:~>?)",se=`(\\s*)${ae}\\s+`,re="(?:\\^)",le=`(\\s*)${re}\\s+`,ie=`^${re}${ee}$`,ce=`^${ae}${ee}$`,de=`^${oe}\\s*${ee}$`,pe=`^${oe}\\s*(v?(${W})\\.(${W})\\.(${W})${Q}?${G}?)$|^$`;function ue(e){return new RegExp(e)}function me(e){return!e||"x"===e.toLowerCase()||"*"===e}function he(...e){return t=>e.reduce((e,t)=>t(e),t)}function fe(e){return e.match(ue(pe))}function ve(e,t,o,n){const a=`${e}.${t}.${o}`;return n?`${a}-${n}`:a}function ge(e){return e.replace(ue(te),(e,t,o,n,a,s,r,l,i,c,d,p)=>`${t=me(o)?"":me(n)?`>=${o}.0.0`:me(a)?`>=${o}.${n}.0`:`>=${t}`} ${l=me(i)?"":me(c)?`<${Number(i)+1}.0.0-0`:me(d)?`<${i}.${Number(c)+1}.0-0`:p?`<=${i}.${c}.${d}-${p}`:`<=${l}`}`.trim())}function ye(e){return e.replace(ue(ne),"$1$2$3")}function be(e){return e.replace(ue(se),"$1~")}function ke(e){return e.replace(ue(le),"$1^")}function we(e){return e.trim().split(/\s+/).map(e=>e.replace(ue(ie),(e,t,o,n,a)=>me(t)?"":me(o)?`>=${t}.0.0 <${Number(t)+1}.0.0-0`:me(n)?"0"===t?`>=${t}.${o}.0 <${t}.${Number(o)+1}.0-0`:`>=${t}.${o}.0 <${Number(t)+1}.0.0-0`:a?"0"===t?"0"===o?`>=${t}.${o}.${n}-${a} <${t}.${o}.${Number(n)+1}-0`:`>=${t}.${o}.${n}-${a} <${t}.${Number(o)+1}.0-0`:`>=${t}.${o}.${n}-${a} <${Number(t)+1}.0.0-0`:"0"===t?"0"===o?`>=${t}.${o}.${n} <${t}.${o}.${Number(n)+1}-0`:`>=${t}.${o}.${n} <${t}.${Number(o)+1}.0-0`:`>=${t}.${o}.${n} <${Number(t)+1}.0.0-0`)).join(" ")}function Ee(e){return e.trim().split(/\s+/).map(e=>e.replace(ue(ce),(e,t,o,n,a)=>me(t)?"":me(o)?`>=${t}.0.0 <${Number(t)+1}.0.0-0`:me(n)?`>=${t}.${o}.0 <${t}.${Number(o)+1}.0-0`:a?`>=${t}.${o}.${n}-${a} <${t}.${Number(o)+1}.0-0`:`>=${t}.${o}.${n} <${t}.${Number(o)+1}.0-0`)).join(" ")}function _e(e){return e.split(/\s+/).map(e=>e.trim().replace(ue(de),(e,t,o,n,a,s)=>{const r=me(o),l=r||me(n),i=l||me(a);return"="===t&&i&&(t=""),s="",r?">"===t||"<"===t?"<0.0.0-0":"*":t&&i?(l&&(n=0),a=0,">"===t?(t=">=",l?(o=Number(o)+1,n=0,a=0):(n=Number(n)+1,a=0)):"<="===t&&(t="<",l?o=Number(o)+1:n=Number(n)+1),"<"===t&&(s="-0"),`${t+o}.${n}.${a}${s}`):l?`>=${o}.0.0${s} <${Number(o)+1}.0.0-0`:i?`>=${o}.${n}.0${s} <${o}.${Number(n)+1}.0-0`:e})).join(" ")}function Se(e){return e.trim().replace(ue("(<|>)?=?\\s*\\*"),"")}function Ne(e,t){return(e=Number(e)||e)>(t=Number(t)||t)?1:e===t?0:-1}function Ve(e,t){return Ne(e.major,t.major)||Ne(e.minor,t.minor)||Ne(e.patch,t.patch)||function(e,t){const{preRelease:o}=e,{preRelease:n}=t;if(void 0===o&&Boolean(n))return 1;if(Boolean(o)&&void 0===n)return-1;if(void 0===o&&void 0===n)return 0;for(let e=0,t=o.length;e<=t;e++){const t=o[e],a=n[e];if(t!==a)return void 0===t&&void 0===a?0:t?a?Ne(t,a):-1:1}return 0}(e,t)}function Ce(e,t){return e.version===t.version}function Be(e,t){switch(e.operator){case"":case"=":return Ce(e,t);case">":return Ve(e,t)<0;case">=":return Ce(e,t)||Ve(e,t)<0;case"<":return Ve(e,t)>0;case"<=":return Ce(e,t)||Ve(e,t)>0;case void 0:return!0;default:return!1}}function $e(e){return he(we,Ee,_e,Se)(e)}function xe(e){return he(ge,ye,be,ke)(e.trim()).split(/\s+/).join(" ")}function De(e,t){if(!e)return!1;const o=fe(e);if(!o)return!1;const[,n,,a,s,r,l]=o,i={operator:n,version:ve(a,s,r,l),major:a,minor:s,patch:r,preRelease:l?.split(".")},c=t.split("||");for(const e of c){const t=e.trim();if(!t)return!0;if("*"===t||"x"===t)return!0;try{const e=xe(t);if(!e.trim())return!0;const o=e.split(" ").map(e=>$e(e)).join(" ");if(!o.trim())return!0;const n=o.split(/\s+/).map(e=>e.trim().replace(ue("^\\s*>=\\s*0.0.0\\s*$"),"")).filter(Boolean);if(0===n.length)continue;let a=!0;for(const e of n){const t=fe(e);if(!t){a=!1;break}const[,o,,n,s,r,l]=t;if(!Be({operator:o,version:ve(n,s,r,l),major:n,minor:s,patch:r,preRelease:l?.split(".")},i)){a=!1;break}}if(a)return!0}catch(e){console.error(`[semver] Error processing range part "${t}":`,e);continue}}return!1}function Te(e,t){const o=t.shared||{},n=t.name,a=Object.keys(o).reduce((e,a)=>{const s=V(o[a]);return e[a]=e[a]||[],s.forEach(o=>{e[a].push(function(e,t,o,n){let a;return a="get"in e?e.get:"lib"in e?()=>Promise.resolve(e.lib):()=>Promise.resolve(()=>{throw new Error(`Can not get shared '${o}'!`)}),{deps:[],useIn:[],from:t,loading:null,...e,shareConfig:{requiredVersion:`^${e.version}`,singleton:!1,eager:!1,strictVersion:!1,...e.shareConfig},get:a,loaded:!(!e?.loaded&&!("lib"in e))||void 0,version:e.version??"0",scope:Array.isArray(e.scope)?e.scope:[e.scope??"default"],strategy:(e.strategy??n)||"version-first"}}(o,n,a,t.shareStrategy))}),e},{}),s={...e.shared};return Object.keys(a).forEach(e=>{s[e]?a[e].forEach(t=>{s[e].find(e=>e.version===t.version)||s[e].push(t)}):s[e]=a[e]}),{shared:s,shareInfos:a}}function Ie(e,t){const o=e=>{if(!Number.isNaN(Number(e))){const t=e.split(".");let o=e;for(let e=0;e<3-t.length;e++)o+=".0";return o}return e};return!!De(o(e),`<=${o(t)}`)}const Ae=(e,t)=>{const o=t||function(e,t){return Ie(e,t)};return Object.keys(e).reduce((e,t)=>e?o(e,t)||"0"===e?t:e:t,0)},Me=e=>Boolean(e.loaded)||"function"==typeof e.lib;function Oe(e,t,o){const n=e[t][o];return Ae(e[t][o],function(e,t){return!Me(n[e])&&Ie(e,t)})}function je(e,t,o){const n=e[t][o];return Ae(e[t][o],function(e,t){const o=e=>Me(e)||(e=>Boolean(e.loading))(e);return o(n[t])?!o(n[e])||Boolean(Ie(e,t)):!o(n[e])&&Ie(e,t)})}function Pe(e){return"loaded-first"===e?je:Oe}function Le(e,t,o,n){if(!e)return;const{shareConfig:a,scope:s=z,strategy:r}=o,l=Array.isArray(s)?s:[s];for(const s of l)if(a&&e[s]&&e[s][t]){const{requiredVersion:l}=a,i=Pe(r)(e,s,t),c=()=>{if(a.singleton){if("string"==typeof l&&!De(i,l)){const n=`Version ${i} from ${i&&e[s][t][i].from} of shared singleton module ${t} does not satisfy the requirement of ${o.from} which needs ${l})`;a.strictVersion?y(n):b(n)}return e[s][t][i]}if(!1===l||"*"===l)return e[s][t][i];if(De(i,l))return e[s][t][i];for(const[o,n]of Object.entries(e[s][t]))if(De(o,l))return n},d={shareScopeMap:e,scope:s,pkgName:t,version:i,GlobalFederation:x.__FEDERATION__,resolver:c};return(n.emit(d)||d).resolver()}}function Re(){return x.__FEDERATION__.__SHARE__}function Fe(e){const{pkgName:t,extraOptions:o,shareInfos:n}=e,a=o?.resolver??(e=>{if(!e)return;const t={};e.forEach(e=>{t[e.version]=e});const o=Ae(t,function(e,o){return!Me(t[e])&&Ie(e,o)});return t[o]});return Object.assign({},a(n[t]),o?.customShareInfo)}const Ue=".then(callbacks[0]).catch(callbacks[1])";function ze(e,t,o){const{remoteEntryKey:n,entryExports:s}=L(e,t);return g(s,m(a,h,{remoteName:e,remoteEntryUrl:o,remoteEntryKey:n})),s}function He(e){const{entry:t,name:o}=e;return(0,n.lG)(o,t)}async function qe(e){const{origin:t,remoteEntryExports:o,remoteInfo:a,getEntryUrl:s,_inErrorHandling:r=!1}=e,l=He(a);if(o)return o;if(!I[l]){const e=t.remoteHandler.hooks.lifecycle.loadEntry,i=t.loaderHook;I[l]=e.emit({loaderHook:i,remoteInfo:a,remoteEntryExports:o}).then(e=>e||(("undefined"!=typeof ENV_TARGET?"web"===ENV_TARGET:(0,n.OL)())?async function({remoteInfo:e,remoteEntryExports:t,loaderHook:o,getEntryUrl:a}){const{entry:s,entryGlobalName:r,name:l,type:i}=e;switch(i){case"esm":case"module":return async function({entry:e,remoteEntryExports:t}){return new Promise((o,n)=>{try{t?o(t):"undefined"!=typeof FEDERATION_ALLOW_NEW_FUNCTION?new Function("callbacks",`import("${e}")${Ue}`)([o,n]):import(e).then(o).catch(n)}catch(e){n(e)}})}({entry:s,remoteEntryExports:t});case"system":return async function({entry:e,remoteEntryExports:t}){return new Promise((o,n)=>{try{t?o(t):new Function("callbacks",`System.import("${e}")${Ue}`)([o,n])}catch(e){n(e)}})}({entry:s,remoteEntryExports:t});default:return async function({name:e,globalName:t,entry:o,loaderHook:a,getEntryUrl:s}){const{entryExports:r}=L(e,t);if(r)return r;const l=s?s(o):o;return(0,n.k0)(l,{attrs:{},createScriptHook:(e,t)=>{const o=a.lifecycle.createScript.emit({url:e,attrs:t});if(o)return o instanceof HTMLScriptElement||"script"in o||"timeout"in o?o:void 0}}).then(()=>ze(e,t,o)).catch(t=>{throw g(void 0,m(p,h,{remoteName:e,resourceUrl:o})),t})}({entry:s,globalName:r,name:l,loaderHook:o,getEntryUrl:a})}}({remoteInfo:a,remoteEntryExports:o,loaderHook:i,getEntryUrl:s}):async function({remoteInfo:e,loaderHook:t}){const{entry:o,entryGlobalName:a,name:s,type:r}=e,{entryExports:l}=L(s,a);return l||(0,n.oe)(o,{attrs:{name:s,globalName:a,type:r},loaderHook:{createScriptHook:(e,o={})=>{const n=t.lifecycle.createScript.emit({url:e,attrs:o});if(n)return"url"in n?n:void 0}}}).then(()=>ze(s,a,o)).catch(e=>{throw e})}({remoteInfo:a,loaderHook:i}))).catch(async e=>{const n=He(a);if(e instanceof Error&&e.message.includes(p)&&!r){const e=e=>qe({...e,_inErrorHandling:!0}),s=await t.loaderHook.lifecycle.loadEntryError.emit({getRemoteEntry:e,origin:t,remoteInfo:a,remoteEntryExports:o,globalLoading:I,uniqueKey:n});if(s)return s}throw e})}return I[l]}function Ge(e){return{...e,entry:"entry"in e?e.entry:"",type:e.type||H,entryGlobalName:e.entryGlobalName||e.name,shareScope:e.shareScope||z}}function We(e){return{resourceCategory:"sync",share:!0,depsRemote:!0,prefetchInterface:!1,...e}}function Ke(e,t,o,a=!0){const{cssAssets:s,jsAssetsWithoutEntry:r,entryAssets:l}=o;if(t.options.inBrowser){if(l.forEach(o=>{const{moduleInfo:n}=o,a=t.moduleCache.get(e.name);qe(a?{origin:t,remoteInfo:n,remoteEntryExports:a.remoteEntryExports}:{origin:t,remoteInfo:n,remoteEntryExports:void 0})}),a){const e={rel:"preload",as:"style"};s.forEach(o=>{const{link:a,needAttach:s}=(0,n.d)({url:o,cb:()=>{},attrs:e,createLinkHook:(e,o)=>{const n=t.loaderHook.lifecycle.createLink.emit({url:e,attrs:o});if(n instanceof HTMLLinkElement)return n}});s&&document.head.appendChild(a)})}else{const e={rel:"stylesheet",type:"text/css"};s.forEach(o=>{const{link:a,needAttach:s}=(0,n.d)({url:o,cb:()=>{},attrs:e,createLinkHook:(e,o)=>{const n=t.loaderHook.lifecycle.createLink.emit({url:e,attrs:o});if(n instanceof HTMLLinkElement)return n},needDeleteLink:!1});s&&document.head.appendChild(a)})}if(a){const e={rel:"preload",as:"script"};r.forEach(o=>{const{link:a,needAttach:s}=(0,n.d)({url:o,cb:()=>{},attrs:e,createLinkHook:(e,o)=>{const n=t.loaderHook.lifecycle.createLink.emit({url:e,attrs:o});if(n instanceof HTMLLinkElement)return n}});s&&document.head.appendChild(a)})}else{const o={fetchpriority:"high",type:"module"===e?.type?"module":"text/javascript"};r.forEach(e=>{const{script:a,needAttach:s}=(0,n.so)({url:e,cb:()=>{},attrs:o,createScriptHook:(e,o)=>{const n=t.loaderHook.lifecycle.createScript.emit({url:e,attrs:o});if(n instanceof HTMLScriptElement)return n},needDeleteScript:!0});s&&document.head.appendChild(a)})}}}class Ye{constructor({remoteInfo:e,host:t}){this.inited=!1,this.lib=void 0,this.remoteInfo=e,this.host=t}async getEntry(){if(this.remoteEntryExports)return this.remoteEntryExports;let e;return e=await qe({origin:this.host,remoteInfo:this.remoteInfo,remoteEntryExports:this.remoteEntryExports}),g(e,`remoteEntryExports is undefined \n ${(0,n.ML)(this.remoteInfo)}`),this.remoteEntryExports=e,this.remoteEntryExports}async get(e,t,o,n){const{loadFactory:a=!0}=o||{loadFactory:!0},r=await this.getEntry();if(!this.inited){const t=this.host.shareScopeMap,o=Array.isArray(this.remoteInfo.shareScope)?this.remoteInfo.shareScope:[this.remoteInfo.shareScope];o.length||o.push("default"),o.forEach(e=>{t[e]||(t[e]={})});const a=t[o[0]],l=[],i={version:this.remoteInfo.version||"",shareScopeKeys:Array.isArray(this.remoteInfo.shareScope)?o:this.remoteInfo.shareScope||"default"};Object.defineProperty(i,"shareScopeMap",{value:t,enumerable:!1});const c=await this.host.hooks.lifecycle.beforeInitContainer.emit({shareScope:a,remoteEntryInitOptions:i,initScope:l,remoteInfo:this.remoteInfo,origin:this.host});void 0===r?.init&&y(m(s,h,{hostName:this.host.name,remoteName:this.remoteInfo.name,remoteEntryUrl:this.remoteInfo.entry,remoteEntryKey:this.remoteInfo.entryGlobalName})),await r.init(c.shareScope,c.initScope,c.remoteEntryInitOptions),await this.host.hooks.lifecycle.initContainer.emit({...c,id:e,remoteSnapshot:n,remoteEntryExports:r})}let l;this.lib=r,this.inited=!0,l=await this.host.loaderHook.lifecycle.getModuleFactory.emit({remoteEntryExports:r,expose:t,moduleInfo:this.remoteInfo}),l||(l=await r.get(t)),g(l,`${w(this.remoteInfo)} remote don't export ${t}.`);const i=((e,t)=>{let o;return o=e.endsWith("/")?e.slice(0,-1):e,t.startsWith(".")&&(t=t.slice(1)),o+=t,o})(this.remoteInfo.name,t),c=this.wraperFactory(l,i);return a?await c():c}wraperFactory(e,t){function o(e,t){e&&"object"==typeof e&&Object.isExtensible(e)&&!Object.getOwnPropertyDescriptor(e,Symbol.for("mf_module_id"))&&Object.defineProperty(e,Symbol.for("mf_module_id"),{value:t,enumerable:!1})}return e instanceof Promise?async()=>{const n=await e();return o(n,t),n}:()=>{const n=e();return o(n,t),n}}}class Je{constructor(e){this.type="",this.listeners=new Set,e&&(this.type=e)}on(e){"function"==typeof e&&this.listeners.add(e)}once(e){const t=this;this.on(function o(...n){return t.remove(o),e.apply(null,n)})}emit(...e){let t;return this.listeners.size>0&&this.listeners.forEach(o=>{t=o(...e)}),t}remove(e){this.listeners.delete(e)}removeAll(){this.listeners.clear()}}class Xe extends Je{emit(...e){let t;const o=Array.from(this.listeners);if(o.length>0){let n=0;const a=t=>!1!==t&&(n<o.length?Promise.resolve(o[n++].apply(null,e)).then(a):t);t=a()}return Promise.resolve(t)}}function Qe(e,t){if(!S(t))return!1;if(e!==t)for(const o in e)if(!(o in t))return!1;return!0}class Ze extends Je{constructor(e){super(),this.onerror=y,this.type=e}emit(e){S(e)||y(`The data for the "${this.type}" hook should be an object.`);for(const t of this.listeners)try{const o=t(e);if(!Qe(e,o)){this.onerror(`A plugin returned an unacceptable value for the "${this.type}" type.`);break}e=o}catch(e){b(e),this.onerror(e)}return e}}class et extends Je{constructor(e){super(),this.onerror=y,this.type=e}emit(e){S(e)||y(`The response data for the "${this.type}" hook must be an object.`);const t=Array.from(this.listeners);if(t.length>0){let o=0;const n=t=>(b(t),this.onerror(t),e),a=s=>{if(Qe(e,s)){if(e=s,o<t.length)try{return Promise.resolve(t[o++](e)).then(a,n)}catch(e){return n(e)}}else this.onerror(`A plugin returned an incorrect value for the "${this.type}" type.`);return e};return Promise.resolve(a(e))}return Promise.resolve(e)}}class tt{constructor(e){this.registerPlugins={},this.lifecycle=e,this.lifecycleKeys=Object.keys(e)}applyPlugin(e,t){var o;g((o=e,"[object Object]"===N.call(o)),"Plugin configuration is invalid.");const n=e.name;g(n,"A name must be provided by the plugin."),this.registerPlugins[n]||(this.registerPlugins[n]=e,e.apply?.(t),Object.keys(this.lifecycle).forEach(t=>{const o=e[t];o&&this.lifecycle[t].on(o)}))}removePlugin(e){g(e,"A name is required.");const t=this.registerPlugins[e];g(t,`The plugin "${e}" is not registered.`),Object.keys(t).forEach(e=>{"name"!==e&&this.lifecycle[e].remove(t[e])})}}function ot(e,t){const o=C(t);o.url||y(`The attribute remoteEntry of ${e.name} must not be undefined.`);let a=(0,n.Al)(t,o.url);(0,n.OL)()||a.startsWith("http")||(a=`https:${a}`),e.type=o.type,e.entryGlobalName=o.globalName,e.entry=a,e.version=t.version,e.buildVersion=t.buildVersion}function nt(e){const t=e.split(":");return 1===t.length?{name:t[0],version:void 0}:2===t.length?{name:t[0],version:t[1]}:{name:t[1],version:t[2]}}function at(e,t,o,a,s={},r){const l=w(t),{value:i}=M(e,l),c=r||i;if(c&&!(0,n.Tr)(c)&&(o(c,t,a),c.remotesInfo)){const t=Object.keys(c.remotesInfo);for(const n of t){if(s[n])continue;s[n]=!0;const t=nt(n),a=c.remotesInfo[n];at(e,{name:t.name,version:a.matchedVersion},o,!1,s,void 0)}}}const st=(e,t)=>document.querySelector(`${e}[${"link"===e?"href":"src"}="${t}"]`);function rt(e,t,o,a,s){const r=[],l=[],i=[],c=new Set,d=new Set,{options:p}=e,{preloadConfig:u}=t,{depsRemote:m}=u;if(at(a,o,(t,o,a)=>{let s;if(a)s=u;else if(Array.isArray(m)){const e=m.find(e=>e.nameOrAlias===o.name||e.nameOrAlias===o.alias);if(!e)return;s=We(e)}else{if(!0!==m)return;s=u}const c=(0,n.Al)(t,C(t).url);c&&i.push({name:o.name,moduleInfo:{name:o.name,entry:c,type:"remoteEntryType"in t?t.remoteEntryType:"global",entryGlobalName:"globalName"in t?t.globalName:o.name,shareScope:"",version:"version"in t?t.version:void 0},url:c});let d="modules"in t?t.modules:[];const p=(h=s.exposes)?h.map(e=>"."===e?e:e.startsWith("./")?e.replace("./",""):e):[];var h;function f(e){const o=e.map(e=>(0,n.Al)(t,e));return s.filter?o.filter(s.filter):o}if(p.length&&"modules"in t&&(d=t?.modules?.reduce((e,t)=>(-1!==p?.indexOf(t.moduleName)&&e.push(t),e),[])),d){const n=d.length;for(let a=0;a<n;a++){const n=d[a],i=`${o.name}/${n.moduleName}`;e.remoteHandler.hooks.lifecycle.handlePreloadModule.emit({id:"."===n.moduleName?o.name:i,name:o.name,remoteSnapshot:t,preloadConfig:s,remote:o,origin:e}),F(i)||("all"===s.resourceCategory?(r.push(...f(n.assets.css.async)),r.push(...f(n.assets.css.sync)),l.push(...f(n.assets.js.async)),l.push(...f(n.assets.js.sync))):(s.resourceCategory="sync")&&(r.push(...f(n.assets.css.sync)),l.push(...f(n.assets.js.sync))),U(i))}}},!0,{},s),s.shared&&s.shared.length>0){const t=(t,o)=>{const n=Le(e.shareScopeMap,o.sharedName,t,e.sharedHandler.hooks.lifecycle.resolveShare);n&&"function"==typeof n.lib&&(o.assets.js.sync.forEach(e=>{c.add(e)}),o.assets.css.sync.forEach(e=>{d.add(e)}))};s.shared.forEach(e=>{const o=p.shared?.[e.sharedName];if(!o)return;const n=e.version?o.find(t=>t.version===e.version):o;n&&V(n).forEach(o=>{t(o,e)})})}const h=l.filter(e=>!c.has(e)&&!st("script",e));return{cssAssets:r.filter(e=>!d.has(e)&&!st("link",e)),jsAssetsWithoutEntry:h,entryAssets:i.filter(e=>!st("script",e.url))}}function lt(e,t){const o=j({name:t.name,version:t.options.version}),n=o&&"remotesInfo"in o&&o.remotesInfo&&M(o.remotesInfo,e.name).value;return n&&n.matchedVersion?{hostGlobalSnapshot:o,globalSnapshot:O(),remoteSnapshot:j({name:e.name,version:n.matchedVersion})}:{hostGlobalSnapshot:void 0,globalSnapshot:O(),remoteSnapshot:j({name:e.name,version:"version"in e?e.version:void 0})}}class it{constructor(e){this.loadingHostSnapshot=null,this.manifestCache=new Map,this.hooks=new tt({beforeLoadRemoteSnapshot:new Xe("beforeLoadRemoteSnapshot"),loadSnapshot:new et("loadGlobalSnapshot"),loadRemoteSnapshot:new et("loadRemoteSnapshot"),afterLoadSnapshot:new et("afterLoadSnapshot")}),this.manifestLoading=x.__FEDERATION__.__MANIFEST_LOADING__,this.HostInstance=e,this.loaderHook=e.loaderHook}async loadRemoteSnapshotInfo({moduleInfo:e,id:t,expose:o}){const{options:a}=this.HostInstance;await this.hooks.lifecycle.beforeLoadRemoteSnapshot.emit({options:a,moduleInfo:e});let s=j({name:this.HostInstance.options.name,version:this.HostInstance.options.version});var r;s||(s={version:this.HostInstance.options.version||"",remoteEntry:"",remotesInfo:{}},r={[this.HostInstance.options.name]:s},$.__FEDERATION__.moduleInfo={...$.__FEDERATION__.moduleInfo,...r}),s&&"remotesInfo"in s&&!M(s.remotesInfo,e.name).value&&("version"in e||"entry"in e)&&(s.remotesInfo={...s?.remotesInfo,[e.name]:{matchedVersion:"version"in e?e.version:e.entry}});const{hostGlobalSnapshot:l,remoteSnapshot:i,globalSnapshot:c}=this.getGlobalRemoteInfo(e),{remoteSnapshot:p,globalSnapshot:u}=await this.hooks.lifecycle.loadSnapshot.emit({options:a,moduleInfo:e,hostGlobalSnapshot:l,remoteSnapshot:i,globalSnapshot:c});let f,v;if(p)if((0,n.Tr)(p)){const t=(0,n.OL)()?p.remoteEntry:p.ssrRemoteEntry||p.remoteEntry||"",o=await this.getManifestJson(t,e,{});f=o,v=P({...e,entry:t},o)}else{const{remoteSnapshot:t}=await this.hooks.lifecycle.loadRemoteSnapshot.emit({options:this.HostInstance.options,moduleInfo:e,remoteSnapshot:p,from:"global"});f=t,v=u}else if(E(e)){const t=await this.getManifestJson(e.entry,e,{}),o=P(e,t),{remoteSnapshot:n}=await this.hooks.lifecycle.loadRemoteSnapshot.emit({options:this.HostInstance.options,moduleInfo:e,remoteSnapshot:t,from:"global"});f=n,v=o}else y(m(d,h,{hostName:e.name,hostVersion:e.version,globalSnapshot:JSON.stringify(u)}));return await this.hooks.lifecycle.afterLoadSnapshot.emit({id:t,host:this.HostInstance,options:a,moduleInfo:e,remoteSnapshot:f}),{remoteSnapshot:f,globalSnapshot:v}}getGlobalRemoteInfo(e){return lt(e,this.HostInstance)}async getManifestJson(e,t,o){const a=async()=>{let o=this.manifestCache.get(e);if(o)return o;try{let t=await this.loaderHook.lifecycle.fetch.emit(e,{});t&&t instanceof Response||(t=await fetch(e,{})),o=await t.json()}catch(n){o=await this.HostInstance.remoteHandler.hooks.lifecycle.errorLoadRemote.emit({id:e,error:n,from:"runtime",lifecycle:"afterResolve",origin:this.HostInstance}),o||(delete this.manifestLoading[e],y(m(r,h,{manifestUrl:e,moduleName:t.name,hostName:this.HostInstance.options.name},`${n}`)))}return g(o.metaData&&o.exposes&&o.shared,`${e} is not a federation manifest`),this.manifestCache.set(e,o),o};return this.manifestLoading[e]||(this.manifestLoading[e]=(async()=>{const o=await a(),s=(0,n.Jn)(o,{version:e}),{remoteSnapshot:r}=await this.hooks.lifecycle.loadRemoteSnapshot.emit({options:this.HostInstance.options,moduleInfo:t,manifestJson:o,remoteSnapshot:s,manifestUrl:e,from:"manifest"});return r})().then(e=>e)),this.manifestLoading[e]}}class ct{constructor(e){this.hooks=new tt({afterResolve:new et("afterResolve"),beforeLoadShare:new et("beforeLoadShare"),loadShare:new Xe,resolveShare:new Ze("resolveShare"),initContainerShareScopeMap:new Ze("initContainerShareScopeMap")}),this.host=e,this.shareScopeMap={},this.initTokens={},this._setGlobalShareScopeMap(e.options)}registerShared(e,t){const{shareInfos:o,shared:n}=Te(e,t);return Object.keys(o).forEach(e=>{o[e].forEach(o=>{!Le(this.shareScopeMap,e,o,this.hooks.lifecycle.resolveShare)&&o&&o.lib&&this.setShared({pkgName:e,lib:o.lib,get:o.get,loaded:!0,shared:o,from:t.name})})}),{shareInfos:o,shared:n}}async loadShare(e,t){const{host:o}=this,n=Fe({pkgName:e,extraOptions:t,shareInfos:o.options.shared});n?.scope&&await Promise.all(n.scope.map(async e=>{await Promise.all(this.initializeSharing(e,{strategy:n.strategy}))}));const a=await this.hooks.lifecycle.beforeLoadShare.emit({pkgName:e,shareInfo:n,shared:o.options.shared,origin:o}),{shareInfo:s}=a;g(s,`Cannot find ${e} Share in the ${o.options.name}. Please ensure that the ${e} Share parameters have been injected`);const r=Le(this.shareScopeMap,e,s,this.hooks.lifecycle.resolveShare),l=e=>{e.useIn||(e.useIn=[]),k(e.useIn,o.options.name)};if(r&&r.lib)return l(r),r.lib;if(r&&r.loading&&!r.loaded){const e=await r.loading;return r.loaded=!0,r.lib||(r.lib=e),l(r),e}if(r){const t=(async()=>{const e=await r.get();return l(r),r.loaded=!0,r.lib=e,e})();return this.setShared({pkgName:e,loaded:!1,shared:r,from:o.options.name,lib:null,loading:t}),t}{if(t?.customShareInfo)return!1;const n=(async()=>{const t=await s.get();s.lib=t,s.loaded=!0,l(s);const o=Le(this.shareScopeMap,e,s,this.hooks.lifecycle.resolveShare);return o&&(o.lib=t,o.loaded=!0,o.from=s.from),t})();return this.setShared({pkgName:e,loaded:!1,shared:s,from:o.options.name,lib:null,loading:n}),n}}initializeSharing(e=z,t){const{host:o}=this,n=t?.from,a=t?.strategy;let s=t?.initScope;const r=[];if("build"!==n){const{initTokens:t}=this;s||(s=[]);let o=t[e];if(o||(o=t[e]={from:this.host.name}),s.indexOf(o)>=0)return r;s.push(o)}const l=this.shareScopeMap,i=o.options.name;l[e]||(l[e]={});const c=l[e];return Object.keys(o.options.shared).forEach(t=>{o.options.shared[t].forEach(o=>{o.scope.includes(e)&&((e,t)=>{const{version:o,eager:n}=t;c[e]=c[e]||{};const a=c[e],s=a[o],r=Boolean(s&&(s.eager||s.shareConfig?.eager));(!s||"loaded-first"!==s.strategy&&!s.loaded&&(Boolean(!n)!==!r?n:i>s.from))&&(a[o]=t)})(t,o)})}),"version-first"!==o.options.shareStrategy&&"version-first"!==a||o.options.remotes.forEach(t=>{t.shareScope===e&&r.push((async t=>{const{module:n}=await o.remoteHandler.getRemoteModuleAndOptions({id:t});if(n.getEntry){let r;try{r=await n.getEntry()}catch(e){r=await o.remoteHandler.hooks.lifecycle.errorLoadRemote.emit({id:t,error:e,from:"runtime",lifecycle:"beforeLoadShare",origin:o})}n.inited||(await(a=r,a&&a.init&&a.init(l[e],s)),n.inited=!0)}var a})(t.name))}),r}loadShareSync(e,t){const{host:o}=this,n=Fe({pkgName:e,extraOptions:t,shareInfos:o.options.shared});n?.scope&&n.scope.forEach(e=>{this.initializeSharing(e,{strategy:n.strategy})});const a=Le(this.shareScopeMap,e,n,this.hooks.lifecycle.resolveShare),s=e=>{e.useIn||(e.useIn=[]),k(e.useIn,o.options.name)};if(a){if("function"==typeof a.lib)return s(a),a.loaded||(a.loaded=!0,a.from===o.options.name&&(n.loaded=!0)),a.lib;if("function"==typeof a.get){const t=a.get();if(!(t instanceof Promise))return s(a),this.setShared({pkgName:e,loaded:!0,from:o.options.name,lib:t,shared:a}),t}}if(n.lib)return n.loaded||(n.loaded=!0),n.lib;if(n.get){const a=n.get();if(a instanceof Promise)throw new Error(m("build"===t?.from?i:c,h,{hostName:o.options.name,sharedPkgName:e}));return n.lib=a,this.setShared({pkgName:e,loaded:!0,from:o.options.name,lib:n.lib,shared:n}),n.lib}throw new Error(m(c,h,{hostName:o.options.name,sharedPkgName:e}))}initShareScopeMap(e,t,o={}){const{host:n}=this;this.shareScopeMap[e]=t,this.hooks.lifecycle.initContainerShareScopeMap.emit({shareScope:t,options:n.options,origin:n,scopeName:e,hostShareScopeMap:o.hostShareScopeMap})}setShared({pkgName:e,shared:t,from:o,lib:n,loading:a,loaded:s,get:r}){const{version:l,scope:i="default",...c}=t;(Array.isArray(i)?i:[i]).forEach(t=>{if(this.shareScopeMap[t]||(this.shareScopeMap[t]={}),this.shareScopeMap[t][e]||(this.shareScopeMap[t][e]={}),!this.shareScopeMap[t][e][l])return this.shareScopeMap[t][e][l]={version:l,scope:["default"],...c,lib:n,loaded:s,loading:a},void(r&&(this.shareScopeMap[t][e][l].get=r));const i=this.shareScopeMap[t][e][l];a&&!i.loading&&(i.loading=a),s&&!i.loaded&&(i.loaded=s),o&&i.from!==o&&(i.from=o)})}_setGlobalShareScopeMap(e){const t=Re(),o=e.id||e.name;o&&!t[o]&&(t[o]=this.shareScopeMap)}}class dt{constructor(e){this.hooks=new tt({beforeRegisterRemote:new Ze("beforeRegisterRemote"),registerRemote:new Ze("registerRemote"),beforeRequest:new et("beforeRequest"),onLoad:new Xe("onLoad"),handlePreloadModule:new Je("handlePreloadModule"),errorLoadRemote:new Xe("errorLoadRemote"),beforePreloadRemote:new Xe("beforePreloadRemote"),generatePreloadAssets:new Xe("generatePreloadAssets"),afterPreloadRemote:new Xe,loadEntry:new Xe}),this.host=e,this.idToRemoteMap={}}formatAndRegisterRemote(e,t){return(t.remotes||[]).reduce((e,t)=>(this.registerRemote(t,e,{force:!1}),e),e.remotes)}setIdToRemoteMap(e,t){const{remote:o,expose:n}=t,{name:a,alias:s}=o;if(this.idToRemoteMap[e]={name:o.name,expose:n},s&&e.startsWith(a)){const t=e.replace(a,s);return void(this.idToRemoteMap[t]={name:o.name,expose:n})}if(s&&e.startsWith(s)){const t=e.replace(s,a);this.idToRemoteMap[t]={name:o.name,expose:n}}}async loadRemote(e,t){const{host:o}=this;try{const{loadFactory:n=!0}=t||{loadFactory:!0},{module:a,moduleOptions:s,remoteMatchInfo:r}=await this.getRemoteModuleAndOptions({id:e}),{pkgNameOrAlias:l,remote:i,expose:c,id:d,remoteSnapshot:p}=r,u=await a.get(d,c,t,p),m=await this.hooks.lifecycle.onLoad.emit({id:d,pkgNameOrAlias:l,expose:c,exposeModule:n?u:void 0,exposeModuleFactory:n?void 0:u,remote:i,options:s,moduleInstance:a,origin:o});return this.setIdToRemoteMap(e,r),"function"==typeof m?m:u}catch(n){const{from:a="runtime"}=t||{from:"runtime"},s=await this.hooks.lifecycle.errorLoadRemote.emit({id:e,error:n,from:a,lifecycle:"onLoad",origin:o});if(!s)throw n;return s}}async preloadRemote(e){const{host:t}=this;await this.hooks.lifecycle.beforePreloadRemote.emit({preloadOps:e,options:t.options,origin:t});const o=(a=t.options.remotes,e.map(e=>{const t=function(e,t){for(const o of e){if(t===o.name)return o;if(o.alias&&t===o.alias)return o}}(a,e.nameOrAlias);return g(t,`Unable to preload ${e.nameOrAlias} as it is not included in ${!t&&(0,n.ML)({remoteInfo:t,remotes:a})}`),{remote:t,preloadConfig:We(e)}}));var a;await Promise.all(o.map(async e=>{const{remote:o}=e,n=Ge(o),{globalSnapshot:a,remoteSnapshot:s}=await t.snapshotHandler.loadRemoteSnapshotInfo({moduleInfo:o}),r=await this.hooks.lifecycle.generatePreloadAssets.emit({origin:t,preloadOptions:e,remote:o,remoteInfo:n,globalSnapshot:a,remoteSnapshot:s});r&&Ke(n,t,r)}))}registerRemotes(e,t){const{host:o}=this;e.forEach(e=>{this.registerRemote(e,o.options.remotes,{force:t?.force})})}async getRemoteModuleAndOptions(e){const{host:t}=this,{id:o}=e;let n;try{n=await this.hooks.lifecycle.beforeRequest.emit({id:o,options:t.options,origin:t})}catch(e){if(n=await this.hooks.lifecycle.errorLoadRemote.emit({id:o,options:t.options,origin:t,from:"runtime",error:e,lifecycle:"beforeRequest"}),!n)throw e}const{id:a}=n,s=function(e,t){for(const o of e){const e=t.startsWith(o.name);let n=t.replace(o.name,"");if(e){if(n.startsWith("/"))return n=`.${n}`,{pkgNameOrAlias:o.name,expose:n,remote:o};if(""===n)return{pkgNameOrAlias:o.name,expose:".",remote:o}}const a=o.alias&&t.startsWith(o.alias);let s=o.alias&&t.replace(o.alias,"");if(o.alias&&a){if(s&&s.startsWith("/"))return s=`.${s}`,{pkgNameOrAlias:o.alias,expose:s,remote:o};if(""===s)return{pkgNameOrAlias:o.alias,expose:".",remote:o}}}}(t.options.remotes,a);g(s,m(l,h,{hostName:t.options.name,requestId:a}));const{remote:r}=s,i=Ge(r),c=await t.sharedHandler.hooks.lifecycle.afterResolve.emit({id:a,...s,options:t.options,origin:t,remoteInfo:i}),{remote:d,expose:p}=c;g(d&&p,`The 'beforeRequest' hook was executed, but it failed to return the correct 'remote' and 'expose' values while loading ${a}.`);let u=t.moduleCache.get(d.name);const f={host:t,remoteInfo:i};return u||(u=new Ye(f),t.moduleCache.set(d.name,u)),{module:u,moduleOptions:f,remoteMatchInfo:c}}registerRemote(e,t,o){const{host:a}=this,s=()=>{if(e.alias){const o=t.find(t=>e.alias&&(t.name.startsWith(e.alias)||t.alias?.startsWith(e.alias)));g(!o,`The alias ${e.alias} of remote ${e.name} is not allowed to be the prefix of ${o&&o.name} name or alias`)}"entry"in e&&(0,n.OL)()&&!e.entry.startsWith("http")&&(e.entry=new URL(e.entry,window.location.origin).href),e.shareScope||(e.shareScope=z),e.type||(e.type=H)};this.hooks.lifecycle.beforeRegisterRemote.emit({remote:e,origin:a});const r=t.find(t=>t.name===e.name);if(r){const l=[`The remote "${e.name}" is already registered.`,"Please note that overriding it may cause unexpected errors."];o?.force&&(this.removeRemote(r),s(),t.push(e),this.hooks.lifecycle.registerRemote.emit({remote:e,origin:a}),(0,n.R8)(l.join(" ")))}else s(),t.push(e),this.hooks.lifecycle.registerRemote.emit({remote:e,origin:a})}removeRemote(e){try{const{host:t}=this,{name:o}=e,a=t.options.remotes.findIndex(e=>e.name===o);-1!==a&&t.options.remotes.splice(a,1);const s=t.moduleCache.get(e.name);if(s){const o=s.remoteInfo,a=o.entryGlobalName;B[a]&&(Object.getOwnPropertyDescriptor(B,a)?.configurable?delete B[a]:B[a]=void 0);const r=He(s.remoteInfo);I[r]&&delete I[r],t.snapshotHandler.manifestCache.delete(o.entry);let l=o.buildVersion?(0,n.lG)(o.name,o.buildVersion):o.name;const i=B.__FEDERATION__.__INSTANCES__.findIndex(e=>o.buildVersion?e.options.id===l:e.name===l);if(-1!==i){const e=B.__FEDERATION__.__INSTANCES__[i];l=e.options.id||l;const t=Re();let n=!0;const a=[];Object.keys(t).forEach(e=>{const s=t[e];s&&Object.keys(s).forEach(t=>{const r=s[t];r&&Object.keys(r).forEach(s=>{const l=r[s];l&&Object.keys(l).forEach(r=>{const i=l[r];i&&"object"==typeof i&&i.from===o.name&&(i.loaded||i.loading?(i.useIn=i.useIn.filter(e=>e!==o.name),i.useIn.length?n=!1:a.push([e,t,s,r])):a.push([e,t,s,r]))})})})}),n&&(e.shareScopeMap={},delete t[l]),a.forEach(([e,o,n,a])=>{delete t[e]?.[o]?.[n]?.[a]}),B.__FEDERATION__.__INSTANCES__.splice(i,1)}const{hostGlobalSnapshot:c}=lt(e,t);if(c){const t=c&&"remotesInfo"in c&&c.remotesInfo&&M(c.remotesInfo,e.name).key;t&&(delete c.remotesInfo[t],Boolean(x.__FEDERATION__.__MANIFEST_LOADING__[t])&&delete x.__FEDERATION__.__MANIFEST_LOADING__[t])}t.moduleCache.delete(e.name)}}catch(e){v.log("removeRemote fail: ",e)}}}class pt{constructor(e){this.hooks=new tt({beforeInit:new Ze("beforeInit"),init:new Je,beforeInitContainer:new et("beforeInitContainer"),initContainer:new et("initContainer")}),this.version="0.21.2",this.moduleCache=new Map,this.loaderHook=new tt({getModuleInfo:new Je,createScript:new Je,createLink:new Je,fetch:new Xe,loadEntryError:new Xe,getModuleFactory:new Xe}),this.bridgeHook=new tt({beforeBridgeRender:new Je,afterBridgeRender:new Je,beforeBridgeDestroy:new Je,afterBridgeDestroy:new Je});const t=[{name:"snapshot-plugin",async afterResolve(e){const{remote:t,pkgNameOrAlias:o,expose:n,origin:a,remoteInfo:s,id:r}=e;if(!E(t)||!_(t)){const{remoteSnapshot:l,globalSnapshot:i}=await a.snapshotHandler.loadRemoteSnapshotInfo({moduleInfo:t,id:r});ot(s,l);const c={remote:t,preloadConfig:{nameOrAlias:o,exposes:[n],resourceCategory:"sync",share:!1,depsRemote:!1}},d=await a.remoteHandler.hooks.lifecycle.generatePreloadAssets.emit({origin:a,preloadOptions:c,remoteInfo:s,remote:t,remoteSnapshot:l,globalSnapshot:i});return d&&Ke(s,a,d,!1),{...e,remoteSnapshot:l}}return e}},{name:"generate-preload-assets-plugin",async generatePreloadAssets(e){const{origin:t,preloadOptions:o,remoteInfo:a,remote:s,globalSnapshot:r,remoteSnapshot:l}=e;return(0,n.OL)()?E(s)&&_(s)?{cssAssets:[],jsAssetsWithoutEntry:[],entryAssets:[{name:s.name,url:s.entry,moduleInfo:{name:a.name,entry:s.entry,type:a.type||"global",entryGlobalName:"",shareScope:""}}]}:(ot(a,l),rt(t,o,a,r,l)):{cssAssets:[],jsAssetsWithoutEntry:[],entryAssets:[]}}}],o={id:"slider.editor:0.0.9",name:e.name,plugins:t,remotes:[],shared:{},inBrowser:(0,n.OL)()};this.name=e.name,this.options=o,this.snapshotHandler=new it(this),this.sharedHandler=new ct(this),this.remoteHandler=new dt(this),this.shareScopeMap=this.sharedHandler.shareScopeMap,this.registerPlugins([...o.plugins,...e.plugins||[]]),this.options=this.formatOptions(o,e)}initOptions(e){this.registerPlugins(e.plugins);const t=this.formatOptions(this.options,e);return this.options=t,t}async loadShare(e,t){return this.sharedHandler.loadShare(e,t)}loadShareSync(e,t){return this.sharedHandler.loadShareSync(e,t)}initializeSharing(e=z,t){return this.sharedHandler.initializeSharing(e,t)}initRawContainer(e,t,o){const n=Ge({name:e,entry:t}),a=new Ye({host:this,remoteInfo:n});return a.remoteEntryExports=o,this.moduleCache.set(e,a),a}async loadRemote(e,t){return this.remoteHandler.loadRemote(e,t)}async preloadRemote(e){return this.remoteHandler.preloadRemote(e)}initShareScopeMap(e,t,o={}){this.sharedHandler.initShareScopeMap(e,t,o)}formatOptions(e,t){const{shared:o}=Te(e,t),{userOptions:n,options:a}=this.hooks.lifecycle.beforeInit.emit({origin:this,userOptions:t,options:e,shareInfo:o}),s=this.remoteHandler.formatAndRegisterRemote(a,n),{shared:r}=this.sharedHandler.registerShared(a,n),l=[...a.plugins];n.plugins&&n.plugins.forEach(e=>{l.includes(e)||l.push(e)});const i={...e,...t,plugins:l,remotes:s,shared:r};return this.hooks.lifecycle.init.emit({origin:this,options:i}),i}registerPlugins(e){const t=function(e,t){const o=$.__FEDERATION__.__GLOBAL_PLUGIN__,n=[t.hooks,t.remoteHandler.hooks,t.sharedHandler.hooks,t.snapshotHandler.hooks,t.loaderHook,t.bridgeHook];return o.length>0&&o.forEach(t=>{e?.find(e=>e.name!==t.name)&&e.push(t)}),e&&e.length>0&&e.forEach(e=>{n.forEach(o=>{o.applyPlugin(e,t)})}),e}(e,this);this.options.plugins=this.options.plugins.reduce((e,t)=>t?(e&&!e.find(e=>e.name===t.name)&&e.push(t),e):e,t||[])}registerRemotes(e,t){return this.remoteHandler.registerRemotes(e,t)}registerShared(e){this.sharedHandler.registerShared(this.options,{...this.options,shared:e})}}function ut(e){const t=new(B.__FEDERATION__.__DEBUG_CONSTRUCTOR__||pt)(e);return function(e){B.__FEDERATION__.__INSTANCES__.push(e)}(t),t}let mt=null;function ht(e){const t=(o=e.name,n=e.version,B.__FEDERATION__.__INSTANCES__.find(e=>!("slider.editor:0.0.9"!==e.options.id&&(e.options.name!==o||e.options.version||n)&&(e.options.name!==o||!n||e.options.version!==n))));var o,n;return t?(t.initOptions(e),mt||(mt=t),t):(mt=ut(e),mt)}function ft(...e){return g(mt,m(u,h)),mt.loadRemote.apply(mt,e)}function vt(...e){return g(mt,m(u,h)),mt.loadShare.apply(mt,e)}function gt(...e){return g(mt,m(u,h)),mt.loadShareSync.apply(mt,e)}function yt(...e){return g(mt,m(u,h)),mt.preloadRemote.apply(mt,e)}function bt(...e){return g(mt,m(u,h)),mt.registerRemotes.apply(mt,e)}function kt(...e){return g(mt,m(u,h)),mt.registerPlugins.apply(mt,e)}function wt(){return mt}function Et(...e){return g(mt,m(u,h)),mt.registerShared.apply(mt,e)}!function(e,t=(0,n.Bb)()){t&&(B.__FEDERATION__.__DEBUG_CONSTRUCTOR__=e,B.__FEDERATION__.__DEBUG_CONSTRUCTOR_VERSION__="0.21.2")}(pt)},985:(e,t,o)=>{var n=o(828);const a=["script"];var s=o(615);function r(e){e.S&&!e.federation.hasAttachShareScopeMap&&e.federation.instance&&e.federation.instance.shareScopeMap&&(e.S=e.federation.instance.shareScopeMap,e.federation.hasAttachShareScopeMap=!0)}function l(e){const{webpackRequire:t,moduleToHandlerMapping:o}=e,{consumesLoadingData:n,initializeSharingData:a}=t;if(n&&!n._updated){const{moduleIdToConsumeDataMapping:t={},initialConsumes:a=[],chunkMapping:s={}}=n;if(Object.entries(t).forEach(([e,t])=>{o[e]||(o[e]={getter:t.fallback,shareInfo:{shareConfig:{requiredVersion:t.requiredVersion,strictVersion:t.strictVersion,singleton:t.singleton,eager:t.eager,layer:t.layer},scope:Array.isArray(t.shareScope)?t.shareScope:[t.shareScope||"default"]},shareKey:t.shareKey})}),"initialConsumes"in e){const{initialConsumes:t=[]}=e;a.forEach(e=>{t.includes(e)||t.push(e)})}if("chunkMapping"in e){const{chunkMapping:t={}}=e;Object.entries(s).forEach(([e,o])=>{t[e]||(t[e]=[]),o.forEach(o=>{t[e].includes(o)||t[e].push(o)})})}n._updated=1}if(a&&!a._updated){const{federation:e}=t;if(!e.instance||!a.scopeToSharingDataMapping)return;const o={};for(let[e,t]of Object.entries(a.scopeToSharingDataMapping))for(let n of t)if("object"==typeof n&&null!==n){const{name:t,version:a,factory:s,eager:r,singleton:l,requiredVersion:i,strictVersion:c}=n,d={requiredVersion:`^${a}`},p=function(e){return void 0!==e};p(l)&&(d.singleton=l),p(i)&&(d.requiredVersion=i),p(r)&&(d.eager=r),p(c)&&(d.strictVersion=c);const u={version:a,scope:[e],shareConfig:d,get:s};o[t]?o[t].push(u):o[t]=[u]}e.instance.registerShared(o),a._updated=1}}const i={runtime:n,instance:void 0,initOptions:void 0,bundlerRuntime:{remotes:function(e){!function(e){const{webpackRequire:t,idToExternalAndNameMapping:o={},idToRemoteMap:n={},chunkMapping:a={}}=e,{remotesLoadingData:s}=t,r=t.federation?.bundlerRuntimeOptions?.remotes?.remoteInfos;if(!s||s._updated||!r)return;const{chunkMapping:l,moduleIdToRemoteDataMapping:i}=s;if(l&&i){for(let[e,t]of Object.entries(i))if(o[e]||(o[e]=[t.shareScope,t.name,t.externalModuleId]),!n[e]&&r[t.remoteName]){const o=r[t.remoteName];n[e]||=[],o.forEach(t=>{n[e].includes(t)||n[e].push(t)})}a&&Object.entries(l).forEach(([e,t])=>{a[e]||(a[e]=[]),t.forEach(t=>{a[e].includes(t)||a[e].push(t)})}),s._updated=1}}(e);const{chunkId:t,promises:o,webpackRequire:n,chunkMapping:l,idToExternalAndNameMapping:i,idToRemoteMap:c}=e;r(n),n.o(l,t)&&l[t].forEach(e=>{let t=n.R;t||(t=[]);const r=i[e],l=c[e]||[];if(t.indexOf(r)>=0)return;if(t.push(r),r.p)return o.push(r.p);const d=t=>{t||(t=new Error("Container missing")),"string"==typeof t.message&&(t.message+=`\nwhile loading "${r[1]}" from ${r[2]}`),n.m[e]=()=>{throw t},r.p=0},p=(e,t,n,a,s,l)=>{try{const i=e(t,n);if(!i||!i.then)return s(i,a,l);{const e=i.then(e=>s(e,a),d);if(!l)return e;o.push(r.p=e)}}catch(e){d(e)}};var u=(e,o,n)=>p(o.get,r[1],t,0,m,n),m=t=>{r.p=1,n.m[e]=e=>{e.exports=t()}};1===l.length&&a.includes(l[0].externalType)&&l[0].name?p(()=>{try{const e=(0,s.e4)(l[0].name,s.yq)+r[1].slice(1),t=n.federation.instance,o=()=>n.federation.instance.loadRemote(e,{loadFactory:!1,from:"build"});return"version-first"===t.options.shareStrategy?Promise.all(t.sharedHandler.initializeSharing(r[0])).then(()=>o()):o()}catch(e){d(e)}},r[2],0,0,m,1):p(n,r[2],0,0,(e,t,o)=>e?p(n.I,r[0],0,e,u,o):d(),1)})},consumes:function(e){l(e);const{chunkId:t,promises:o,installedModules:n,webpackRequire:a,chunkMapping:s,moduleToHandlerMapping:i}=e;r(a),a.o(s,t)&&s[t].forEach(e=>{if(a.o(n,e))return o.push(n[e]);const t=t=>{n[e]=0,a.m[e]=o=>{delete a.c[e];const n=t(),{shareInfo:s}=i[e];if(s?.shareConfig?.layer&&n&&"object"==typeof n)try{n.hasOwnProperty("layer")&&void 0!==n.layer||(n.layer=s.shareConfig.layer)}catch(e){}o.exports=n}},s=t=>{delete n[e],a.m[e]=o=>{throw delete a.c[e],t}};try{const r=a.federation.instance;if(!r)throw new Error("Federation instance not found!");const{shareKey:l,getter:c,shareInfo:d}=i[e],p=r.loadShare(l,{customShareInfo:d}).then(e=>!1===e?c():e);p.then?o.push(n[e]=p.then(t).catch(s)):t(p)}catch(e){s(e)}})},I:function({shareScopeName:e,webpackRequire:t,initPromises:o,initTokens:n,initScope:s}){const l=Array.isArray(e)?e:[e];var i=[];return l.forEach(l=>{i.push(function(l){s||(s=[]);const i=t.federation.instance;var c=n[l];if(c||(c=n[l]={from:i.name}),s.indexOf(c)>=0)return;s.push(c);const d=o[l];if(d)return d;var p=o=>{var n=e=>{return t="Initialization of sharing external failed: "+e,"undefined"!=typeof console&&console.warn&&console.warn(t);var t};try{var a=t(o);if(!a)return;var r=o=>o&&o.init&&o.init(t.S[l],s,{shareScopeMap:t.S||{},shareScopeKeys:e});if(a.then)return u.push(a.then(r,n));var i=r(a);if(i&&"boolean"!=typeof i&&i.then)return u.push(i.catch(n))}catch(e){n(e)}};const u=i.initializeSharing(l,{strategy:i.options.shareStrategy,initScope:s,from:"build"});r(t);const m=t.federation.bundlerRuntimeOptions.remotes;return m&&Object.keys(m.idToRemoteMap).forEach(e=>{const t=m.idToRemoteMap[e],o=m.idToExternalAndNameMapping[e][2];if(t.length>1)p(o);else if(1===t.length){const e=t[0];a.includes(e.externalType)||p(o)}}),u.length?o[l]=Promise.all(u).then(()=>o[l]=!0):o[l]=!0}(l))}),Promise.all(i).then(()=>!0)},S:{},installInitialConsumes:function(e){const{webpackRequire:t}=e;l(e);const{initialConsumes:o,moduleToHandlerMapping:n,installedModules:a}=e;o.forEach(e=>{t.m[e]=o=>{a[e]=0,delete t.c[e];const s=function(e){const{moduleId:t,moduleToHandlerMapping:o,webpackRequire:n}=e,a=n.federation.instance;if(!a)throw new Error("Federation instance not found!");const{shareKey:s,shareInfo:r}=o[t];try{return a.loadShareSync(s,{customShareInfo:r})}catch(e){throw console.error('loadShareSync failed! The function should not be called unless you set "eager:true". If you do not set it, and encounter this issue, you can check whether an async boundary is implemented.'),console.error("The original error message is as follows: "),e}}({moduleId:e,moduleToHandlerMapping:n,webpackRequire:t});if("function"!=typeof s)throw new Error(`Shared module is not available for eager consumption: ${e}`);const r=s(),{shareInfo:l}=n[e];if(l?.shareConfig?.layer&&r&&"object"==typeof r)try{r.hasOwnProperty("layer")&&void 0!==r.layer||(r.layer=l.shareConfig.layer)}catch(e){}o.exports=r}})},initContainerEntry:function(e){const{webpackRequire:t,shareScope:o,initScope:n,shareScopeKey:a,remoteEntryInitOptions:s}=e;if(!t.S)return;if(!t.federation||!t.federation.instance||!t.federation.initOptions)return;const r=t.federation.instance;r.initOptions({name:t.federation.initOptions.name,remotes:[],...s});const l=s?.shareScopeKeys,i=s?.shareScopeMap;if(a&&"string"!=typeof a)a.forEach(e=>{if(!l||!i)return void r.initShareScopeMap(e,o,{hostShareScopeMap:s?.shareScopeMap||{}});i[e]||(i[e]={});const t=i[e];r.initShareScopeMap(e,t,{hostShareScopeMap:s?.shareScopeMap||{}})});else{const e=a||"default";Array.isArray(l)?l.forEach(e=>{i[e]||(i[e]={});const t=i[e];r.initShareScopeMap(e,t,{hostShareScopeMap:s?.shareScopeMap||{}})}):r.initShareScopeMap(e,o,{hostShareScopeMap:s?.shareScopeMap||{}})}return t.federation.attachShareScopeMap&&t.federation.attachShareScopeMap(t),"function"==typeof t.federation.prefetch&&t.federation.prefetch(),Array.isArray(a)?Boolean(t.federation.initOptions.shared)?t.I(a,n):Promise.all(a.map(e=>t.I(e,n))).then(()=>!0):t.I(a||"default",n)}},attachShareScopeMap:r,bundlerRuntimeOptions:{}};if(!o.federation.runtime){var c=o.federation;for(var d in o.federation={},i)o.federation[d]=i[d];for(var d in c)o.federation[d]=c[d]}o.federation.instance||(o.federation.instance=o.federation.runtime.init(o.federation.initOptions),o.federation.attachShareScopeMap&&o.federation.attachShareScopeMap(o),o.federation.installInitialConsumes&&o.federation.installInitialConsumes(),!o.federation.isMFRemote&&o.federation.prefetch&&o.federation.prefetch())}},__webpack_module_cache__={},deferred,inProgress,dataWebpackPrefix,prevStartup,hasRun;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var o=__webpack_module_cache__[e]={exports:{}},n={id:e,module:o,factory:__webpack_modules__[e],require:__webpack_require__};return __webpack_require__.i.forEach(function(e){e(n)}),o=n.module,n.factory.call(o.exports,o,o.exports,n.require),o.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.c=__webpack_module_cache__,__webpack_require__.i=[],__webpack_require__.x=e=>{},__webpack_require__.federation||(__webpack_require__.federation={initOptions:{name:"slider.editor",remotes:[],shareStrategy:"version-first"},chunkMatcher:function(e){return!0},rootOutputDir:"",bundlerRuntimeOptions:{remotes:{remoteInfos:{},webpackRequire:__webpack_require__,idToRemoteMap:{},chunkMapping:{},idToExternalAndNameMapping:{}}}},__webpack_require__.consumesLoadingData={},__webpack_require__.remotesLoadingData={}),deferred=[],__webpack_require__.O=(e,t,o,n)=>{if(!t){var a=1/0;for(i=0;i<deferred.length;i++){for(var[t,o,n]=deferred[i],s=!0,r=0;r<t.length;r++)(!1&n||a>=n)&&Object.keys(__webpack_require__.O).every(e=>__webpack_require__.O[e](t[r]))?t.splice(r--,1):(s=!1,n<a&&(a=n));if(s){deferred.splice(i--,1);var l=o();void 0!==l&&(e=l)}}return e}n=n||0;for(var i=deferred.length;i>0&&deferred[i-1][2]>n;i--)deferred[i]=deferred[i-1];deferred[i]=[t,o,n]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var o in t)__webpack_require__.o(t,o)&&!__webpack_require__.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce((t,o)=>(__webpack_require__.f[o](e,t),t),[])),__webpack_require__.u=e=>e+"."+{689:"1adc1670",833:"d3c05d4d",920:"53051b9e"}[e]+".chunk.js",__webpack_require__.miniCssF=e=>e+".css",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="@reneos/slider.editor:",__webpack_require__.l=(e,t,o,n)=>{if(inProgress[e])inProgress[e].push(t);else{var a,s;if(void 0!==o)for(var r=document.getElementsByTagName("script"),l=0;l<r.length;l++){var i=r[l];if(i.getAttribute("src")==e||i.getAttribute("data-webpack")==dataWebpackPrefix+o){a=i;break}}a||(s=!0,(a=document.createElement("script")).charset="utf-8",__webpack_require__.nc&&a.setAttribute("nonce",__webpack_require__.nc),a.setAttribute("data-webpack",dataWebpackPrefix+o),a.src=e),inProgress[e]=[t];var c=(t,o)=>{a.onerror=a.onload=null,clearTimeout(d);var n=inProgress[e];if(delete inProgress[e],a.parentNode&&a.parentNode.removeChild(a),n&&n.forEach(e=>e(o)),t)return t(o)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=c.bind(null,a.onerror),a.onload=c.bind(null,a.onload),s&&document.head.appendChild(a)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{__webpack_require__.S={};var e={},t={};__webpack_require__.I=(o,n)=>{n||(n=[]);var a=t[o];if(a||(a=t[o]={}),!(n.indexOf(a)>=0)){if(n.push(a),e[o])return e[o];__webpack_require__.o(__webpack_require__.S,o)||(__webpack_require__.S[o]={});var s=__webpack_require__.S[o],r="@reneos/slider.editor",l=(e,t,o,n)=>{var a=s[e]=s[e]||{},l=a[t];(!l||!l.loaded&&(!n!=!l.eager?n:r>l.from))&&(a[t]={get:o,from:r,eager:!!n})},i=[];return"default"===o&&(l("@reneos/app","1.0.6",()=>()=>__webpack_require__(302),1),l("three","0.181.0",()=>()=>__webpack_require__(815),1),l("vue","3.5.22",()=>()=>__webpack_require__(68),1),l("vue","3.5.22",()=>()=>__webpack_require__(31),1)),e[o]=i.length?Promise.all(i).then(()=>e[o]=1):1}}})(),(()=>{__webpack_require__.federation.initOptions.shared={"@reneos/app":[{version:"1.0.6",get:()=>()=>__webpack_require__(302),scope:["default"],shareConfig:{eager:!0,requiredVersion:"1.0.6",singleton:!0,layer:null}}],three:[{version:"0.181.0",get:()=>()=>__webpack_require__(815),scope:["default"],shareConfig:{eager:!0,singleton:!0,layer:null}}],vue:[{version:"3.5.22",get:()=>()=>__webpack_require__(68),scope:["default"],shareConfig:{eager:!0,singleton:!0,layer:null}}]},__webpack_require__.S={};var e={},t={};__webpack_require__.I=(o,n)=>__webpack_require__.federation.bundlerRuntime.I({shareScopeName:o,webpackRequire:__webpack_require__,initPromises:e,initTokens:t,initScope:n})})(),__webpack_require__.p="/editor/",(()=>{var e={};__webpack_require__.consumesLoadingData.moduleIdToConsumeDataMapping={15:{fallback:()=>()=>__webpack_require__(31),shareScope:["default"],singleton:!0,requiredVersion:"",strictVersion:!1,eager:!0,layer:void 0,shareKey:"vue"},875:{fallback:()=>()=>__webpack_require__(815),shareScope:["default"],singleton:!0,requiredVersion:"",strictVersion:!1,eager:!0,layer:void 0,shareKey:"three"},334:{fallback:()=>()=>__webpack_require__(68),shareScope:["default"],singleton:!0,requiredVersion:"^3.5.22",strictVersion:!1,eager:!0,layer:void 0,shareKey:"vue"},117:{fallback:()=>()=>__webpack_require__(815),shareScope:["default"],singleton:!0,requiredVersion:!1,strictVersion:!1,eager:!0,layer:void 0,shareKey:"three"},320:{fallback:()=>()=>__webpack_require__(302),shareScope:["default"],singleton:!0,requiredVersion:"1.0.6",strictVersion:!1,eager:!0,layer:void 0,shareKey:"@reneos/app"}};var t={};__webpack_require__.consumesLoadingData.initialConsumes=[15,875,334,117,320],__webpack_require__.federation.installInitialConsumes=()=>__webpack_require__.federation.bundlerRuntime.installInitialConsumes({initialConsumes:__webpack_require__.consumesLoadingData.initialConsumes,installedModules:e,moduleToHandlerMapping:t,webpackRequire:__webpack_require__}),__webpack_require__.consumesLoadingData.chunkMapping={792:[15,875,334,117,320]},__webpack_require__.f.consumes=(o,n)=>{__webpack_require__.federation.bundlerRuntime.consumes({chunkMapping:__webpack_require__.consumesLoadingData.chunkMapping,installedModules:e,chunkId:o,moduleToHandlerMapping:t,promises:n,webpackRequire:__webpack_require__})}})(),(()=>{if("undefined"!=typeof document){var e={792:0};__webpack_require__.f.miniCss=(t,o)=>{e[t]?o.push(e[t]):0!==e[t]&&{689:1,833:1,920:1}[t]&&o.push(e[t]=(e=>new Promise((t,o)=>{var n=__webpack_require__.miniCssF(e),a=__webpack_require__.p+n;if(((e,t)=>{for(var o=document.getElementsByTagName("link"),n=0;n<o.length;n++){var a=(r=o[n]).getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(a===e||a===t))return r}var s=document.getElementsByTagName("style");for(n=0;n<s.length;n++){var r;if((a=(r=s[n]).getAttribute("data-href"))===e||a===t)return r}})(n,a))return t();((e,t,o,n,a)=>{var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",__webpack_require__.nc&&(s.nonce=__webpack_require__.nc),s.onerror=s.onload=o=>{if(s.onerror=s.onload=null,"load"===o.type)n();else{var r=o&&o.type,l=o&&o.target&&o.target.href||t,i=new Error("Loading CSS chunk "+e+" failed.\n("+r+": "+l+")");i.name="ChunkLoadError",i.code="CSS_CHUNK_LOAD_FAILED",i.type=r,i.request=l,s.parentNode&&s.parentNode.removeChild(s),a(i)}},s.href=t,document.head.appendChild(s)})(e,a,0,t,o)}))(t).then(()=>{e[t]=0},o=>{throw delete e[t],o}))}}})(),prevStartup=__webpack_require__.x,hasRun=!1,__webpack_require__.x=()=>{if(hasRun||(hasRun=!0,__webpack_require__(985)),"function"==typeof prevStartup)return prevStartup();console.warn("[Module Federation] prevStartup is not a function, skipping startup execution")},(()=>{var e={792:0};__webpack_require__.f.j=(t,o)=>{var n=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==n)if(n)o.push(n[2]);else{var a=new Promise((o,a)=>n=e[t]=[o,a]);o.push(n[2]=a);var s=__webpack_require__.p+__webpack_require__.u(t),r=new Error;__webpack_require__.l(s,o=>{if(__webpack_require__.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var a=o&&("load"===o.type?"missing":o.type),s=o&&o.target&&o.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",r.name="ChunkLoadError",r.type=a,r.request=s,n[1](r)}},"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,o)=>{var n,a,[s,r,l]=o,i=0;if(s.some(t=>0!==e[t])){for(n in r)__webpack_require__.o(r,n)&&(__webpack_require__.m[n]=r[n]);if(l)var c=l(__webpack_require__)}for(t&&t(o);i<s.length;i++)a=s[i],__webpack_require__.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return __webpack_require__.O(c)},o=self.webpackChunk_reneos_slider_editor=self.webpackChunk_reneos_slider_editor||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})(),__webpack_require__.x();var __webpack_exports__=__webpack_require__.O(void 0,[333,489,753,776],()=>__webpack_require__(734));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();