"use strict";(self.webpackChunk_reneos_slider_editor_engine=self.webpackChunk_reneos_slider_editor_engine||[]).push([[876],{351:(e,t,a)=>{a.d(t,{A:()=>s});const s=class{constructor(){this._events={"*":[]}}subs(e,t,a){null==this._events[e]&&(this._events[e]=[]),this._events[e].push({handler:a,once:t})}on(e,t){this.subs(e,!1,t)}once(e,t){this.subs(e,!0,t)}off(e,t){const a=this._events[e];if(a){for(let e=a.length-1;e>=0;e--)a[e].handler===t&&a.splice(e,1);0===a.length&&delete this._events[e]}}clear(e){this._events[e]=[]}clearAll(){this._events={"*":[]}}emit(e,...t){const a=[];this._events[e]&&a.push(...this._events[e]),this._events["*"].length&&a.push(...this._events["*"].map(t=>({handler:t.handler.bind(this,e),once:t.once})));for(let e=a.length-1;e>=0;e--){const s=a[e];s.handler.apply(null,t),s.once&&a.splice(e,1)}}addEventListener(e,t){this.on(e,t)}removeEventListener(e,t){this.off(e,t)}}},876:(e,t,a)=>{a.r(t),a.d(t,{ActionsManager:()=>_,AssetsManager:()=>m,CssManager:()=>Me,Factory:()=>C,MouseManager:()=>N,Project:()=>ue,THREE:()=>n});var s=a(909),n=a.t(s,2),i=a(351);class r extends i.A{constructor(e){super(),this.isAsset=!0,this.uses={},this.data=e||{},this._clones=[],this.promise=null,this.progress=0,this._resource=null}get url(){return this.data.url}get uid(){return this.data.uid}get type(){return this.data.type}get name(){return this.data.name}set name(e){this.data.name=e}get resource(){return this._resource}async getResource(){if(this.data.clone){const e=this._resource.clone();return e.uid=`${this.uid}_${Date.now()}`,this._clones.push(e),e.traverse(e=>{e.visible=!0}),e}return this._resource}get clone(){return this.data.clone}set clone(e){this.data.clone=e}async load(){}update(){}async update(e,t){this.data[e]=t,this.emit("update",this)}destroy(){this._clones.forEach(e=>{e.parent&&e.parent.remove(e)}),this.emit("destroy",this)}getTypes(){return["asset"]}}const o=r;var c=a(92);var l=a(449);const d=new Map,u={model:class extends o{constructor(e){super(e),this.envMap=e.envMap}get shadow(){return this.data.shadow||{}}set shadow(e){this.data.shadow=e}getTypes(){return[...super.getTypes(),"model"]}_updateEnvMap(e){this.data.envMap=e?e.uid:null;const t=e?e.resource:null;for(let e=0;e<this._clones.length;e++)this._clones[e].traverse(e=>{e.isMesh&&(e.material.envMap=t)});this._resource.traverse(e=>{e.isMesh&&(e.material.envMap=t)})}async _setEnvMap(e,t=!1){if(t||!e||e!==this.data.envMap){const t=this.data.envMap;let a=this.uses[t];if(a&&(delete this.uses[t],a.off("destroy",this._updateEnvMap.bind(this,null)),a.off("update",this._updateEnvMap.bind(this))),delete this.data.envMap,a=null,e){const t=this.data.envMap=e;if(a=this.uses[t]=await m.FindAsset(t),!a)return;a.on("destroy",this._updateEnvMap.bind(this,null)),a.on("update",this._updateEnvMap.bind(this))}this._updateEnvMap(a)}}load(e){return new Promise(async t=>{const a=new s.LoadingManager;a.onStart=function(){},a.onProgress=function(t,a,s){const n=Math.round(a/s*100);e&&e(n)},a.onLoad=function(){};const n=new c.B(a);n.setResourcePath(this.url.replace(/[^/]*$/,""));const i=await n.loadAsync(this.url);this._resource=i.scene.children.length>1?i.scene:i.scene.children[0],this._resource.uid=this.uid,this.data.position&&this._resource.position.copy(this.data.position),this.data.rotation&&this._resource.rotation.set(this.data.rotation.x,this.data.rotation.y,this.data.rotation.z,"XYZ"),this.data.scale&&this._resource.scale.copy(this.data.scale),await this._setEnvMap(this.data.envMap,!0),this._resource.traverse(e=>{e.isMesh&&(e.castShadow=this.data.shadow?.cast||!1,e.receiveShadow=this.data.shadow?.receive||!1,e.geometry.computeBoundingBox())}),this.emit("change",this),t()})}async update(e,t){switch(e){case"url":await this.load();break;case"envMap":await this._setEnvMap(t);break;default:this._resource.traverse(e=>{e.isMesh&&(e.castShadow=this.data.shadow?.cast||!1,e.receiveShadow=this.data.shadow?.receive||!1)})}super.update(e,t)}setTo(e){e.isObject3D&&e.add(this.resource)}},image:class extends o{constructor(e){super(e),this.uses={}}getTypes(){return[...super.getTypes(),"image"]}get name(){return this.data.name||this.uid}set name(e){this.data.name=e}async load(){console.log("load texture");const e=await m.Load(this,{type:"blob"}),t=await createImageBitmap(e),a=new s.CanvasTexture(t);a.colorSpace=s.SRGBColorSpace,a.encoding=s.sRGBEncoding,a.flipY=!0,a.flipX=!0,this._resource=a,this._resource.uid=this.uid,console.log(this._resource)}async update(e,t){"url"===e&&await this.load(),super.update(e,t)}},hdr:class extends o{constructor(e){super(e)}set url(e){this.data.url=e,this.load()}getTypes(){return[...super.getTypes(),"hdr"]}load(){return new Promise(e=>{(new l.Y).load(this.data.url,t=>{console.log(t),t.mapping=s.EquirectangularReflectionMapping,this._resource=t,this._resource.asset=this,this._resource.uid=this.uid,this.emit("update",this),e()})})}async update(e,t,a){if(this.data[t]=e[t],"url"===t)return this.load(a)}}};let h=async(e,t={type:"text"})=>{const a=await fetch(e.url);return await a[t.type]()};class p{static get Assets(){return d}static SetLoader(e){h=e}static async Init(e,t){const a=[],s=[];for(let t=0;t<e.length;t++){const a=p.Add(e[t]);s.push(a)}const n=[];for(let e=0;e<s.length;e++){const i=s[e];n.push(0),a.push(i.load(a=>{n[e]=a,t&&t(n.reduce((e,t)=>e+t,0)/n.length)}))}try{await Promise.allSettled(a)}catch(e){console.warn(e)}}static GetAsset(e){return d.get(e)}static GetAssets(e){const t=new Set(e);return[...d.values()].filter(e=>t.has(e.uid))}static GetResource(e){console.log(e);const t=d.get(e);if(t)return t.resource?t.getResource():(t.promise||(t.promise=new Promise(async e=>{await t.load(),e(t.getResource())})),t.promise)}static FindAsset(e){const t=d.get(e);if(t)return t.resource?t:(t.promise||(t.promise=new Promise(async e=>{await t.load(),e(t)})),t.promise)}static async SetResourceTo(e,t,a){const s=d.get(a);if(s.resource)return e[t]=s.resource,void(s.uses[e.uid]=t);s.promise||(s.promise=s.load());try{await s.promise()}catch(e){console.warn(e)}e[t]=s.resource,s.uses[e.uid]=t}static async SetAssetTo(e,t){const a=d.get(t.uid);if(a.resource)a.setTo&&a.setTo(e);else{a.promise||(a.promise=a.load());try{await a.promise()}catch(e){console.warn(e)}a.setTo(e)}}static Load(e,t){return h(e,t)}static Add(e){const t=new(0,u[e.type])(e);return d.set(t.uid,t),t}static async Update(e,t,a){const s=d.get(e.uid);if(s)try{await s.update(t,a)}catch(e){console.warn(e)}}static Remove(e){d.has(e)&&(d.get(e).destroy(),d.delete(e))}}const m=p;s.Color.prototype.encode=function(){return{type:"Color",args:[`#${this.getHexString()}`]}},s.Vector2.prototype.encode=function(){return{type:"Vector2",args:[this.x,this.y]}},s.Vector3.prototype.encode=function(){return{type:"Vector3",args:[this.x,this.y,this.z]}},s.Vector4.prototype.encode=function(){return{type:"Vector4",args:[this.x,this.y,this.z,this.w]}},s.Object3D.prototype.getTypes=function(){return["Object3D"]},s.Group.prototype.getTypes=function(){return["Object3D","Group"]},s.Mesh.prototype.getTypes=function(){return["Object3D","Mesh"]},s.DirectionalLight.prototype.getTypes=function(){return["Object3D","Light","DirectionalLight"]},s.AmbientLight.prototype.getTypes=function(){return["Object3D","Light","AmbientLight"]},s.Camera.prototype.getTypes=function(){return["Object3D","Camera"]},s.PerspectiveCamera.prototype.getTypes=function(){return["Object3D","Camera","PerspectiveCamera"]},s.OrthographicCamera.prototype.getTypes=function(){return["Object3D","Camera","OrthographicCamera"]};const g={PlaneGeometry:s.PlaneGeometry,SphereGeometry:s.SphereGeometry,BoxGeometry:s.BoxGeometry,BufferGeometry:s.BufferGeometry,Group:s.Group,Object3D:s.Object3D,PerspectiveCamera:s.PerspectiveCamera,OrthographicCamera:s.OrthographicCamera,InstancedMesh:s.InstancedMesh,Mesh:s.Mesh,DirectionalLight:s.DirectionalLight,AmbientLight:s.AmbientLight,Color:s.Color,Vector3:s.Vector3,Vector2:s.Vector2,Quaternion:s.Quaternion,Matrix4:s.Matrix4,MeshLambertMaterial:s.MeshLambertMaterial,MeshPhysicalMaterial:s.MeshPhysicalMaterial,MeshStandardMaterial:s.MeshStandardMaterial,BufferAttribute:s.BufferAttribute},y=[{label:"Object 3D",type:"Object3D"},{label:"Mesh",type:"Mesh"},{label:"Group",type:"Group"},{label:"Directional Light",type:"DirectionalLight"},{label:"Ambient Light",type:"AmbientLight"},{label:"Perspective Camera",type:"PerspectiveCamera",onchange(e){e.updateProjectionMatrix()}},{label:"Orthographic Camera",type:"OrthographicCamera",onchange(e){e.updateProjectionMatrix(),window.Editor.CameraHelper.update()}}],w={},f={},v=[{label:"Label 2D",type:"label2d",module:()=>a.e(736).then(a.bind(a,736))},{label:"Video Plane",type:"videoplane",module:()=>a.e(241).then(a.bind(a,241))}],b=new i.A;class M{static get Elements(){return f}static RegisterElement(e,t,a={}){console.log(e),v.push({label:e,type:e,module:t,...a})}static Find(e){return f[e]}static CheckUseAsset(e){return Object.values(f).reduce((t,a)=>t+(a.data.assets?.some(t=>t.uid===e)?1:0),0)}static get TreeTypes(){return y}static GetTypes(){return[...v,...y]}static GetType(e){return v.find(t=>t.type===e)?.module}static AddTemplate(e){w[e.id]=e}static AddTemplates(e){e.forEach(e=>{w[e.id]=e})}static GetElementProp(e,t){let a=f[e];const s=t.split(".");for(let e=0;e<s.length;e++)a=a[s[e]];return a}static async UpdateElement(e,t){const a=f[e];Object.keys(t).forEach(async e=>{a[e]=await M.CreateElement(t[e])})}static async CreateElement(e){if(null==e)return null;let t=e;if("object"==typeof e){const{type:a,properties:s,asset:n}=e;if(a){let n;const{args:i,...r}=e,o=v.find(e=>e.type===a);if(o){const e=await o.module();n=e.default||e}else g[a]&&(n=g[a]);if(Array.isArray(i)){const e=await Promise.all(i.map(e=>M.CreateElement(e)));t=new n(...e)}else t=i?new n(Object.fromEntries(await Promise.all(Object.entries(i).map(async([e,t])=>[e,await M.CreateElement(t)])))):g[a]?new n:new n(r);if(g[a]&&(t.data=e),r.assets?.length){t.assets=[...r.assets];for(let e=0;e<r.assets.length;e++)m.SetAssetTo(t,r.assets[e])}t.isObject3D&&!t.isElement&&(t.isElement=!0,t.type=a,t.model=t,t.properties=s||{},t.states=e.states||{},t.actions=r.actions||[])}else n&&(t=await m.GetResource(n));s&&await Promise.all(Object.entries(s).map(async([e,a])=>{t[e]=await M.CreateElement(a)}))}return t}static async BuildElements(e,t){const a=[];for(let s=0;s<e.length;s++){const n=e[s],i=await M.BuildElement(n,t);a.push(i)}return a}static async BuildElement(e,t){if(console.log(e),!t)return void console.warn("No find container");const a=structuredClone(w[e.template]?{...w[e.template],...e}:JSON.parse(JSON.stringify(e))),{uid:s,name:n}=a,i=await M.CreateElement(a);if(i){if(i.uid=s||`element${Date.now()}`,i.name=n||"",i.paths=t.paths?[...t.paths,i.uid]:[i.uid],i.path=i.paths.join("."),i.blocked={},t){const e=v.find(e=>e.type===i.type);if(e?.verifyparent&&!e.verifyparent(t))return;const a=v.find(e=>e.type===t.type);if(a?.verifychild&&!a.verifychild(i))return;(t.addChild||t.add).bind(t)(i)}return e.position&&i.position.copy(e.position),e.children&&await M.BuildElements(e.children,i),f[i.uid]=i,i.init&&await i.init(),b.emit("create",i),i}}static async RemoveModel(e){f[e]&&delete f[e]}static async AddAsset(e,t){const a=m.GetAsset(t.uid);await m.GetResource(t.uid),f[e].setAsset(a,t)}static RemoveAsset(e,t){f[e].removeAsset(t)}}const C=new Proxy(M,{get:(e,t)=>t in e?e[t]:b[t]}),x={},E=[];async function S(e,t){for(const a of e)try{const e=E.find(e=>e.uid===a.uid);await e.handler({...e,...a},t,window.isEditor),a.actions&&await S(a.actions,t)}catch(e){console.warn(e)}}class A{static get Library(){return E}static Init(e){for(let t=0;t<e.length;t++)A.Add(e[t])}static Add(e){e.handler=x[e.type],E.push(e)}static Remove(e){}static GetAction(e){return x[e]}static RegisterAction(e,t){x[e]=t,E.forEach(t=>{t.type===e&&(t.handler=x[t.type])})}static async Run(e=[],t,a){const s=e.filter(e=>e.hook===a);0!==s.length&&await S(s,t)}static async Execute(e,t){const a=[];for(let s=0;s<e.length;s++){const n=e[s];if(n.actions?.length){const e=n.actions.filter(e=>e.hook===t);e.length&&a.push(S(e,n))}}a.length>0&&await Promise.all(a)}}const _=A;function P(e){for(;e;){if(e.isElement)return e;e=e.parent}return null}Array.prototype.remove=function(e){const t=this.findIndex(t=>t===e);if(t>=0)return this.splice(t,1)[0]};var T=a(24),k=a(0);let R,O;const j=class{static MoveTo(e,t){const a={position:new s.Vector3,time:1e3,...e,control:!1},n={position:new s.Vector3,time:1e3,...t,control:!1};R.enabled=!1;const i=Workspace.Camera.position.clone(),r=R.target.clone();a.control=a.time>n.time,n.control=n.time>=a.time;const o=new Tween(i).to(a.position,a.time).easing(Easing.Quadratic.InOut).onUpdate(()=>{Workspace.Camera.position.copy(i),Workspace.Camera.updateProjectionMatrix(),R.update()}).onComplete(()=>{a.control&&(R.enabled=!0),tweengroup.remove(o)}).start(),c=new Tween(r).to(n.position,n.time).easing(Easing.Quadratic.InOut).onUpdate(()=>{R.target.copy(r),R.getPolarAngle()>R.maxPolarAngle&&R.target.setY(center.y+Math.cos(R.maxPolarAngle)*distance)}).onComplete(()=>{n.control&&(R.enabled=!0),tweengroup.remove(c)}).start();tweengroup.add(o,c)}static SetState(e){R.enabled=e}static Init({canvas:e},t,a){R=new T.N(t,e),R.enabled=!0,R.enableDamping=!0,R.dampingFactor=.25,R.screenSpacePanning=!1,R.minDistance=.01,R.maxDistance=500,O=new k.ZU(t,e),O.addEventListener("dragging-changed",e=>{R.enabled=!e.value});const n=O.getHelper();a.add(n),O.getRaycaster().layers.set(1),n.traverse(e=>{e.layers.set(1)}),window.addEventListener("keydown",e=>{switch(R.enabled=!e.ctrlKey,e.code){case"KeyQ":O.setSpace("local"===O.space?"world":"local");break;case"Shift":O.setTranslationSnap(1),O.setRotationSnap(s.MathUtils.degToRad(15)),O.setScaleSnap(.25);break;case"KeyW":O.setMode("translate");break;case"KeyE":O.setMode("rotate");break;case"KeyR":O.setMode("scale");break;case"KeyC":case"KeyV":break;case"+":case"=":O.setSize(O.size+.1);break;case"-":case"_":O.setSize(Math.max(O.size-.1,.1));break;case"KeyX":O.showX=!O.showX;break;case"KeyY":O.showY=!O.showY;break;case"KeyZ":O.showZ=!O.showZ;break;case" ":O.enabled=!O.enabled;break;case"Escape":O.reset()}}),window.addEventListener("keyup",e=>{R.enabled=!e.ctrlKey,"Shift"===e.key&&(O.setTranslationSnap(null),O.setRotationSnap(null),O.setScaleSnap(null))})}static get Transformer(){return O}static Select(e){e?O.attach(e):O.detach()}static Update(e){R.update(e)}static FitTo({center:e,radius:t}){const a=s.MathUtils.degToRad(Workspace.Camera.fov),n=t/Math.sin(a/2),i=(new s.Vector3).subVectors(Workspace.Camera.position,e).normalize(),r=e.clone().add(i.multiplyScalar(n)),o=Workspace.Camera.position.clone();R.enabled=!1;const c=R.target.clone(),l=new Tween(c).to(e,1e3).easing(Easing.Quadratic.InOut).onUpdate(()=>{R.target.copy(c),R.getPolarAngle()>R.maxPolarAngle&&R.target.setY(e.y+Math.cos(R.maxPolarAngle)*distance)}).start(),d=new Tween(o).to(r,1e3).easing(Easing.Quadratic.InOut).onUpdate(()=>{Workspace.Camera.position.copy(o);const t=Workspace.Camera.position.distanceTo(e);t<R.minDistance?Workspace.Camera.position.copy(e.clone().add(i.clone().multiplyScalar(R.minDistance))):t>R.maxDistance&&Workspace.Camera.position.copy(e.clone().add(i.clone().multiplyScalar(R.maxDistance))),Workspace.Camera.updateProjectionMatrix(),R.update()}).onComplete(()=>{R.enabled=!0,tweengroup.remove(d,l)}).start();tweengroup.add(d,l)}},D=new s.Raycaster,L=new i.A;let W,G,B,I;const V={x:0,y:0};let U,z=.03,F=.03,H=.01,K=.01,Y=window.innerWidth/2,$=window.innerHeight/2;function X(e){}function Q(e){V.x=e.clientX,V.y=e.clientY,U=Date.now()}function q(e){if(Math.abs(V.x-e.clientX)>10||Math.abs(V.y-e.clientY)>10||Date.now()-U>500)return;const t=new s.Vector2,a=I.getBoundingClientRect(),n=e.clientX-a.left,i=e.clientY-a.top;t.x=n/I.clientWidth*2-1,t.y=-i/I.clientHeight*2+1,D.setFromCamera(t,G);const r=D.intersectObjects(W.children,!0);if(0===r.length)return;const o=[];for(let e=0;e<r.length;e++){const t=P(r[e].object);if(t.visible&&!o.includes(t))return o.push(t),void L.emit("click",t)}}const N=new Proxy(class{static get Control(){return j}static Init(e,t,a,s,n){const i={camera:{range:{x:.01,y:.01},movespeed:{x:.03,y:.03}},...n};W=s,B=a,G=t,I=e,z=i.camera.movespeed.x,F=i.camera.movespeed.y,H=i.camera.range.x,K=i.camera.range.y,Y=window.innerWidth/2,$=window.innerHeight/2,e.addEventListener("click",q.bind(null)),e.addEventListener("mousemove",X,!1),e.addEventListener("mousedown",Q,!1)}static Update(e){}static SetCamera(e){G=e}},{get:(e,t)=>t in e?e[t]:L[t]});let Z,J,ee,te,ae,se,ne,ie=[];const re=new i.A,oe=[];function ce(e){for(let t=0;t<ie.length;t++)ie[t](e);te.render(ee,ne)}class le{static get Root(){return ae}static get Scene(){return ee}static get Camera(){return ne}static get Canvas(){return Z}static get Renderer(){return te}static Init(e){Z=e,J=new s.Clock,ee=new s.Scene,te=new s.WebGLRenderer({canvas:e,alpha:!0,powerPreference:"high-performance",antialias:!0,stencil:!1});const t=Z.clientWidth,a=Z.clientHeight;te.setSize(t,a,!1),te.setPixelRatio(window.devicePixelRatio),te.shadowMap.enabled=!0,te.shadowMap.type=s.PCFSoftShadowMap,ae=new s.Object3D,ae.receiveShadow=!0,ae.castShadow=!0,ee.add(ae)}static Start(){se=ne=new s.PerspectiveCamera(60,window.innerWidth/window.innerHeight,.01,1e3),ne.uid="PlayCamera",ee.add(ne),ne.position.set(0,10,30),ne.layers.enable(0),ne.layers.disable(1),te.setAnimationLoop(ce),N.Init(te.domElement,ne,ee,ae),N.on("click",e=>{console.log(e),_.Run([...e.actions,...e.state?e.state.actions:[]],e,"mouse.click")})}static AddToUpdate(e){ie.push(e)}static RemoveFromUpdate(e){const t=ie.indexOf(e);t>=0&&ie.splice(t,1)}static ResetCamera(){le.SetCamera(se)}static SetCamera(e){ne.visible=!1,ne=e;const t=te.domElement.clientWidth,a=te.domElement.clientHeight;ne.aspect=t/a,ne.updateProjectionMatrix(),ne.visible=!0,ne.layers.enable(0),ne.layers.disable(1),re.emit("setcamera",ne),N.SetCamera(ne)}static async Build(e){const t=await C.BuildElements(e,ae);return t.forEach(e=>e.visible=!1),oe.push(...t),console.log(ae),t}static FindBlock(e){return oe.find(t=>t.uid===e)}static FindElement(e){console.log(e);let t=ae;for(let a=0;a<e.length;a++)t=t.children.find(t=>t.uid===e[a]);return t}static async SetAsset(e,t){const a=await m.GetAsset({uid:t.uid}),s=e.split(".");let n=oe.find(e=>e.uid===s[0]);for(let e=1;e<s.length;e++)n=n.children.find(t=>t.uid===s[e]);n.addAsset(t,a)}static RemoveAsset(e,t){const a=e.split(".");let s=oe.find(e=>e.uid===a[0]);for(let e=1;e<a.length;e++)s=s.children.find(t=>t.uid===a[e]);s.removeAsset(t)}static RemoveElement(e){const t=e.split(".");let a=oe;for(let e=0;e<t.length-1;e++){const s=a.find(a=>a.uid===t[e]);a=s.children}const s=a.findIndex(t=>t.path===e);if(s>=0){const e=a.splice(s,1);e[0].parent.remove(e[0])}}}const de=new Proxy(le,{get:(e,t)=>t in e?e[t]:re[t]});window.Project=de;const ue=de;let he;const pe=new i.A;class me{static Init(e,t){he=new be({element:e}),he.setSize(window.innerWidth,window.innerHeight),he.elements.length=0;const a=t.clientWidth,s=t.clientHeight,n=a/he.domElement.offsetWidth,i=s/he.domElement.offsetHeight;he.domElement.style.transform=`scale(${n}, ${i})`,ue.AddToUpdate(me.Render)}static Render(){he.render(ue.Scene,ue.Camera)}static async OnRemove(e,t){e.isUIElement&&(await t.removeElement(e.element),he.elements.remove(e))}static async OnCreate(e,t,a){if(e.isUIElement){e.on("click",()=>{_.Run([...e.actions||[],...e.states[a.actived.uid]?.actions||[]],e,"mouse.click")});try{const a=await t.addElement(e.data.element.component||"UILabel",{data:{...e.data.element,path:e.path},events:e.data.events||{}});e.setElement(a.data,a.element)}catch(e){return}he.elements.push(e)}}}const ge=new s.Vector3,ye=new s.Matrix4,we=new s.Matrix4,fe=new s.Vector3,ve=new s.Vector3;class be{constructor(e={}){const t=this;let a,s,n,i;const r={objects:new WeakMap},o=void 0!==e.element?e.element:document.createElement("div");function c(e,a,s){ge.setFromMatrixPosition(e.matrixWorld),ge.applyMatrix4(we);const c=ge.z>=-1&&ge.z<=1&&!0===e.layers.test(s.layers),l=e.element;!0===c&&(e.onBeforeRender(t,a,s),l.style.transform=`translate(${-100*e.center.x}%, ${-100*e.center.y}%) translate(${ge.x*n+n}px, ${-ge.y*i+i}px)`,l.parentNode!==o&&o.appendChild(l),e.onAfterRender(t,a,s));const d={distanceToCameraSquared:(u=s,h=e,fe.setFromMatrixPosition(u.matrixWorld),ve.setFromMatrixPosition(h.matrixWorld),fe.distanceToSquared(ve))};var u,h;r.objects.set(e,d);for(let t=0,a=e.children.length;t<a;t++);}o.style.overflow="hidden",this.domElement=o,this.elements=[],this.getSize=function(){return{width:a,height:s}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),ye.copy(t.matrixWorldInverse),we.multiplyMatrices(t.projectionMatrix,ye);for(let a=0;a<this.elements.length;a++)c(this.elements[a],e,t);!function(e){const t=function(e){const t=[];for(let a=e.length-1;a>=0;a--)e[a].traverseVisible(function(e){e.isCSS2DObject&&t.push(e)});return t}(e).sort(function(e,t){return e.renderOrder!==t.renderOrder?t.renderOrder-e.renderOrder:r.objects.get(e).distanceToCameraSquared-r.objects.get(t).distanceToCameraSquared}),a=t.length;for(let e=0,s=t.length;e<s;e++)t[e].element.style.zIndex=a-e}(this.elements)},this.setSize=function(e,t){a=e,s=t,n=a/2,i=s/2,o.style.width=e+"px",o.style.height=t+"px"}}}const Me=new Proxy(me,{get:(e,t)=>t in e?e[t]:pe[t]})}}]);