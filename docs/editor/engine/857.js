"use strict";(self.webpackChunk_reneos_3d_editor_engine=self.webpackChunk_reneos_3d_editor_engine||[]).push([[857],{857:(e,s,t)=>{t.r(s),t.d(s,{default:()=>r});var i=t(30),o=t(909);class n extends i.default{constructor(e){super(e),this.prototypes.push("animatedmodel"),this.isModel=!0,this.type="animatedmodel",this.assets=[],this.lasttime=0}setAssets(e,s){console.log("setAssets");for(let t=0;t<s.length;t++)this.setAsset(e[t],s[t])}setAsset(e,s){e&&(e.on("update",this.updateAsset.bind(this,s)),this.updateAsset(s,e))}updateAsset(e,s){this.removeAsset(s.uid),this.add(s.resource),this.traverse(e=>[e.visible=this.visible]),this.mixer=new o.AnimationMixer(s.resource),this.clip=s.resource.animations[0];const t=this.mixer.clipAction(this.clip);t.paused=!0,t.time=0,t.play(),window.Project.AddToUpdate(this.render)}render(){const e=Date.now()-this.lasttime;this.lasttime=Date.now(),this.mixer.update(e)}removeAsset(e){const s=this.children.find(s=>s.uid===e);s&&this.remove(s)}addAsset(e,s){console.log("addAsset"),s.position.copy(e.position||{x:0,y:0,z:0}),s.rotation.setFromVector3(e.rotation||{x:0,y:0,z:0},"XYZ"),s.scale.copy(e.scale||{x:1,y:1,z:1}),e.quaternion&&s.quaternion.copy(e.quaternion),s.traverse(e=>{e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0,e.geometry.computeBoundingBox())}),this.add(s)}}const r=n}}]);