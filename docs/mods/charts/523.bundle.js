"use strict";(self.webpackChunk_reneos_slider_mods_charts=self.webpackChunk_reneos_slider_mods_charts||[]).push([[523],{851:(e,t,o)=>{var s=o(333),r=o(66),a=o(186),n=o(998),l=o(420);console.log(n);const i=[2,3,5,6,8,9,10,11,18,19,21,22],u=[new a.Color(16711680),new a.Color(16744192),new a.Color(16776960),new a.Color(65280),new a.Color(255),new a.Color(4915330),new a.Color(9109759)];function c(e,t,o){for(let s=0;s<t.length;s++)e.array[3*t[s]+1]=o;e.needsUpdate=!0}function h(){return class extends a.Object3D{constructor(e){super(),this.type="ColumnChart",this.data={values:[],material:{},...e},this._values=[],this._max=this.data.max||25,this.tweengroup={},this.faces=[],this.columns=[],this.material=new a.MeshBasicMaterial({vertexColors:!0,transparent:!0,opacity:.9,reflectivity:.9}),this.vertices=new Float32Array([-1,-1,1,1,-1,1,1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1]),this.cubeSize=2,this.targetSize=5,this.view=!1,e.transform?.position&&this.position.copy(templates[e.transform.position]||e.transform.position),e.transform?.scale&&this.scale.copy(templates[e.transform.scale]||e.transform.scale)}get max(){return this._max}set max(e){this._max=e,this.columns.forEach(e=>{c(e.cube.geometry.attributes.position,i,e.value/this._max*10)})}getTypes(){return[...super.getTypes(),this.type]}get values(){return this._values}set values(e){const t=Math.max(this._values.length,e.length);for(let o=0;o<t;o++){const t=this._values[o],s=e[o];s?t?(t.value!==s.value&&(this.playValue(t,s.value,this.columns[o].cube),t.value=s.value),t.color!==s.color&&(this.playColor(t,s.color),t.color=s.color)):(s.encode=()=>({value:s.value,color:s.color}),this.createColumn(s)):t&&this.removeColumn(t)}}createColumn(e){this._values.push(e);const t=this.createCubeGeometry(e.color),o=new a.Mesh(t,this.material);this.add(o);const s={cube:o,value:e.value};this.columns.push(s),o.position.x=this._values.length*this.cubeSize,this.playValue({value:0,color:"#ffffff"},e.value,o)}playValue(e,t,o){console.log(`Изменяем значение: ${e.value} -> ${t}`);const s={value:e.value};l.gsap.to(s,{value:t,duration:1,delay:0,onStart:()=>{},onUpdate:()=>{c(o.geometry.attributes.position,i,s.value)},onComplete:()=>{},onRepeat:()=>{}})}playColor(e,t){console.log(`Изменяем цвет: ${e.color} -> ${t}`)}removeColumn(e){console.log("Удаляем элемент:",e)}reset(){this.columns.map(e=>{c(e.cube.geometry.attributes.position,i,-1)})}clean(){for(;this.children.length>0;)this.remove(this.children[0]);this.columns.length=0}init(){this.clean();let e=0;for(let t=0;t<this.data.values.length;t++){const o=this.data.values[t];o.color||(o.color=u[e++]),e>u.length-1&&(e=0);const s=this.createCubeGeometry(o.color),r=new a.Mesh(s,material);this.add(r),this.columns.push({cube:r,value:o.value});for(let e=0;e<this.columns.length;e++)this.columns[e].cube.position.x=e*this.cubeSize}const t=-this.data.values.length/2*this.cubeSize*this.scale.x;this.position.x=t,this.start()}addValue(e){console.log("add"),this._values.push(e);const t=this.createCubeGeometry(new a.Color("white")),o=new a.Mesh(t,this.material);this.add(o),this.columns.push({cube:o}),o.position.x=this._values.length*this.cubeSize}changeColor(e,t){const o=this.data.values.indexOf(e),s=this.columns[o];e.color=t;const r=s.cube.geometry.getAttribute("color");for(let t=0;t<r.count;t++)r.setXYZ(t,e.color.r,e.color.g,e.color.b);r.needsUpdate=!0}changeValue(e,t){const o=this._values[e],s=this.columns[e];o.value=t;const r=o.value/this.max*10;c(s.cube.geometry.attributes.position,i,r)}createCubeGeometry(e){const t=new a.Color(e),o=new a.BufferGeometry,s=new Float32Array(this.vertices),r=new Uint32Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),n=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);o.setAttribute("position",new a.BufferAttribute(s,3)),o.setIndex(new a.BufferAttribute(r,1)),o.setAttribute("normal",new a.BufferAttribute(n,3));const l=[];for(let e=0;e<o.attributes.position.count;e++)l.push(t.r,t.g,t.b);return o.setAttribute("color",new a.BufferAttribute(new Float32Array(l),3)),o}start(){for(let e=0;e<this.columns.length;e++){const t=this.columns[e];this.play(t.cube,t.value,t.label,e)}}reload(e){this.update=()=>{},[].forEach(e=>{e.stop()}),this.reset(),this.data.values=e.values,this.clean(),this.init(),this.start()}play(e,t,o,s=0){const r={value:0};l.gsap.to(r,{value:t/this.max*10,duration:.5,delay:.05*s,onStart:()=>{},onUpdate:()=>{c(e.geometry.attributes.position,i,r.value)},onComplete:()=>{},onRepeat:()=>{}})}}}function p(){return class extends a.Mesh{constructor(e){super(function(e){const t=new a.BufferGeometry,o=new Float32Array(new Float32Array([-1,-1,1,1,-1,1,1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,-1,1,-1,-1,-1,-1,-1,-1])),s=new Uint32Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),r=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]);t.setAttribute("position",new a.BufferAttribute(o,3)),t.setIndex(new a.BufferAttribute(s,1)),t.setAttribute("normal",new a.BufferAttribute(r,3));const n=[];for(let o=0;o<t.attributes.position.count;o++)n.push(e.r,e.g,e.b);return t.setAttribute("color",new a.BufferAttribute(new Float32Array(n),3)),t}(new a.Color),new a.MeshBasicMaterial({vertexColors:!0,transparent:!0,opacity:.9,reflectivity:.9})),this.type="ChartColumn",this.faces=[],this.columns=[],this.material=new a.MeshBasicMaterial({vertexColors:!0,transparent:!0,opacity:.9,reflectivity:.9})}getTypes(){return[...super.getTypes(),this.type]}}}console.log(n),new a.Color(16711680),new a.Color(16744192),new a.Color(16776960),new a.Color(65280),new a.Color(255),new a.Color(4915330),new a.Color(9109759);const m=s.default||s;!async function e(){if(m.engine.ready){if(m.engine.Factory.RegisterElement("ColumnChart",h,{label:"Column Chart"}),m.engine.Factory.RegisterElement("ChartColumn",p,{label:"Chart column",hided:!0}),!window.isEditor)return;window.vue.component("chartsUI",(0,r.defineAsyncComponent)(async()=>{const e=await o.e(866).then(o.bind(o,866));return e.default||e})),m.inspector.addToModels(["ColumnChart"],[{label:"Max",content:{component:"Float",prop:"max",state:!0}},{label:"Values",content:{component:"chartsUI",prop:"values",state:!1,onupdate(e,t,o,s){e.states[s][t]=JSON.parse(JSON.stringify(o))}}}])}else m.engine.onload(e)}()}}]);